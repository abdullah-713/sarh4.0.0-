# ๐ ุฏููู ุงูุชุดุบูู ุงูููุงุณู (SOP) โ ูุธุงู ุตุฑุญ ุงูุฅุชูุงู
> **ุงูุฅุตุฏุงุฑ:** 3.4.1 (ูุณุชูุฑ) | **ุชุงุฑูุฎ ุงูุชุญุฏูุซ:** 2026-02-13
> **ุงููุนุฏู:** ูุฑูู ููุฏุณุฉ ุตุฑุญ | **ุงูุชุตููู:** ุณุฑู โ ููุงุณุชุฎุฏุงู ุงูุฏุงุฎูู ููุท
> **ุงูุจูุฆุฉ:** Hostinger Shared Hosting | PHP 8.3 | MySQL 8.0 | Laravel 11 + Filament 3

---

## ููุฑุณ ุงููุญุชููุงุช

1. [ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุนูุงุฑูุฉ](#1-ูุธุฑุฉ-ุนุงูุฉ-ุนูู-ุงููุนูุงุฑูุฉ)
2. [ุฏููู ุงููุณุงุฑุงุช ูุขููุฉ ุงูุฑุจุท ุงูุขูู](#2-ุฏููู-ุงููุณุงุฑุงุช-ูุขููุฉ-ุงูุฑุจุท-ุงูุขูู)
3. [ุขููุฉ ุงูุนูููุงุช (Workflows)](#3-ุขููุฉ-ุงูุนูููุงุช-workflows)
   - 3.1 [ุนูููุฉ ุชุณุฌูู ุงูุญุถูุฑ](#31-ุนูููุฉ-ุชุณุฌูู-ุงูุญุถูุฑ-ุงูุฌุบุฑุงูู)
   - 3.2 [ูุญุฑู ุงูููุงูุณุฉ](#32-ูุญุฑู-ุงูููุงูุณุฉ-competition-engine)
4. [ูุตูููุฉ ุงูุตูุงุญูุงุช ุงููุงููุฉ](#4-ูุตูููุฉ-ุงูุตูุงุญูุงุช-ุงููุงููุฉ)
5. [ุฏููู ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ ูุญููููุง](#5-ุฏููู-ุงูุฃุฎุทุงุก-ุงูุดุงุฆุนุฉ-ูุญููููุง)
6. [ุฃูุงูุฑ ุงูุตูุงูุฉ ุงููุฑุฌุนูุฉ](#6-ุฃูุงูุฑ-ุงูุตูุงูุฉ-ุงููุฑุฌุนูุฉ)
7. [ููุญูุงุช](#7-ููุญูุงุช)

---

## 1. ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุนูุงุฑูุฉ

### 1.1 ุงูุจููุฉ ุงูุชุญุชูุฉ

| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **ุงููุทุงู** | `sarh.online` |
| **ุงูุฎุงุฏู** | Hostinger Shared Hosting |
| **SSH** | `ssh -p 65002 u850419603@145.223.119.139` |
| **ูุณุงุฑ ุงููุดุฑูุน** | `/home/u850419603/sarh` |
| **ูุณุงุฑ ุงูููุจ ุงูุนุงู** | `/home/u850419603/public_html` โ symlink โ `sarh/public` |
| **ูุงุนุฏุฉ ุงูุจูุงูุงุช** | `u850419603_sarh` @ `127.0.0.1:3306` |
| **PHP** | 8.3 ูุน ุฅุถุงูุงุช: `pdo_mysql`, `bcmath`, `fileinfo`, `gd`, `openssl` |
| **ุฅุทุงุฑ ุงูุนูู** | Laravel 11 + Filament 3 + Livewire 3 + Tailwind CSS |

### 1.2 ุงูุจูุงุจุงุช (Panels)

ูุนูู ุงููุธุงู ุจุจูุงุจุชูู ูููุตูุชูู ุชูุงูุงู:

| ุงูุจูุงุจุฉ | ุงููุณุงุฑ | ุงูุบุฑุถ | ุงููุณุชุฎุฏููู |
|---------|--------|-------|------------|
| **ููุญุฉ ุงูุฅุฏุงุฑุฉ** | `/admin` | ุฅุฏุงุฑุฉ ุงููุฑูุนุ ุงูุญุถูุฑุ ุงูุชูุงุฑูุฑุ ุงููุตุงุฆุฏุ ูุจู ุงูุจูุงุบุงุช | `security_level >= 4` |
| **ุจูุงุจุฉ ุงูููุธู (PWA)** | `/app` | ุชุณุฌูู ุญุถูุฑุ ุนุฑุถ ููุงุทุ ุฅุฑุณุงู ุจูุงุบุงุชุ ูุฑุงุณูุงุช | `security_level >= 1` |

### 1.3 ุทุจูุงุช ุงูุชุทุจูู

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                  ุงููุชุตูุญ / PWA                   โ
โโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ   /admin (Filament) โ      /app (Livewire)       โ
โโโโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ              Laravel 11 (Middleware)              โ
โ  โโโโโโโโโโโโ โโโโโโโโโโโโ โโโโโโโโโโโโโโโโโโโโ โ
โ  โGate::     โ โTrustProxyโ โGeofencePermissionโ โ
โ  โbefore()   โ โ(*)       โ โPolicy            โ โ
โ  โโโโโโโโโโโโ โโโโโโโโโโโโ โโโโโโโโโโโโโโโโโโโโ โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ              ุทุจูุฉ ุงูุฎุฏูุงุช (Services)              โ
โ  โโโโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โGeofencingServiceโ โAttendanceService        โ โ
โ  โ(Haversine 17m) โ โ(Check-in/out + Finance) โ โ
โ  โโโโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โโโโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ  โTrapResponse    โ โFinancialReporting       โ โ
โ  โService         โ โService                  โ โ
โ  โโโโโโโโโโโโโโโโโโ โโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ         Eloquent ORM + MySQL 8.0                 โ
โ         (26+ ุฌุฏูู + ููุงุฑุณ ุฃุฏุงุก)                  โ
โ         + UserShift / UserBadge ููุงูุงุช ูุณุชููุฉ (v3.4)  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## 2. ุฏููู ุงููุณุงุฑุงุช ูุขููุฉ ุงูุฑุจุท ุงูุขูู

### 2.1 ุงููุดููุฉ ุงูุฃูููุฉ

ูู ุงูุงุณุชุถุงูุฉ ุงููุดุชุฑูุฉ (Shared Hosting)ุ ุงููุฌูุฏ ุงูุฐู ูุฑุงู ุงููุชุตูุญ ูู `public_html/`. ุฅุฐุง ููุถุน ูุงูู ูุดุฑูุน Laravel ุฏุงุฎููุ ุณุชููู ูููุงุช `.env` ููุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูููุฏ ุงููุตุฏุฑู **ููุดููุฉ ููุนุงูู**. ูุฐุง ุฎุทุฑ ุฃููู ูุงุฑุซู.

### 2.2 ุงูุญู ุงููุนุชูุฏ: ูุตู ุงููุณุงุฑุงุช

```
/home/u850419603/
โโโ sarh/                          โ ๐ ูุดุฑูุน Laravel ุงููุงูู (ุฎุงุฑุฌ ุงูููุจ)
โ   โโโ app/
โ   โโโ bootstrap/
โ   โโโ config/
โ   โโโ database/
โ   โโโ lang/
โ   โโโ resources/
โ   โโโ routes/
โ   โโโ storage/
โ   โโโ vendor/
โ   โโโ .env                       โ ๐ ุจูุงูุงุช ุญุณุงุณุฉ (ุบูุฑ ููุดููุฉ)
โ   โโโ public/                    โ โ ุงููุฌูุฏ ุงูุนุงู ุงููุญูุฏ
โ       โโโ build/                 โ ุฃุตูู Vite ุงูููุฌููุนุฉ (CSS/JS)
โ       โโโ .htaccess
โ       โโโ index.php              โ ููุทุฉ ุงูุฏุฎูู ุงูุฃุตููุฉ
โ
โโโ public_html/                   โ ๐ ูุง ูุฑุงู ุงููุชุตูุญ
    โโโ โ symlink โ /home/u850419603/sarh/public
```

**ุงููุชูุฌุฉ:** ุงููุชุตูุญ ูุตู ููุท ุฅูู ูุญุชููุงุช `public/` ุนุจุฑ ุงูุฑุงุจุท ุงูุฑูุฒู (symlink). ุฌููุน ุงููููุงุช ุงูุญุณุงุณุฉ ุชุจูู **ููู** ูุฌูุฏ ุงูููุจ ุงูุนุงู.

### 2.3 ุฅูุดุงุก ุงูุฑุงุจุท ุงูุฑูุฒู

```bash
# ุฅุฒุงูุฉ ุงููุฌูุฏ ุงููุฏูู ูุฅูุดุงุก ุงูุฑุงุจุท
rm -rf /home/u850419603/public_html
ln -s /home/u850419603/sarh/public /home/u850419603/public_html
```

**ุงูุชุญูู:**
```bash
ls -la /home/u850419603/public_html
# ูุฌุจ ุฃู ููุธูุฑ: public_html โ /home/u850419603/sarh/public
```

### 2.4 ููู index.php โ ุงูุฌุณุฑ ุงูุญุฑุฌ

ููู `index.php` ูู **ููุทุฉ ุงูุฏุฎูู ุงููุญูุฏุฉ** ููู ุงูุทูุจุงุช. ูู ุจูุฆุฉ Hostinger ูุน ุงููููู ุงูุนูุณู (Reverse Proxy)ุ ูุฌุจ ุงุณุชุฎุฏุงู **ูุณุงุฑุงุช ูุทููุฉ** ุจุฏูุงู ูู `__DIR__` ุงููุณุจูุฉ:

```php
<?php
// filepath: public/index.php โ ุงูุฌุณุฑ ุจูู ุงูููุจ ูููุจ Laravel

use Illuminate\Http\Request;

define('LARAVEL_START', microtime(true));

// โโ ููู ุงูุตูุงูุฉ (Maintenance Mode) โโ
$maintenance = '/home/u850419603/sarh/storage/framework/maintenance.php';
if (file_exists($maintenance)) {
    require $maintenance;
}

// โโ ุชุญููู Composer Autoloader โโ
require '/home/u850419603/sarh/vendor/autoload.php';

// โโ ุชุญููู ููุงุฉ Laravel ููุนุงูุฌุฉ ุงูุทูุจ โโ
(require_once '/home/u850419603/sarh/bootstrap/app.php')
    ->handleRequest(Request::capture());
```

> **โ๏ธ ุชุญุฐูุฑ ุญุฑุฌ:** ุฃูุฑ `deploy.sh` ููุณุฎ ูููุงุช `public/` ุฅูู `public_html/` ุซู **ููุนูุฏ ูุชุงุจุฉ** `index.php` ุจุงููุณุงุฑุงุช ุงููุทููุฉ. ุฅุฐุง ุชู ุชุดุบูู `php artisan optimize` ุจุนุฏ ุงููุณุฎ ุจุฏูู ุฅุนุงุฏุฉ ุงููุชุงุจุฉุ ูุชุนุทู ุงูุชุทุจูู ููุฑุงู.

### 2.5 ุญูุงูุฉ .htaccess

ููู `.htaccess` ูู `public/` ููุฌูู ุฌููุน ุงูุทูุจุงุช ุฅูู `index.php` ููุญูู ูู ุงููุตูู ุงููุจุงุดุฑ:

```apache
# ุชูุฌูู ูู ุงูุทูุจุงุช ุฅูู index.php
RewriteEngine On
RewriteRule ^(.*)$ index.php [L,QSA]

# ุญูุงูุฉ ุงููููุงุช ุงูุญุณุงุณุฉ
<FilesMatch "^\.">
    Order allow,deny
    Deny from all
</FilesMatch>
```

### 2.6 ุงูุซูุฉ ุจุงููููู ุงูุนูุณู (Trusted Proxies)

ูู `bootstrap/app.php`ุ ุชู ุชูุนูู ุงูุซูุฉ ุจุฌููุน ุงููููุงุก ูุฃู Hostinger ูุณุชุฎุฏู ููููุงู ุนูุณูุงู ุฃูุงู Apache:

```php
$middleware->trustProxies(at: '*');
```

**ุจุฏูู ูุฐุง ุงูุณุทุฑ:**
- `$request->isSecure()` ููุฑุฌุน `false` ุฑุบู ุฃู ุงูุงุชุตุงู HTTPS
- ุฑูุฒ CSRF ูุง ูุชุทุงุจู โ ุฎุทุฃ **419 Page Expired**
- ุงูุฌูุณุงุช (Sessions) ุชุชุนุทู

---

## 3. ุขููุฉ ุงูุนูููุงุช (Workflows)

### 3.1 ุนูููุฉ ุชุณุฌูู ุงูุญุถูุฑ ุงูุฌุบุฑุงูู

#### 3.1.1 ูุฎุทุท ุงูุชุฏูู ุงููุงูู

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                 ุงูููุธู ููุชุญ PWA (/app)                   โ
โ                 ูุถุบุท "ุชุณุฌูู ุญุถูุฑ" ๐ฐ๏ธ                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                         โ
                         โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ     ุงููุชุตูุญ ูุทูุจ ุฅุฐู GPS (Geolocation API)              โ
โ     navigator.geolocation.getCurrentPosition()           โ
โ                                                          โ
โ     โ๏ธ v1.9.0: ุชู ุฅุตูุงุญ Permissions-Policy header       โ
โ     ูุถูุงู ุนูู ุงููููุน ุงูุฌุบุฑุงูู ูู ุฌููุน ุงููุชุตูุญุงุช        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                         โ {latitude, longitude}
                         โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ     POST /attendance/check-in                            โ
โ     ุงูุจูุงูุงุช: {latitude, longitude}                      โ
โ     + ุนููุงู IP ุชููุงุฆูุงู + ูุนุฑู ุงูุฌูุงุฒ                   โ
โโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                         โ
                         โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          AttendanceController@checkIn                     โ
โ                                                          โ
โ  1. ุชุญููู ุจูุงูุงุช ูุฑุน ุงูููุธู (Branch)                    โ
โ  2. ุงูุชุญูู ูู ุงููุณุชูู ุงูุฃููู:                           โ
โ     โโโ Level 10 ุฃู is_super_adminุ                      โ
โ     โ   โโโ โ ุชุฌุงูุฒ ุงูุณูุงุฌ (bypass-geofence)           โ
โ     โโโ ุบูุฑ ุฐูู โ GeofencingService                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
                         โ
                         โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          GeofencingService::validatePosition()            โ
โ                                                          โ
โ  ๐ ุญุณุงุจ ุงููุณุงูุฉ ุจุตูุบุฉ Haversine:                       โ
โ                                                          โ
โ  d = 2R ร arcsin(โ(sinยฒ(ฮฯ/2) +                        โ
โ       cos(ฯโ) ร cos(ฯโ) ร sinยฒ(ฮฮป/2)))                โ
โ                                                          โ
โ  ุญูุซ R = 6,371,000 ูุชุฑ (ูุตู ูุทุฑ ุงูุฃุฑุถ)                โ
โ                                                          โ
โ  ุงููุฎุฑุฌุงุช:                                               โ
โ  โโโ distance_meters: ุงููุณุงูุฉ ุงููุนููุฉ ุจุงูุฃูุชุงุฑ          โ
โ  โโโ within_geofence: ูู ุงููุณุงูุฉ โค 17 ูุชุฑุงูุ           โ
โโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโ
             โ                      โ
        โค 17 ูุชุฑ              > 17 ูุชุฑ
             โ                      โ
             โผ                      โผ
โโโโโโโโโโโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ   โ ูุจูู ุงูุชุณุฌูู   โ  โ  โ ุฑูุถ ุงูุชุณุฌูู                 โ
โ                    โ  โ  ุฑุณุงูุฉ: "ุฃูุช ุฎุงุฑุฌ ูุทุงู        โ
โ                    โ  โ  ุงููุฑุน (XX ูุชุฑ)"               โ
โ                    โ  โ  + ุชุณุฌูู ุงููุญุงููุฉ ููุฎุงููุฉ      โ
โโโโโโโโโโฌโโโโโโโโโโโโ  โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
         โ
         โผ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ          AttendanceService::checkIn()                     โ
โ                                                          โ
โ  1. ุชุญุฏูุฏ ุงููุฑุฏูุฉ ุงูุญุงููุฉ (User.currentShift())         โ
โ  2. ุญุณุงุจ ุงูุชุฃุฎูุฑ ุจุงูุฏูุงุฆู                               โ
โ  3. ุญุณุงุจ ุงูุชูููุฉ ุงููุงููุฉ ููุชุฃุฎูุฑ:                       โ
โ     cost = (delay_minutes / 60) ร hourly_rate            โ
โ  4. ุชุญุฏูุฏ ุงูุญุงูุฉ:                                       โ
โ     โโโ ๐ข on_time: ุญุถูุฑ ูู ุงูููุนุฏ (ุฏุงุฎู ุงูุญุฏูุฏ)       โ
โ     โโโ ๐ก late: ูุชุฃุฎุฑ (ูุน ุฏูุงุฆู ุงูุชุฃุฎูุฑ ูุชูููุชูุง)    โ
โ     โโโ ๐ด absent: ุบุงุฆุจ (ูู ูุณุฌู ุญุถูุฑ)                 โ
โ     โโโ โ๏ธ outside_geofence: ุญุงุถุฑ ููู ุฎุงุฑุฌ ุงูุญุฏูุฏ     โ
โ  5. ุฅูุดุงุก ุณุฌู AttendanceLog                             โ
โ  6. ุชุญุฏูุซ ููุงุท ุงูููุงูุณุฉ (ุฅู ูุฌุฏ)                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

#### 3.1.2 ุงูุจูุงูุงุช ุงููุญููุธุฉ ูู ูู ุณุฌู ุญุถูุฑ

| ุงูุญูู | ุงูููุน | ุงููุตู |
|-------|-------|-------|
| `user_id` | FK | ูุนุฑู ุงูููุธู |
| `branch_id` | FK | ูุนุฑู ุงููุฑุน |
| `date` | date | ุชุงุฑูุฎ ุงูููู |
| `check_in_at` | datetime | ููุช ุชุณุฌูู ุงูุญุถูุฑ |
| `check_out_at` | datetime | ููุช ุชุณุฌูู ุงูุงูุตุฑุงู |
| `status` | enum | `on_time`, `late`, `absent`, `outside_geofence` |
| `delay_minutes` | int | ุฏูุงุฆู ุงูุชุฃุฎูุฑ |
| `delay_cost` | decimal | ุงูุชูููุฉ ุงููุงููุฉ ููุชุฃุฎูุฑ (ุฑูุงู ุณุนูุฏู) |
| `distance_meters` | float | ุงููุณุงูุฉ ุงููุนููุฉ ูู ูุฑูุฒ ุงููุฑุน |
| `within_geofence` | boolean | ูู ูุงู ุฏุงุฎู ูุทุงู 17 ูุชุฑุงู |
| `latitude` | decimal | ุฎุท ุนุฑุถ ุงูููุธู ูุญุธุฉ ุงูุชุณุฌูู |
| `longitude` | decimal | ุฎุท ุทูู ุงูููุธู ูุญุธุฉ ุงูุชุณุฌูู |
| `ip_address` | string | ุนููุงู IP |
| `device_info` | string | ูุนูููุงุช ุงููุชุตูุญ/ุงูุฌูุงุฒ |

#### 3.1.3 ุงูุญุงูุงุช ุงูุฎุงุตุฉ

| ุงูุญุงูุฉ | ุงูุณููู |
|--------|--------|
| **ุงููุณุชูู 10 (ุงููุฏูุฑ ุงูุนุงู)** | ูุชุฌุงูุฒ ุงูุณูุงุฌ ุงูุฌุบุฑุงูู ุชููุงุฆูุงู โ ุจูุงุจุฉ `bypass-geofence` |
| **ุชุณุฌูู ูููุฑุฑ** | ููุฑูุถ ุฅุฐุง ููุฌุฏ ุณุฌู `check_in_at` ูููุณ ุงูููู |
| **ุงููุทุงุน GPS** | ููุนุฑุถ ุฎุทุฃ ููููุธู โ ูุง ููุณุฌู ุญุถูุฑ ุจุฏูู ุฅุญุฏุงุซูุงุช |
| **ุงูุนุทู ุงูุฑุณููุฉ** | ููุนูู ุงูููุธู โ ูุง ููุญุณุจ ุบูุงุจ (ุฌุฏูู `holidays`) |
| **ุฎุงุฑุฌ ุงูุญุฏูุฏ** | ููุณุฌู ููุฎุงููุฉ ูุน ุญูุธ ุงููุณุงูุฉ ุงููุนููุฉ ูููุฑุงุฌุนุฉ |

---

### 3.2 ูุญุฑู ุงูููุงูุณุฉ (Competition Engine)

#### 3.2.1 ุงูููุณูุฉ

ูุญุฑู ุงูููุงูุณุฉ ููุญูู ุงูุงูุถุจุงุท ุงููููู ุฅูู **ูุนุจุฉ ุจูู ุงููุฑูุน**. ูู ุชุณุฌูู ุญุถูุฑ ููุชุฑุฌู ุฅูู ููุงุทุ ูุชููุงุฑู ุงููุฑูุน ุนุจุฑ ููุญุฉ ูุณุชููุงุช ุจุตุฑูุฉ.

#### 3.2.2 ุงููุฑูุน ุงูุญููููุฉ

| ุงูุฑูุฒ | ุงูุงุณู | ุงูุฅุญุฏุงุซูุงุช | ูุตู ูุทุฑ ุงูุณูุงุฌ | ุนุฏุฏ ุงูููุธููู |
|-------|-------|-----------|---------------|-------------|
| **SARH-HQ** | ุตุฑุญ ุงูุงุชูุงู ุงูุฑุฆูุณู | 24.572368, 46.602829 | 17ู | 4 (Amjad, Ayman, Najeeb, Zaher) |
| **SARH-CORNER** | ุตุฑุญ ุงูุงุชูุงู ููุฑูุฑ | 24.572439, 46.603008 | 17ู | 7 (Abawe, Arnous, Bilal, Inay_us, Musab, Shaaban, Wakas) |
| **SARH-2** | ุตุฑุญ ุงูุงุชูุงู 2 | 24.572262, 46.602580 | 17ู | 5 (Abu Suleiman, Bukhari, Islam, Mohsen, Saber) |
| **FADA-1** | ูุถุงุก ุงููุญุฑูุงุช 1 | 24.569681, 46.614059 | 17ู | 8 (Abbas, Abdulhadi, Afridi, Bilal.M, Jalal, Munther, Mustafa, Salvador) |
| **FADA-2** | ูุถุงุก ุงููุญุฑูุงุช 2 | 24.566088, 46.621759 | 17ู | 11 (Abd_y, Afzal, Habib, Imti, Inay, Irfan, Jihad, Qutaiba, Risha, Shehata, Wassim) |

> **ุงููุฌููุน:** 35 ููุธูุงู + 1 ูุฏูุฑ ูุธุงู (abdullah@sarh.app)

#### 3.2.3 ููุทู ุงุญุชุณุงุจ ุงูููุงุท

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ              ูุตุงุฏุฑ ุงูููุงุท ููู ููุธู                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                          โ
โ  ๐ ุงูุญุถูุฑ ุงููููู:                                      โ
โ  โโโ ุญุถูุฑ ูู ุงูููุนุฏ (on_time)     โ +10 ููุงุท           โ
โ  โโโ ูุชุฃุฎุฑ (late)                 โ +0 ููุงุท            โ
โ  โโโ ุบุงุฆุจ (absent)                โ -5 ููุงุท            โ
โ                                                          โ
โ  ๐ ุงูุดุงุฑุงุช (Badges):                                    โ
โ  โโโ ุณูุฏ ุงูุงูุถุจุงุท (ุดูุฑ ุจุฏูู ุชุฃุฎูุฑ)   โ +200 ููุทุฉ      โ
โ  โโโ ุณูุณูุฉ ุญุฏูุฏูุฉ (7 ุฃูุงู ูุชุชุงููุฉ)   โ +70 ููุทุฉ       โ
โ  โโโ ุณูุณูุฉ ุฐูุจูุฉ (30 ููู ูุชุชุงูู)     โ +500 ููุทุฉ      โ
โ  โโโ ุตูุฑ ุฎุณุงุฆุฑ (ุดูุฑ ุจุฏูู ุฎุณุงุฑุฉ)      โ +300 ููุทุฉ      โ
โ  โโโ ูููุฑ ุงูุชูุงููู (50+ ุณุงุนุฉ ุฅุถุงููุฉ) โ +150 ููุทุฉ      โ
โ                                                          โ
โ  โญ ุชุนุฏูู ูุฏูู (ุงููุณุชูู 10 ููุท):                        โ
โ  โโโ ุฑูู ููุฌุจ (ุฅุถุงูุฉ) ุฃู ุณุงูุจ (ุฎุตู) + ุณุจุจ ุงูุชุนุฏูู     โ
โ      ููุญูุธ ุนุจุฑ ูููุฐุฌ PointsTransaction                  โ
โ                                                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

#### 3.2.4 ููุงุท ุงููุฑุน = ูุฌููุน ููุงุท ููุธููู

```
ููุงุท ุงููุฑุน = ฮฃ (total_points) ูุฌููุน ุงูููุธููู ุงูููุชููู ูููุฑุน
```

#### 3.2.5 ูุณุชููุงุช ุงููุฑูุน

| ุงููุณุชูู | ุงูุฑูุฒ | ูุทุงู ุงูููุงุท | ุงููุตู |
|---------|-------|------------|-------|
| **ุฃุณุทูุฑู** | ๐ | โฅ 150 | ุฃุนูู ูุฑุชุจุฉ โ ุงูุถุจุงุท ุงุณุชุซูุงุฆู |
| **ุฃููุงุณู** | ๐ | โฅ 120 | ุฃุฏุงุก ูุชููุฒ ุฌุฏุงู |
| **ุฐูุจู** | ๐ฅ | โฅ 100 | ุฃุฏุงุก ููุชุงุฒ |
| **ูุถู** | ๐ฅ | โฅ 80 | ุฃุฏุงุก ุฌูุฏ |
| **ุจุฑููุฒู** | ๐ฅ | โฅ 60 | ุฃุฏุงุก ููุจูู |
| **ูุจุชุฏุฆ** | ๐ข | < 60 | ูุญุชุงุฌ ุชุญุณูู |

#### 3.2.6 ูุธุงู ุงููุฃุณ ูุงูุณูุญูุงุฉ

| ุงููุคุดุฑ | ุงููุนูู | ุทุฑููุฉ ุงูุญุณุงุจ |
|--------|--------|-------------|
| **๐ ุงููุฃุณ** | ุฃูู ุชุณุฌูู ุญุถูุฑ ุงูููู ููู ูุฑุน | ุฃุจูุฑ `check_in_at` ูู `attendance_logs` ูุชุงุฑูุฎ ุงูููู |
| **๐ข ุงูุณูุญูุงุฉ** | ุขุฎุฑ ุชุณุฌูู ุญุถูุฑ ุงูููู ููู ูุฑุน | ุฃุญุฏุซ `check_in_at` ูู `attendance_logs` ูุชุงุฑูุฎ ุงูููู |

#### 3.2.7 ููุญุฉ ุงูุฃุฎุจุงุฑ ุงููุชุญุฑูุฉ (News Ticker)

ุชุนุฑุถ ูู ุฃุนูู ููุญุฉ ุงูุฅุฏุงุฑุฉ:

| ุงูุฑุณุงูุฉ | ุงููุตุฏุฑ |
|---------|--------|
| `ุงููุฑุน ุงูุฃูุซุฑ ุงูุถุจุงุทุงู ุงูููู: {branch}` | ุงููุฑุน ุฐู ุฃูู ุฎุณุงุฑุฉ ูุงููุฉ |
| `ุงููุฑุน ุงูุฃูู ุงูุถุจุงุทุงู ุงูููู: {branch}` | ุงููุฑุน ุฐู ุฃุนูู ุฎุณุงุฑุฉ ูุงููุฉ |
| `ุญุถูุฑ ุงูููู: {on_time} ูู ุงูููุนุฏ \| {late} ูุชุฃุฎุฑ` | ุฅุญุตุงุฆูุฉ ูุญุธูุฉ |
| `ุฅุฌูุงูู ุงูููุธููู ุงููุดุทูู: {count}` | ุนุฏุฏ ุงููุณุชุฎุฏููู ุงููุดุทูู |
| `ุฃุนูู ููุงุท: {name} ({points} ููุทุฉ)` | ุงูููุธู ุงูุฃุนูู ููุงุทุงู |

#### 3.2.8 ูุนูุงุฑ ุงูุชุฑุชูุจ

ุงูุชุฑุชูุจ ุงูุงูุชุฑุงุถู ูู ููุญุฉ ูุณุชููุงุช ุงููุฑูุน ูู **ุงูุฃูู ุฎุณุงุฑุฉ ูุงููุฉ ุฃููุงู**:

```
ุชุฑุชูุจ ุงููุฑูุน = ORDER BY financial_loss ASC
```

| ุงููุนูุงุฑ | ุงููุตู |
|---------|-------|
| `financial_loss` | ุฅุฌูุงูู ุชูููุฉ ุงูุชุฃุฎูุฑ (ุฑูุงู ุณุนูุฏู) โ ุงูุฃูู ุฃูุถู |
| `total_delay` | ุฅุฌูุงูู ุฏูุงุฆู ุงูุชุฃุฎูุฑ โ ูุคุดุฑ ุซุงููู |

---

## 4. ูุตูููุฉ ุงูุตูุงุญูุงุช ุงููุงููุฉ

### 4.1 ูุธุงู ุงููุณุชููุงุช ุงูุฃูููุฉ (Security Levels)

ูุธุงู ุตุฑุญ ูุนุชูุฏ ุนูู **10 ูุณุชููุงุช ุฃูููุฉ** ูุน ุญูููู ุญุงุณููู ูู ุฌุฏูู `users`:
- **`security_level`** (1โ10): ูุง ูููู ุชุบููุฑู ุฅูุง ุนุจุฑ `setSecurityLevel()`
- **`is_super_admin`** (boolean): ูุง ูููู ุชุฑููุชู ุฅูุง ุนุจุฑ `promoteToSuperAdmin()`

### 4.2 ุฌุฏูู ุงููุณุชููุงุช

| ุงููุณุชูู | ุงูุฏูุฑ | ุงููุตู |
|---------|-------|-------|
| **1** | ูุชุฏุฑุจ | ุญุถูุฑ ุดุฎุตู ููุท |
| **2** | ููุธู | ุญุถูุฑ + ูุงููุฉ ุดุฎุตูุฉ + ุฅุฌุงุฒุงุช + ุจูุงุบุงุช |
| **3** | ููุธู ุฃูู | + ุชุตุฏูุฑ ุจูุงูุงุช |
| **4** | ูุงุฆุฏ ูุฑูู | + ุนุฑุถ ุญุถูุฑ ุงููุฑูู + ุงุนุชูุงุฏ ุฅุฌุงุฒุงุช |
| **5** | ูุฏูุฑ ูุฑุน | + ุฅุฏุงุฑุฉ ุงููุฑุน + ุชูุงุฑูุฑ ูุงููุฉ ูุญููุฉ |
| **6** | ูุฏูุฑ ุฅููููู | + ุฅุฏุงุฑุฉ ุนุฏุฉ ูุฑูุน |
| **7** | ูุฏูุฑ ุนูููุงุช | + ุชูุงุฑูุฑ ุดุงููุฉ |
| **8** | ูุงุฆุจ ุงููุฏูุฑ ุงูุนุงู | + ุตูุงุญูุงุช ุฅุฏุงุฑูุฉ ูุงุณุนุฉ |
| **9** | ูุฏูุฑ ุชูููุฐู | + ูู ุดูุก ูุง ุนุฏุง ูุจู ุงููุณุชูู 10 |
| **10** | **ุงููุฏูุฑ ุงูุนุงู (ุนุจุฏ ุงููู ุงููุฑุฏู)** | **ุชุญูู ูุทูู โ ูุถุน ุงููู (God Mode)** |

### 4.3 ูุตูููุฉ ุงูุตูุงุญูุงุช ุงูุชูุตูููุฉ

#### ุงููุตูู ุฅูู ุงูุจูุงุจุงุช

| ุงูุตูุงุญูุฉ | L1 | L2 | L3 | L4 | L5 | L6 | L7 | L8 | L9 | L10 |
|-----------|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:--:|:---:|
| ุจูุงุจุฉ ุงูููุธู `/app` | โ | โ | โ | โ | โ | โ | โ | โ | โ | โ |
| ููุญุฉ ุงูุฅุฏุงุฑุฉ `/admin` | โ | โ | โ | โ | โ | โ | โ | โ | โ | โ |

#### ุฅุฏุงุฑุฉ ุงูุญุถูุฑ

| ุงูุตูุงุญูุฉ | L1 | L2 | L3 | L4 | L5 | L6โL9 | L10 |
|-----------|:--:|:--:|:--:|:--:|:--:|:-----:|:---:|
| ุชุณุฌูู ุญุถูุฑ ุดุฎุตู | โ | โ | โ | โ | โ | โ | โ |
| ุนุฑุถ ุญุถูุฑ ุดุฎุตู | โ | โ | โ | โ | โ | โ | โ |
| ุนุฑุถ ุญุถูุฑ ุงููุฑูู | โ | โ | โ | โ | โ | โ | โ |
| ุนุฑุถ ุญุถูุฑ ูู ุงููุฑูุน | โ | โ | โ | โ | โ | โ | โ |
| ุชุนุฏูู ุณุฌู ุญุถูุฑ | โ | โ | โ | โ | โ | โ | โ |
| ุชุฌุงูุฒ ุงูุณูุงุฌ ุงูุฌุบุฑุงูู | โ | โ | โ | โ | โ | โ | โ |

#### ุงูุฅุฏุงุฑุฉ ุงููุงููุฉ

| ุงูุตูุงุญูุฉ | L1 | L2 | L3 | L4 | L5 | L6โL9 | L10 |
|-----------|:--:|:--:|:--:|:--:|:--:|:-----:|:---:|
| ุนุฑุถ ุชูููุฉ ุชุฃุฎูุฑ ุดุฎุตูุฉ | โ | โ | โ | โ | โ | โ | โ |
| ุนุฑุถ ุชูุงุฑูุฑ ูุงููุฉ ุงููุฑุน | โ | โ | โ | โ | โ | โ | โ |
| ุนุฑุถ ุนุฏุงุฏ ุงูุฎุณุงุฆุฑ ุงููุญุธู | โ | โ | โ | โ | โ | โ | โ |
| ุชุตุฏูุฑ ุงูุชูุงุฑูุฑ ุงููุงููุฉ | โ | โ | โ | โ | โ | โ | โ |

#### ุฅุฏุงุฑุฉ ุงูููุธููู ูุงููุฑูุน

| ุงูุตูุงุญูุฉ | L1โL3 | L4 | L5 | L6โL9 | L10 |
|-----------|:-----:|:--:|:--:|:-----:|:---:|
| ุนุฑุถ ุจูุงูุงุช ุงูููุธููู | โ | ูุฑููู | ูุฑุนู | ูู ุงููุฑูุน | โ |
| ุฅูุดุงุก ููุธู ุฌุฏูุฏ | โ | โ | โ | โ | โ |
| ุชุนุฏูู ุจูุงูุงุช ููุธู | โ | โ | ูุฑุนู | โ | โ |
| ุญุฐู ููุธู | โ | โ | โ | โ | โ |
| ุฅุฏุงุฑุฉ ุงููุฑูุน | โ | โ | โ | โ | โ |
| ุฅุฏุงุฑุฉ ุงููุฑุฏูุงุช | โ | โ | โ | โ | โ |

#### ุงูููุงูุณุฉ ูุงูููุงุท

| ุงูุตูุงุญูุฉ | L1 | L2 | L3 | L4 | L5 | L6โL9 | L10 |
|-----------|:--:|:--:|:--:|:--:|:--:|:-----:|:---:|
| ุนุฑุถ ููุงุทู ุงูุดุฎุตูุฉ | โ | โ | โ | โ | โ | โ | โ |
| ุนุฑุถ ููุญุฉ ุงูููุงูุณุฉ | โ | โ | โ | โ | โ | โ | โ |
| ุชุนุฏูู ููุงุท ูุฏููุงู | โ | โ | โ | โ | โ | โ | โ |
| ุฅุฏุงุฑุฉ ุงูููุงูุณุฉ | โ | โ | โ | โ | โ | โ | โ |

#### ุงูุฃูุงู ูุงููุฒุงูุฉ

| ุงูุตูุงุญูุฉ | L1โL4 | L5โL9 | L10 |
|-----------|:-----:|:-----:|:---:|
| ุฅุฑุณุงู ุจูุงุบ ุณุฑู | โ | โ | โ |
| ูุจู ุงูุจูุงุบุงุช (ูู ุงูุชุดููุฑ) | โ | โ | โ |
| ุณุฌู ูุฑุงุฌุนุฉ ุงููุตุงุฆุฏ | โ | โ | โ |
| ุนุฑุถ ุชูุจููุงุช ุงููุฒุงูุฉ | โ | โ | โ |
| ุฅุฏุงุฑุฉ ุงููุตุงุฆุฏ ุงูููุณูุฉ | โ | โ | โ |

### 4.4 ุงูุจูุงุจุงุช (Gates) ุงูููุนุฑููุฉ ูู ุงููุธุงู

ุชูุนุฑูู ูู `AppServiceProvider`:

| ุงูุจูุงุจุฉ | ุงูุดุฑุท | ุงูุชุฃุซูุฑ |
|---------|-------|---------|
| **`Gate::before()`** | `security_level === 10 \|\| is_super_admin` | ููุฑุฌุน `true` ูู **ูู** ูุญูุตุงุช ุงูุตูุงุญูุงุช โ ุชุฌุงูุฒ ูุทูู |
| `access-whistleblower-vault` | `security_level >= 10` | ุงููุตูู ููุจู ุงูุจูุงุบุงุช ุงููุดูุฑุฉ |
| `access-trap-audit` | `security_level >= 10` | ุงููุตูู ูุณุฌู ูุฑุงุฌุนุฉ ุงููุตุงุฆุฏ ุงูููุณูุฉ |
| `bypass-geofence` | `security_level >= 10 \|\| is_super_admin` | ุชุณุฌูู ุญุถูุฑ ูู ุฃู ูููุน ุฌุบุฑุงูู |
| `manage-competition` | `security_level >= 10 \|\| is_super_admin` | ุฅุฏุงุฑุฉ ุฅุนุฏุงุฏุงุช ุงูููุงูุณุฉ |
| `adjust-points` | `security_level >= 10 \|\| is_super_admin` | ุชุนุฏูู ููุงุท ุงูููุธููู ูุฏููุงู |

### 4.5 ุฃูุงู ุงูุจูุงุบุงุช ุงูุณุฑูุฉ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ           ุชุดููุฑ ุงูุจูุงุบุงุช                         โ
โ                                                  โ
โ  1. ุงูููุธู ููุชุจ ุงูุจูุงุบ (ุฃู ูุณุชูู)               โ
โ  2. ุงููุญุชูู ููุดููุฑ ุจู AES-256-CBC                โ
โ     ุนุจุฑ ุฏุงูุฉ encrypt() ูู Laravel                โ
โ  3. ููุฎุฒูู ูุดูุฑุงู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช              โ
โ  4. ูุง ูููู ูู ุงูุชุดููุฑ ุฅูุง:                      โ
โ     โโโ ุงููุณุชูู 10 (ุงููุฏูุฑ ุงูุนุงู)                โ
โ         ุนุจุฑ ุจูุงุจุฉ access-whistleblower-vault     โ
โ  5. ูู ุนูููุฉ ูุตูู ุชูุณุฌูู ูู ุณุฌู ุงููุฑุงุฌุนุฉ       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## 5. ุฏููู ุงูุฃุฎุทุงุก ุงูุดุงุฆุนุฉ ูุญููููุง

### 5.1 ุฌุฏูู ุงูุฃุฎุทุงุก ุงูุณุฑูุน

| ุงูุฑูุฒ | ุงูุนูุฑูุถ | ุงูุณุจุจ ุงูุฌุฐุฑู | ุงูุญู |
|-------|---------|-------------|------|
| **500** | Internal Server Error | ุตูุงุญูุงุช ุงููููุงุช ุฃู ูุงุด ุชุงูู | ุงูุธุฑ ยง5.2 |
| **405** | Method Not Allowed | ูุงุด ุงููุณุงุฑุงุช ูุฏูู ุจุนุฏ ุชุญุฏูุซ | ุงูุธุฑ ยง5.3 |
| **419** | Page Expired | ุฑูุฒ CSRF ููุชูู ุฃู Trusted Proxies ูุนุทู | ุงูุธุฑ ยง5.4 |
| **404** | Not Found (ูู ุงููุณุงุฑุงุช ูุง ุนุฏุง `/`) | `.htaccess` ููููุฏ ุฃู `mod_rewrite` ูุนุทู | ุงูุธุฑ ยง5.5 |
| **403** | Forbidden | ุงููุณุชุฎุฏู ูุง ูููู ุงููุณุชูู ุงูุฃููู ุงููุงูู | ุชุญูู ูู `security_level` |
| โ | ุตูุญุฉ ุจูุถุงุก | `APP_DEBUG=false` ููุฎูู ุงูุฎุทุฃ ุงูุญูููู | ุงูุธุฑ ยง5.6 |
| โ | "Vite manifest not found" | ุฃุตูู ุงููุงุฌูุฉ ูู ุชูุจูู | `npm run build` |
| โ | CSS/JS ูุง ููุญููู | ุงูุฑุงุจุท ุงูุฑูุฒู ููุณูุฑ | ุชุญูู ูู symlink |
| โ | "No application encryption key" | ููุชุงุญ ุงูุชุดููุฑ ููููุฏ | `php artisan key:generate --force` |
| โ | "SQLSTATE Connection refused" | ุฎุทุฃ ุงุชุตุงู ูุงุนุฏุฉ ุงูุจูุงูุงุช | ุชุญูู ูู `DB_HOST=127.0.0.1` |

### 5.2 ุฎุทุฃ 500 โ Internal Server Error

**ุงูุฎุทูุฉ 1: ูุญุต ุงูุณุฌูุงุช**
```bash
cd /home/u850419603/sarh
tail -50 storage/logs/laravel.log
```

**ุงูุฎุทูุฉ 2: ุฅุตูุงุญ ุงูุตูุงุญูุงุช**
```bash
chmod -R 775 storage bootstrap/cache
```

**ุงูุฎุทูุฉ 3: ุชูุธูู ุงููุงุด ุจุงููุงูู**
```bash
php artisan optimize:clear
```

ูุฐุง ุงูุฃูุฑ ููููุฐ **6 ุนูููุงุช ุชูุธูู** ูู ุขูู ูุงุญุฏ:

| ุงูุนูููุฉ | ุงูุฃูุฑ ุงูููุงูุฆ | ูุง ูููุธููู |
|---------|-------------|-----------|
| ุชูุธูู ูุงุด ุงูุฅุนุฏุงุฏุงุช | `config:clear` | `bootstrap/cache/config.php` |
| ุชูุธูู ูุงุด ุงููุณุงุฑุงุช | `route:clear` | `bootstrap/cache/routes-v7.php` |
| ุชูุธูู ูุงุด ุงูุนุฑูุถ | `view:clear` | `storage/framework/views/*.php` |
| ุชูุธูู ูุงุด ุงูุชุทุจูู | `cache:clear` | ุจูุงูุงุช ุงููุงุด ูู `storage/framework/cache/` |
| ุชูุธูู ูุงุด ุงูุฃุญุฏุงุซ | `event:clear` | ููู ุงูุฃุญุฏุงุซ ุงูููุฎุฒูู ูุคูุชุงู |
| ุชูุธูู composer | โ | ุฐุงูุฑุฉ ุงูุชุญููู ุงูุชููุงุฆู |

**ุงูุฎุทูุฉ 4: ุฅุนุงุฏุฉ ุจูุงุก ุงููุงุด**
```bash
php artisan optimize
```

### 5.3 ุฎุทุฃ 405 โ Method Not Allowed

ูุญุฏุซ ุนุงุฏุฉู ุนูุฏูุง ูููู ูุงุด ุงููุณุงุฑุงุช ูุฏููุงู (ูุซูุงู: ุชู ุฅุถุงูุฉ ูุณุงุฑ POST ุฌุฏูุฏ ููู ุงููุงุด ูุง ูุฒุงู ูุนุฑู ุงููุณุงุฑุงุช ุงููุฏููุฉ ููุท).

```bash
# ุงูุญู ุงูุณุฑูุน
php artisan route:clear
php artisan route:cache

# ุฃู ุงูุชูุธูู ุงููุงูู
php artisan optimize:clear
php artisan optimize
```

**ุงูุชุญูู ูู ุงููุณุงุฑุงุช ุงููุชููุฑุฉ:**
```bash
php artisan route:list --path=attendance
```

### 5.4 ุฎุทุฃ 419 โ Page Expired (CSRF)

**ุงูุณุจุจ ุงูุฃูุซุฑ ุดููุนุงู ูู Hostinger:** ุงููููู ุงูุนูุณู ููุญููู ุงูุทูุจุงุช ูู HTTPS ุฅูู HTTP ุฏุงุฎููุงู. ูุฐุง ูุฌุนู Laravel ูุธู ุฃู ุงูุฌูุณุฉ ุบูุฑ ุขููุฉ.

**ุงูุญู (ููุทุจูู ูู v1.9.0):**
ููู `bootstrap/app.php` ูุญุชูู ุนูู:
```php
$middleware->trustProxies(at: '*');
```

**ุฅุฐุง ุงุณุชูุฑ ุงูุฎุทุฃ:**
```bash
# ุชูุธูู ุงูุฌูุณุงุช
php artisan session:table   # (ุฅุฐุง ูุงูุช ุงูุฌูุณุงุช ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช)
php artisan cache:clear
php artisan config:clear

# ุงูุชุญูู ูู ุฅุนุฏุงุฏุงุช ุงูุฌูุณุฉ ูู .env
grep SESSION .env
# ูุฌุจ ุฃู ูููู: SESSION_DRIVER=file ุฃู database
# ูุฌุจ ุฃู ูููู: SESSION_SECURE_COOKIE=true (ูู ุงูุฅูุชุงุฌ ูุน HTTPS)
```

### 5.5 ุฎุทุฃ 404 โ ูู ุงููุณุงุฑุงุช ูุง ุนุฏุง ุงูุฑุฆูุณูุฉ

```bash
# ุงูุชุญูู ูู ูุฌูุฏ .htaccess
ls -la /home/u850419603/public_html/.htaccess

# ุฅุฐุง ูุงู ููููุฏุงูุ ุงูุณุฎู
cp /home/u850419603/sarh/public/.htaccess /home/u850419603/public_html/

# ุงูุชุญูู ูู mod_rewrite ูู Apache (ุนุจุฑ phpinfo)
php -r "phpinfo();" | grep rewrite
```

### 5.6 ุตูุญุฉ ุจูุถุงุก (Blank Page)

```bash
# ูุคูุชุงู: ุชูุนูู ูุถุน ุงูุชุตุญูุญ ููุนุฑูุฉ ุงูุฎุทุฃ
cd /home/u850419603/sarh
sed -i 's/APP_DEBUG=false/APP_DEBUG=true/' .env
php artisan config:clear

# โฌ๏ธ ุงูุชุญ ุงููููุน ูุณุฌู ุงูุฎุทุฃ

# โ๏ธ ููู ุฌุฏุงู: ุฃุนุฏ ุชุนุทูู ูุถุน ุงูุชุตุญูุญ ููุฑุงู
sed -i 's/APP_DEBUG=true/APP_DEBUG=false/' .env
php artisan config:clear
```

### 5.7 ูุดุงูู Filament

| ุงููุดููุฉ | ุงูุญู |
|---------|------|
| ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู ูุงุฑุบุฉ | `php artisan filament:optimize && php artisan view:clear` |
| ุงูุฃููููุงุช ูุง ุชุธูุฑ | `php artisan filament:assets` |
| ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ูุงุฑุบุฉ | ุชุญูู ูู `security_level` ูููุณุชุฎุฏู (ูุฌุจ โฅ 4 ูููุญุฉ ุงูุฅุฏุงุฑุฉ) |
| ุงูู Widgets ูุง ุชูุญููู | `php artisan optimize:clear && php artisan filament:optimize` |

### 5.8 ุฎุทุฃ ุงููููุน ุงูุฌุบุฑุงูู (GPS)

```
โ๏ธ ุงููุดููุฉ (ุชู ุญููุง ูู v1.9.0):
ุงููุชุตูุญ ูุงู ูุฑูุถ ุทูุจ navigator.geolocation.getCurrentPosition()
ุจุณุจุจ ุฎุทุฃ ูู ุชุฑููุณุฉ Permissions-Policy

ุงูุญู ุงูููุทุจูู:
ูู bootstrap/app.php ุชูุช ุฅุถุงูุฉ middleware ูุถุจุท ุชุฑููุณุฉ
Permissions-Policy ุจุดูู ุตุญูุญ ููุณูุงุญ ุจุงูู Geolocation
```

---

## 6. ุฃูุงูุฑ ุงูุตูุงูุฉ ุงููุฑุฌุนูุฉ

### 6.1 ุงูุฃูุงูุฑ ุงูููููุฉ

```bash
# ุงูุงุชุตุงู ุจุงูุฎุงุฏู
ssh -p 65002 u850419603@145.223.119.139

# ุงูุงูุชูุงู ูููุดุฑูุน
cd /home/u850419603/sarh
```

### 6.2 ุฌุฏูู ุงูุฃูุงูุฑ

| ุงูุบุฑุถ | ุงูุฃูุฑ | ูุชู ููุณุชุฎุฏู |
|-------|-------|-------------|
| **ุชูุธูู ูู ุงููุงุด** | `php artisan optimize:clear` | ุจุนุฏ ุฃู ุชุญุฏูุซ ุฃู ุฎุทุฃ ุบูุฑ ููููู |
| **ุฅุนุงุฏุฉ ุจูุงุก ุงููุงุด** | `php artisan optimize` | ุจุนุฏ ุงูุชูุธูู ุฃู ุงููุดุฑ |
| **ุชุดุบูู ุงูุชุฑุญููุงุช** | `php artisan migrate --force` | ุนูุฏ ุฅุถุงูุฉ ุฌุฏุงูู ุฌุฏูุฏุฉ |
| **ุจุฐุฑ ุงูุจูุงูุงุช** | `php artisan db:seed --force` | ูุฅุนุงุฏุฉ ุงูุจูุงูุงุช ุงูุฃูููุฉ |
| **ุฅูุดุงุก ูุฏูุฑ ูุธุงู** | `php artisan sarh:install` | ุฃูู ูุฑุฉ ููุท |
| **ูุญุต ุงููุณุงุฑุงุช** | `php artisan route:list` | ูุชุตุญูุญ ุฃุฎุทุงุก 404/405 |
| **ุชูุธูู ุงูุณุฌูุงุช** | `truncate -s 0 storage/logs/laravel.log` | ุนูุฏูุง ููุจุฑ ุญุฌู ููู ุงูุณุฌู |
| **ุฑุงุจุท ุงูุชุฎุฒูู** | `php artisan storage:link --force` | ุฅุฐุง ุชุนุทูุช ุฑุงุจุท ุงููููุงุช |
| **ุชุญุณูู Filament** | `php artisan filament:optimize` | ุจุนุฏ ุชุญุฏูุซ Filament |
| **ุฃุตูู Filament** | `php artisan filament:assets` | ุฅุฐุง ุงุฎุชูุช ุงูุฃููููุงุช |
| **ุจูุงุก ุงููุงุฌูุฉ** | `npm run build` | ุจุนุฏ ุชุนุฏูู CSS/JS |
| **ูุญุต ูุณุชุฎุฏู** | `php artisan tinker` โ `User::first()` | ููุชุญูู ูู ูุฌูุฏ ุงููุฏูุฑ |

### 6.3 ุณูุฑุจุช ุงูุฅุตูุงุญ ุงูุดุงูู (ูุณุฎ ููุตู)

```bash
#!/bin/bash
# ุณูุฑุจุช ุฅุตูุงุญ ุดุงูู โ ููููุฐ ุนูุฏ ุฃู ูุดููุฉ ุบูุฑ ูุงุถุญุฉ
cd /home/u850419603/sarh

echo "โธ ุชูุธูู ุงููุงุด..."
php artisan optimize:clear

echo "โธ ุฅุตูุงุญ ุงูุตูุงุญูุงุช..."
chmod -R 775 storage bootstrap/cache

echo "โธ ุฅุนุงุฏุฉ ุจูุงุก ุงููุงุด..."
php artisan optimize

echo "โธ ุชุญุณูู Filament..."
php artisan filament:optimize

echo "โธ ุฅุนุงุฏุฉ ูุชุงุจุฉ index.php..."
cat > /home/u850419603/public_html/index.php << 'BRIDGE'
<?php
use Illuminate\Http\Request;
define('LARAVEL_START', microtime(true));
$m = '/home/u850419603/sarh/storage/framework/maintenance.php';
if (file_exists($m)) { require $m; }
require '/home/u850419603/sarh/vendor/autoload.php';
(require_once '/home/u850419603/sarh/bootstrap/app.php')
    ->handleRequest(Request::capture());
BRIDGE

echo "โ ุชู ุงูุฅุตูุงุญ โ ุฌุฑุจ ุงููููุน ุงูุขู"
```

### 6.4 ุงููุณุฎ ุงูุงุญุชูุงุทู

```bash
# ูุณุฎ ุงุญุชูุงุทู ููุงุนุฏุฉ ุงูุจูุงูุงุช
mysqldump -u u850419603_sarh -p u850419603_sarh > ~/backup_$(date +%Y%m%d).sql

# ูุณุฎ ุงุญุชูุงุทู ูููู ุงูุจูุฆุฉ
cp /home/u850419603/sarh/.env ~/env_backup_$(date +%Y%m%d)
```

---

## 7. ููุญูุงุช

### 7.1 ุจูุงูุงุช ุงููุตูู ุงูุฃูููุฉ

| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| **ุญุณุงุจ ุงููุฏูุฑ ุงูุนุงู** | `abdullah@sarh.app` |
| **ุงููุณุชูู ุงูุฃููู** | 10 (ูุถุน ุงููู โ God Mode) |
| **ูููุฉ ูุฑูุฑ ุงูุญุณุงุจุงุช ุงูุชุฌุฑูุจูุฉ** | `Goolbx512!!` |
| **ุฑุงุจุท ููุญุฉ ุงูุฅุฏุงุฑุฉ** | `https://sarh.online/admin` |
| **ุฑุงุจุท ุจูุงุจุฉ ุงูููุธู** | `https://sarh.online/app` |

### 7.2 ูุงุฆูุฉ ุงูุชุญูู ุจุนุฏ ุงููุดุฑ

- [ ] `https://sarh.online` ููุญููู ุจุฏูู ุฃุฎุทุงุก
- [ ] `https://sarh.online/admin` ููุธูุฑ ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
- [ ] ุงููุฏูุฑ ุงูุนุงู ูุณุชุทูุน ุชุณุฌูู ุงูุฏุฎูู (ุงููุณุชูู 10)
- [ ] ุงูุชูุณูู ุงูุนุฑุจู RTL ูุธูุฑ ุจุดูู ุตุญูุญ
- [ ] ุงููุงุฆูุฉ ุงูุฌุงูุจูุฉ ุชูุธูุฑ: ุงูุญุถูุฑุ ุงูุฃูุงูุ ุบุฑูุฉ ุงูููุงุฏุฉ
- [ ] `APP_DEBUG=false` ูุคูุฏ ูู `.env`
- [ ] GPS ูุนูู ุนูุฏ ุชุณุฌูู ุงูุญุถูุฑ
- [ ] ููุญุฉ ุงูููุงูุณุฉ ุชูุธูุฑ ุงููุฑูุน ุงูุฎูุณุฉ

### 7.3 ุงููููุงุช ุงููุฑุฌุนูุฉ ูู ุงููุดุฑูุน

| ุงูููู | ุงูุบุฑุถ |
|-------|-------|
| `docs/functional_ar.md` | ุงูููุซุงู ุงููุธููู ุงููุงูู (ุนุฑุจู) |
| `docs/technical_logic.md` | ุงููุฎุทุท ุงูุชููู ุงููุนูุงุฑู |
| `docs/methods_registry.md` | ุณุฌู ุงูุฏูุงู ูุงูุฎุฏูุงุช |
| `docs/test_suite.md` | ุฏููู ูุฌููุนุฉ ุงูุงุฎุชุจุงุฑุงุช |
| `app/Models/UserShift.php` | ููุงู ุชุนููู ุงูููุงูุจุฉ (v3.4) |
| `app/Models/UserBadge.php` | ููุงู ููุญ ุงูุดุงุฑุฉ (v3.4) |

### 7.4 ุงููุนูุงุฑ ุงููุนูุงุฑู ููููุงูุงุช ุงููุณุชููุฉ (v3.4)

ูู ุงูุฅุตุฏุงุฑ 3.4 ุชู ุงุนุชูุงุฏ ูุนูุงุฑ ูุนูุงุฑู ุฌุฏูุฏ ูุชุญุฏูุฏ ูุชู ูููุดุฃ **ูููุฐุฌ ููุงู ูุณุชูู** ุจุฏูุงู ูู ุฌุฏูู ุฑุจุท (Pivot):

| ุงูุญุงูุฉ | ุงูููุท |
|--------|-------|
| ุฌุฏูู ุฑุจุท ุจููุชุงุญูู ููุท (FKโ + FKโ) | `BelongsToMany` ุจุฏูู ูููุฐุฌ |
| ุญููู ูุตููุฉ ุจุณูุทุฉ (ุชุงุฑูุฎุ ููุงุญุธุฉ) | `BelongsToMany` ูุน `withPivot` |
| ููุทู ุฃุนูุงู / ุตูุงุญูุฉ ุฒูููุฉ / ุชุฏููู ุฅุฏุงุฑู | **ูููุฐุฌ ููุงู ูุณุชูู + `HasMany`** |

**ุงูููุงุฐุฌ ุงูููุดุฃุฉ:**
- **`UserShift`** โ ุนูุฏ ุชุนููู ููุงูุจุฉ ุจุตูุงุญูุฉ ุฒูููุฉ ูุชุฏููู (`assigned_by`, `approved_by`, `effective_from`, `effective_to`)
- **`UserBadge`** โ ุฅูุฌุงุฒ ููุซู ุจูุงูุญ ูุณุจุจ ูููุงุท (`awarded_by`, `awarded_reason`, `awarded_at`)

> **ุงูุฃุซุฑ:** ุฌููุน ูุงุฌูุงุช `User.currentShift()` ุชุจูู **ูุชูุงููุฉ ูุน ุงูุฅุตุฏุงุฑุงุช ุงูุณุงุจูุฉ** โ ูุง ุญุงุฌุฉ ูุชุบููุฑ ุฃู ููุฏ ูู ุงูุฎุฏูุงุช ุฃู ุงูู Controllers.
| `DEPLOY_HOSTINGER.md` | ุฏููู ุงููุดุฑ ุนูู Hostinger |
| `README_PROD.md` | ุฏููู ุงููุดุฑ ุงูุฅูุชุงุฌู ุงูุนุงู |
| `README.md` | ุงูููู ุงูุชุนุฑููู ุจุงููุดุฑูุน |
| `app/Console/Commands/SarhInstallCommand.php` | ุฃูุฑ ุงูุชุซุจูุช ุงูุฃููู |
| `app/Providers/AppServiceProvider.php` | ุจูุงุจุงุช ุงูุตูุงุญูุงุช |
| `bootstrap/app.php` | ุฅุนุฏุงุฏุงุช Middleware ูุงููููู ุงูุนูุณู |

---

> **ุตุฑุญ ุงูุฅุชูุงู** โ ูุธุงู ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ ูุงูุฐูุงุก ุงููุงูู ุงููุคุณุณู
> *"ุตูุฑ ุชุฃุฎูุฑ. ุตูุฑ ุฎุณุงุฆุฑ. ุตูุฑ ุชูุงุนุจ."*

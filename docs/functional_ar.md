# ุงูููุซุงู ุงููุธููู ููุธุงู ุตุฑุญ โ SARH Functional Charter

> **ุฅุตุฏุงุฑ:** 3.4.1 | **ุชุงุฑูุฎ ุงูุชุญุฏูุซ:** 2026-02-13
> **ูุทุงู ูุฐุง ุงููุณุชูุฏ:** ุดุฑุญ ูุงูู ููู ูุญุฏุฉ ูู ุงููุธุงู ููููุชูุง ุงูุชุฌุงุฑูุฉ ููุฅุฏุงุฑุฉ

---

## 1. ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุธุงู

**ุตุฑุญ ุงูุฅุชูุงู (SARH AL-ITQAN)** ูู ูุธุงู ุฐูุงุก ูุงูู ูููุงุฑุฏ ุจุดุฑูุฉ ูุคุณุณู ุนุงูู ุงูุฃูุงู. ุงููุฏู ุงูุฃุณุงุณู ูู ุชูููู ุงููุฏูุฑ ูู ูุฑุงูุจุฉ ูู ุดูุก ุจุดูู ุจุตุฑู ุจุฏูู ุฃู ูุฌููุฏ โ "ููุญุฉ ุงูููุงุฏุฉ ุจุฏูู ุฌูุฏ" (Zero-Effort Dashboard).

**ุงููุญูุฑ ุงููุงูู ุงูุฐูู:** ูู ุฏูููุฉ ุชุฃุฎูุฑ ููุง ุซูู ูุญุณูุจ ุฑูุงุถูุงู ูู ุงูุฑุงุชุจ ุงูุฃุณุงุณู ููููุธู. ูุฐุง ูุญูู ุงูุญุถูุฑ ูู "ุจูุงูุงุช ูุฌุฑุฏุฉ" ุฅูู "ุฎุณุงุฆุฑ ูุงููุฉ ูุนููุฉ" ูููููุง ุงููุฏูุฑ ููุฑุงู.

---

## 2. ุงููุญุฏุงุช ุงูุฑุฆูุณูุฉ ููููุชูุง ุงูุชุฌุงุฑูุฉ

### 2.1 ุฅุฏุงุฑุฉ ุงููุฑูุน ูุงูุญุถูุฑ ุงูุฌุบุฑุงูู (Branches & GPS Attendance)

**ูุงุฐุง ููุนู ูููุฏูุฑุ**

- ูุถูู ุฃู ุงูููุธู **ูุนููุงู ูู ูููุน ุงูุนูู** ูููุณ ูู ููุงู ุขุฎุฑ
- ูุณุชุฎุฏู ุญุฏูุฏ ุฌุบุฑุงููุฉ ุฏูููุฉ ุจูุตู ูุทุฑ **17 ูุชุฑุงู** ุญูู ูุฑูุฒ ูู ูุฑุน
- ูุนุชูุฏ ุนูู ุตูุบุฉ **Haversine** ูุญุณุงุจ ุงููุณุงูุฉ ุจุฏูุฉ

**ุงูููููุงุช:**

| ุงูุฌุฏูู        | ุงููุธููุฉ                                                                                                                                        |
| ------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------- |
| `branches`        | ุจูุงูุงุช ุงููุฑูุน ูุน ุงูุฅุญุฏุงุซูุงุช ุงูุฌุบุฑุงููุฉ (ุฎุท ุงูุทูู ูุงูุนุฑุถ) ููุตู ูุทุฑ ุงูุญุฏูุฏ ุงูุฌุบุฑุงููุฉ |
| `attendance_logs` | ุณุฌู ูุงูู ููู ุชุณุฌูู ุญุถูุฑ ุจุฅุญุฏุงุซูุงุช GPS ูุงููุณุงูุฉ ูู ุงููุฑูุฒ ูุงูุญุงูุฉ ุงููุงููุฉ                    |
| `shifts`          | ุฌุฏุงูู ุงูููุงูุจุงุช ูุน ูุชุฑุฉ ุงูุณูุงุญ                                                                                              |
| `user_shifts`     | ุชุนูููุงุช ุงูููุงูุจุงุช ููููุธููู โ ููุงู ูุณุชูู ุจุตูุงุญูุฉ ุฒูููุฉ ูุชุฏููู (v3.4)                                               |
| `holidays`        | ุงูุนุทู ุงูุฑุณููุฉ ูุญุณุงุจ ุฃูุงู ุงูุบูุงุจ ุงููุจุฑุฑ                                                                               |

**ููู ูููุน ุงููุฏุฑ ุงููุงููุ**

- ูู ุชุณุฌูู ุญุถูุฑ **ูุญูุธ ุงููุณุงูุฉ ุงููุนููุฉ ุจุงูุฃูุชุงุฑ** โ ูุง ูููู ุงูุชูุงุนุจ
- ุฅุฐุง ูุงู ุงูููุธู ุฎุงุฑุฌ ุงูู 17 ูุชุฑุ ููุฑูุถ ุงูุชุณุฌูู ุฃู ูููุซู ููุฎุงููุฉ

---

### 2.2 ุงูุฐูุงุก ุงููุงูู โ ูุญุฑู ุชูููุฉ ุงูุฏูููุฉ (Financial Intelligence Engine)

**ูุงุฐุง ููุนู ูููุฏูุฑุ**

- ูุญูู **ูู ุฏูููุฉ ุชุฃุฎูุฑ** ุฅูู **ูุจูุบ ูุงูู** ููููู
- ูุนุฑุถ **ุงูุฎุณุงุฆุฑ ุงููุงููุฉ ุงูุฅุฌูุงููุฉ** ุญุณุจ ุงููุฑุน / ุงููุณู / ุงูููุธู / ุงููุชุฑุฉ ุงูุฒูููุฉ
- ูุณูุญ ุจููุงุฑูุฉ **ููุฒุงููุฉ ุงูุฑูุงุชุจ** ููุงุจู **ุงูุฎุณุงุฆุฑ ุงููุนููุฉ**

**ุงููุนุงุฏูุฉ ุงูุฃุณุงุณูุฉ:**

```
ุชูููุฉ_ุงูุฏูููุฉ = ุงูุฑุงุชุจ_ุงูุฃุณุงุณู รท ุฃูุงู_ุงูุนูู_ุงูุดูุฑูุฉ รท ุณุงุนุงุช_ุงูุนูู_ุงูููููุฉ รท 60

ูุซุงู ุชุทุจููู:
ุงูุฑุงุชุจ:     8,000 ุฑูุงู
ุฃูุงู ุงูุนูู: 22 ููู
ุณุงุนุงุช ุงูุนูู: 8 ุณุงุนุงุช
โโโโโโโโโโโโโโโโโโโโโโโ
ุชูููุฉ ุงูุฏูููุฉ = 8000 รท 22 รท 8 รท 60 = 0.7576 ุฑูุงู/ุฏูููุฉ

ุฅุฐุง ุชุฃุฎุฑ 15 ุฏูููุฉ:
ุงูุฎุณุงุฑุฉ = 15 ร 0.7576 = 11.36 ุฑูุงู
```

**ุงูููููุงุช:**

| ุงูุฌุฏูู                              | ุงููุธููุฉ                                                                                                                                                  |
| ----------------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `users` (ุญููู ูุงููุฉ)           | `basic_salary`, `housing_allowance`, `transport_allowance`, `other_allowances`, `working_days_per_month`, `working_hours_per_day`                   |
| `attendance_logs` (ุญููู ูุงููุฉ) | `cost_per_minute`, `delay_cost`, `early_leave_cost`, `overtime_value` โ **ููุทุฉ ููุฑูุฉ** ูู ุฑุงุชุจ ุงูููุธู ููุช ุงูุชุณุฌูู |
| `financial_reports`                     | ุชูุงุฑูุฑ ูุงููุฉ ุดุงููุฉ ุจูุทุงูุงุช ูุชุนุฏุฏุฉ (ููุธู / ูุฑุน / ูุณู / ุดุฑูุฉ) ูุน ูุณุจุฉ ุงูุฎุณุงุฑุฉ                             |

**ุงูููุทุฉ ุงูุญุฑุฌุฉ:**

> ูู ุณุฌู ุญุถูุฑ **ููุณุฎ ุชูููุฉ ุงูุฏูููุฉ** ูู ุงูููุธู ูู ูุญุธุฉ ุงูุชุณุฌูู. ูุฐุง ูุนูู ุฃูู ุญุชู ูู ุชุบูุฑ ุงูุฑุงุชุจ ูุงุญูุงูุ ุชุจูู ุงูุจูุงูุงุช ุงูุชุงุฑูุฎูุฉ ุฏูููุฉ 100%.

---

### 2.3 ูุธุงู ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช โ RBAC (10 ูุณุชููุงุช)

**ูุงุฐุง ููุนู ูููุฏูุฑุ**

- ูุถูู ุฃู **ูู ููุธู ูุฑู ููุท ูุง ูุญู ูู**
- ูุญูู ุงูุจูุงูุงุช ุงููุงููุฉ ุงูุญุณุงุณุฉ ูู ุงููุตูู ุบูุฑ ุงููุตุฑุญ
- ูููุน **ุงูุชุนููู ุงูุฌูุงุนู** (Mass Assignment) ููุญููู ุงูุฃูููุฉ ุงูุญุณุงุณุฉ

**ุงูุญููู ุงููุญููุฉ (ุบูุฑ ูุงุจูุฉ ููุชุนููู ุงูุฌูุงุนู):**

- `is_super_admin` โ ูุง ูููู ุชุฑููุฉ ุฃุญุฏ ููุฏูุฑ ูุธุงู ุฅูุง ุจุงูููุฏ
- `security_level` โ ูุง ูููู ุชุบููุฑ ุงููุณุชูู ุงูุฃููู ุฅูุง ุนุจุฑ `setSecurityLevel()`
- `is_trap_target` โ ูุง ูููู ุชูุนูู ุงููุตูุฏุฉ ุฅูุง ุนุจุฑ `enableTrapMonitoring()`

**ูุณุชููุงุช ุงูุฃุฏูุงุฑ ุงูุนุดุฑุฉ:**

| ุงููุณุชูู | ุงูุฏูุฑ            | ุงูุตูุงุญูุงุช ุงูุฑุฆูุณูุฉ                              |
| -------------- | --------------------- | ---------------------------------------------------------------- |
| 1              | ูุชุฏุฑุจ            | ุญุถูุฑ ุดุฎุตู ููุท                                         |
| 2              | ููุธู              | ุญุถูุฑ + ูุงููุฉ ุดุฎุตูุฉ + ุฅุฌุงุฒุงุช + ุจูุงุบุงุช   |
| 3              | ููุธู ุฃูู       | + ุชุตุฏูุฑ ุจูุงูุงุช                                        |
| 4              | ูุงุฆุฏ ูุฑูู     | + ุนุฑุถ ุญุถูุฑ ุงููุฑูู + ุงุนุชูุงุฏ ุฅุฌุงุฒุงุช       |
| 5              | ูุดุฑู              | + ุฅุฏุฎุงู ูุฏูู + ุงุนุชูุงุฏ ุญุถูุฑ                    |
| 6              | ูุฏูุฑ ูุณู       | + ูุงููุฉ ุงููุฑุน + ุฅูุดุงุก ููุธููู + ุชุนุงููู |
| 7              | ูุฏูุฑ ูุฑุน       | + ุญุฐู ููุธููู + ุจูุงุบุงุช + ูุตุงุฆุฏ                |
|                |                       |                                                                  |
|                |                       |                                                                  |
| 8              | ูุฏูุฑ ุฅููููู | + ูู ุงููุฑูุน + ุฅุฏุงุฑุฉ ูุงููุฉ                      |
| 9              | ูุฏูุฑ ุชูููุฐู | + ุฅุฏุงุฑุฉ ุฑูุงุชุจ + ุณุฌู ุงููุฑุงุฌุนุฉ                |
| 10             | ูุฏูุฑ ุงููุธุงู | **ูู ุงูุตูุงุญูุงุช ุจูุง ุงุณุชุซูุงุก**          |

---

### 2.4 ูุธุงู ุงููุตุงุฆุฏ ุงูููุณูุฉ (Psychological Trap System)

**ูุงุฐุง ููุนู ูููุฏูุฑุ**

- ููุดู ุงูููุธููู ุฐูู **ููุงูุง ุงูุงุญุชูุงู** ูุจู ุฃู ูุญุฏุซ ุงูุถุฑุฑ ุงููุนูู
- ูุนุฑุถ ุนูุงุตุฑ ูุงุฌูุฉ ูุฒููุฉ (ูุซู ุฒุฑ "ุงุนุชูุงุฏ ุชุญููู ูุงูู") ููุฑุงูุจ ูู ูููุฑ ุนูููุง
- ููุซู ูู ุชูุงุนู ูุน ุจูุงูุงุช ูุงููุฉ: ุงูููุธูุ ุงูุนูุตุฑุ ุงูุตูุญุฉุ ุนููุงู IPุ ุงูููุช

**ูุณุชููุงุช ุงูุฎุทุฑ:**

| ุงููุณุชูู | ุงููุตู                                        |
| -------------- | ------------------------------------------------- |
| `low`        | ููุฑ ุงุณุชูุดุงูู โ ุฑุจูุง ุจุงูุฎุทุฃ  |
| `medium`     | ุชูุงุนู ูุดุจูู ูุณุชุญู ุงููุฑุงูุจุฉ |
| `high`       | ูุญุงููุฉ ูุงุถุญุฉ ููุงุณุชุบูุงู        |
| `critical`   | ุฎุทุฑ ุฃููู ููุฑู ูุชุทูุจ ุชุญููู    |

---

### 2.5 ุงูุจูุงุบุงุช ุงูุณุฑูุฉ (Secret Whistleblowing)

**ูุงุฐุง ููุนู ูููุฏูุฑุ**

- ูููุฑ ููุงุฉ **ูุดูุฑุฉ 100%** ููููุธููู ููุฅุจูุงุบ ุนู ุงููุฎุงููุงุช
- **ูุง ููุฌุฏ ุฑุจุท ูุจุงุดุฑ** ุจุญุณุงุจ ุงููุจูุบ โ ูุฌููููุฉ ูุงููุฉ
- ูุชู ุงูุชุชุจุน ุนุจุฑ **ุฑูุฒ ุชุฐูุฑุฉ ูุฌููู** (`ticket_number`) ู**ุฑูุฒ ููุดููุฑ** (`anonymous_token`)
- ุงููุญุชูู ูุดูุฑ ุจู **AES-256** ุนุจุฑ `encrypt()` / `decrypt()` ูู Laravel

---

### 2.6 ุงููุฑุงุณูุงุช ุงูุฐููุฉ (Smart Messaging)

**ูุงุฐุง ููุนู ูููุฏูุฑุ**

- **ูุญุงุฏุซุงุช ูุจุงุดุฑุฉ ูุฌูุงุนูุฉ** ุจูู ุงูููุธููู
- **ุชุนุงููู ุฑุณููุฉ** ูุน ุฅููุงููุฉ ุทูุจ **ุฅูุฑุงุฑ ุจุงูุงุทูุงุน**
- **ุชูุจููุงุช ุฃุฏุงุก ุขููุฉ** ุชููุดุฃ ุชููุงุฆูุงู ุนูุฏ ุชุฌุงูุฒ ุญุฏูุฏ ูุนููุฉ
- ูุนุฑู ุงููุฏูุฑ ูู ูุฑุฃ ุงูุชุนููู ููู ูู ููุฑุฃ ุจุนุฏ

---

### 2.7 ุงูุชูุนูุจ (Gamification)

**ูุงุฐุง ููุนู ูููุฏูุฑุ**

- ูุญูู **ุงูุงูุถุจุงุท** ุฅูู **ููุงูุณุฉ ุฅูุฌุงุจูุฉ**
- ูู ููุธู ููุณุจ **ููุงุท** ุนูู ุงูุญุถูุฑ ุงููุจูุฑ ูุนุฏู ุงูุชุฃุฎูุฑ
- **ุดุงุฑุงุช** ุชูููุญ ุชููุงุฆูุงู ุนูุฏ ุชุญููู ุฅูุฌุงุฒุงุช (ูุซู "30 ููู ุจุฏูู ุชุฃุฎูุฑ")
- **ุณูุณูุฉ ุงูุฃูุงู ุงููุชุชุงููุฉ** (Streak) ุชุดุฌุน ุนูู ุงูุงุณุชูุฑุงุฑูุฉ
- ูุฑุชุจุท ุจุงููุธุงู ุงููุงูู: ุดุงุฑุฉ "ุตูุฑ ุฎุณุงุฆุฑ" = ููุงูุฃุฉ 300 ููุทุฉ

**ุงูุดุงุฑุงุช ุงูุญุงููุฉ:**

| ุงูุดุงุฑุฉ                | ุงูุดุฑุท                                      | ุงูููุงุท |
| --------------------------- | ----------------------------------------------- | ------------ |
| ุงูุทุงุฆุฑ ุงููุจูุฑ   | 5 ุฃูุงู ูุชุชุงููุฉ ุญุถูุฑ ูุจูุฑ     | 50           |
| ุณูุฏ ุงูุงูุถุจุงุท     | ุดูุฑ ูุงูู ุจุฏูู ุชุฃุฎูุฑ             | 200          |
| ุณูุณูุฉ ุญุฏูุฏูุฉ (7) | 7 ุฃูุงู ูุชุชุงููุฉ                       | 70           |
| ุณูุณูุฉ ุฐูุจูุฉ (30)  | 30 ููู ูุชุชุงูู                          | 500          |

> **ููุงุญุธุฉ v3.4:** ุงูุดุงุฑุงุช ุงูุขู ุชูููุญ ุนุจุฑ ูููุฐุฌ `UserBadge` ุงููุณุชูู โ ูู ููุญุฉ ุชูุณุฌููู ูููุง: ูู ููุญูุง (`awarded_by`)ุ ุณุจุจ ุงูููุญ (`awarded_reason`)ุ ูููุช ุงูููุญ (`awarded_at`). ุงูููุงุท ุชูุถุงู ุชููุงุฆูุงู ุนุจุฑ `UserBadge::award()`.
| ุตูุฑ ุฎุณุงุฆุฑ           | ุดูุฑ ุจุฏูู ุฎุณุงุฑุฉ ูุงููุฉ           | 300          |
| ูููุฑ ุงูุชูุงููู   | 50+ ุณุงุนุฉ ุนูู ุฅุถุงูู                  | 150          |
| ุงูุฃุฏุงุก ุงููุชููุฒ | ุฃูุถู ููุธู ูู ุงููุฑุน               | 500          |
| ุจุทู ุงููุฒุงูุฉ       | ุงุฌุชุงุฒ ูู ุงุฎุชุจุงุฑุงุช ุงููุตุงุฆุฏ | 1000         |

---

### 2.8 ุณุฌู ุงููุฑุงุฌุนุฉ (Audit Trail)

**ูุงุฐุง ููุนู ูููุฏูุฑุ**

- ูุณุฌู **ูู ุนูููุฉ** ูู ุงููุธุงู: ุฅูุดุงุกุ ุชุนุฏููุ ุญุฐูุ ุฏุฎููุ ุชุตุฏูุฑ
- ูุญูุธ **ุงูููู ุงููุฏููุฉ ูุงูุฌุฏูุฏุฉ** ูุฃู ุชุนุฏูู
- ูุฑุจุท ูู ุนูููุฉ ุจุงููุณุชุฎุฏู ูุนููุงู IP ูุงููุชุตูุญ

---

## 3. ุงูุฃุทุฑ ุงูุชูููุฉ ุงููุนุชูุฏุฉ

| ุงูุชูููุฉ | ุงูุงุณุชุฎุฏุงู                                |
| -------------- | ------------------------------------------------- |
| Laravel 11     | ุงูุฅุทุงุฑ ุงูุฃุณุงุณู ููุชุทุจูู        |
| Filament v3    | ููุญุฉ ุงูุชุญูู ุงูุฅุฏุงุฑูุฉ            |
| Livewire 3     | ุงูุชูุงุนููุฉ ูู ุงููุงุฌูุฉ            |
| Tailwind CSS   | ุงูุชุตููู (ูุน ุฎุท Tajawal ูุฏุงุนู RTL) |
| Leaflet.js     | ุงูุฎุฑุงุฆุท ูุงูุญุฏูุฏ ุงูุฌุบุฑุงููุฉ  |

---

## 4. ุงููุฑุญูุฉ ุงูุฃููู: ููุธููุฉ ุงูุญุถูุฑ ูุงูุญุฏูุฏ ุงูุฌุบุฑุงููุฉ (Phase 1)

### 4.1 ุขููุฉ ุชุณุฌูู ุงูุญุถูุฑ ุงูุฐูู

**ููู ูุนูู ูู ุฌูุฉ ุงูููุธู (PWA):**

1. ููุชุญ ุงูููุธู ุชุทุจูู ุงูููุจ ููุถุบุท **"ุชุณุฌูู ุญุถูุฑ"**
2. ุงููุชุตูุญ ูุทูุจ ุฅุฐู GPS ููุฑุณู ุงูุฅุญุฏุงุซูุงุช ููุฎุงุฏู
3. ุงููุธุงู ูุญุณุจ ุงููุณุงูุฉ ุจูู ุงูููุธู ููุฑูุฒ ุงููุฑุน ุจุตูุบุฉ **Haversine**
4. ุฅุฐุง ูุงูุช ุงููุณุงูุฉ โค **17 ูุชุฑุงู** โ ูููุจู ุงูุชุณุฌูู
5. ุฅุฐุง ูุงูุช ุงููุณุงูุฉ > 17 ูุชุฑุงู โ ููุฑูุถ ุงูุชุณุฌูู ูุน ุฑุณุงูุฉ ูุงุถุญุฉ

**ููู ูุฑุงูุง ุงููุฏูุฑ ูู ููุญุฉ ุงูููุงุฏุฉ (Filament):**

- ุฌุฏูู ูููู ูุญุถูุฑ ูู ุงูููุธููู ูุน ุฃููุงู:
  - ๐ข **ุฃุฎุถุฑ** = ุญุงุถุฑ ูู ุงูููุช (ุฏุงุฎู ุงูุญุฏูุฏ)
  - ๐ก **ุฃุตูุฑ** = ูุชุฃุฎุฑ (ูุน ุนุฑุถ ุฏูุงุฆู ุงูุชุฃุฎูุฑ ูุชูููุชูุง)
  - ๐ด **ุฃุญูุฑ** = ุบุงุฆุจ
  - โ๏ธ **ุชุญุฐูุฑ** = ุญุงุถุฑ ููู **ุฎุงุฑุฌ ุงูุญุฏูุฏ ุงูุฌุบุฑุงููุฉ**
- ุนููุฏ **"ุงูุฎุณุงุฑุฉ ุงููุงููุฉ"** ูุนุฑุถ ุชูููุฉ ุงูุชุฃุฎูุฑ ุจุงูุฑูุงู ููู ููุธู
- ููุงุชุฑ: ุญุณุจ ุงูุชุงุฑูุฎุ ุงููุฑุนุ ุงููุณูุ ุงูุญุงูุฉ
- ุฃุฒุฑุงุฑ ุชุตุฏูุฑ CSV/Excel

### 4.2 ุดุฑุญ ุชูููุฉ ุงูุชุฃุฎูุฑ ูููุฏูุฑ

```
ูุซุงู ุนููู:
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
ุงูููุธู: ุฃุญูุฏ ูุญูุฏ
ุงูุฑุงุชุจ ุงูุฃุณุงุณู: 8,000 ุฑูุงู
ุฃูุงู ุงูุนูู: 22 ููู | ุณุงุนุงุช ุงูุนูู: 8 ุณุงุนุงุช

ุชูููุฉ ุงูุฏูููุฉ = 8,000 รท 22 รท 8 รท 60 = 0.7576 ุฑูุงู

ุชุฃุฎุฑ ุงูููู: 23 ุฏูููุฉ
ุงูุฎุณุงุฑุฉ = 23 ร 0.7576 = 17.42 ุฑูุงู
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

> **ุงูููุทุฉ ุงูุญุงุณูุฉ:** ุงููุธุงู ูุญูุธ **ููุทุฉ ููุฑูุฉ** ูู ุชูููุฉ ุงูุฏูููุฉ ูุญุธุฉ ุชุณุฌูู ุงูุญุถูุฑ.
> ุญุชู ูู ุชุบูุฑ ุงูุฑุงุชุจ ูุงุญูุงูุ ุงูุจูุงูุงุช ุงูุชุงุฑูุฎูุฉ ุชุจูู ุฏูููุฉ 100%.

### 4.3 ุงูุฎุฏูุงุช ุงููููุฐุฉ

| ุงูุฎุฏูุฉ             | ุงููุธููุฉ                                                                                               |
| ------------------------ | ------------------------------------------------------------------------------------------------------------ |
| `GeofencingService`    | ุญุณุงุจ ุงููุณุงูุฉ ุจุตูุบุฉ Haversine + ุงูุชุญูู ูู ูุฌูุฏ ุงูููุธู ุฏุงุฎู ุงูุญุฏูุฏ |
| `AttendanceService`    | ุชุณุฌูู ุงูุญุถูุฑ/ุงูุงูุตุฑุงู ูุน ุงูููุทุฉ ุงููุงููุฉ ูุงูุชูููู ุงูุขูู        |
| `AttendanceResource`   | ูุงุฌูุฉ Filament ูููุฏูุฑ ูุนุฑุถ ูุฅุฏุงุฑุฉ ุณุฌูุงุช ุงูุญุถูุฑ                               |
| `AttendanceController` | ููุทุฉ ุงุชุตุงู PWA ูุชุณุฌูู ุงูุญุถูุฑ ุจุงูู GPS                                               |

---

## 5. ุงููุฑุญูุฉ ุงูุซุงููุฉ: ูุธุงู ุงููุตุงุฆุฏ ุงูููุณูุฉ ููุญุฑู ุงููุฎุงุทุฑ ุงูููุบุงุฑูุชูู (Phase 2)

### 5.1 ุงุณุชุฑุงุชูุฌูุฉ ุงูุฎุฏุงุน ุงูุฐูู

**ุงูููุณูุฉ:** ุจุฏูุงู ูู ููุน ุงูุณููู ุงููุดุจูู ููุทุ ุงููุธุงู **ููุชุดู ุงูููุงูุง** ุนุจุฑ ุนูุงุตุฑ ูุงุฌูุฉ ูุฒููุฉ ุชุจุฏู ุญููููุฉ.

**ููู ูุนูู ูููุฏูุฑ:**

1. ููุนุฑุถ ููููุธู ุงูููุฑุงูุจ ุนูุงุตุฑ ูุฒููุฉ ุชุจุฏู ูุฃููุง ุญููููุฉ:
   - ๐ **SALARY_PEEK** โ ุฒุฑ "ุนุฑุถ ุฑูุงุชุจ ุงูุฒููุงุก" โ ูุนุฑุถ ุจูุงูุงุช ููููุฉ
   - ๐ **PRIVILEGE_ESCALATION** โ ุฑุงุจุท "ููุญุฉ ุงููุฏูุฑ" โ ูุนุฑุถ ุฑุณุงูุฉ ูุฌุงุญ ูุฒููุฉ
   - โธ๏ธ **SYSTEM_BYPASS** โ ุฎูุงุฑ "ุชุนุทูู ุงูุญุถูุฑ" โ ูุนุฑุถ ุชุฃููุฏ ูุงุฐุจ
   - ๐ค **DATA_EXPORT** โ ุฒุฑ "ุชุตุฏูุฑ ูู ุงูุณุฌูุงุช" โ ุดุฑูุท ุชูุฏู ูููู + ููู CSV ูุดูุฑ ูุงุฑุบ
2. **ูู ููุฑุฉ** ุชูุณุฌูู ูู ุฌุฏูู `trap_interactions` ูุน ุจูุงูุงุช ูุงููุฉ
3. **ุงูููุงุท ุงูุชุฑุงูููุฉ ููุบุงุฑูุชููุฉ** โ ุงููุฑุฉ ุงูุฃููู = 10 ููุงุทุ ุงูุซุงููุฉ = 30ุ ุงูุซุงูุซุฉ = 70...

### 5.2 ุงูุชุณุฌูู ุงูููุบุงุฑูุชูู ูููุฎุงุทุฑ

```
ุงููุนุงุฏูุฉ: ููุงุท_ุฌุฏูุฏุฉ = 10 ร (2^n - 1)
ุญูุซ n = ุนุฏุฏ ุงููุฑุงุช ุงูุชู ุชูุงุนู ูููุง ุงูููุธู ูุน ุงููุตุงุฆุฏ

ุงูุชุตุงุนุฏ:
  ุงููุฑุฉ 1 โ 10 ร (2ยน - 1) = 10 ููุทุฉ
  ุงููุฑุฉ 2 โ 10 ร (2ยฒ - 1) = 30 ููุทุฉ
  ุงููุฑุฉ 3 โ 10 ร (2ยณ - 1) = 70 ููุทุฉ
  ุงููุฑุฉ 4 โ 10 ร (2โด - 1) = 150 ููุทุฉ
  ุงููุฑุฉ 5 โ 10 ร (2โต - 1) = 310 ููุทุฉ

ุงููุชูุฌุฉ: ุงูููุธู ุงูุฐู ูุชูุฑุฑ ุชูุงุนูู ูุญุตู ุนูู ููุงุท ูุชุณุงุฑุนุฉ ุจุดูู ุญุงุฏ
```

### 5.3 ูุงุฌูุฉ ุงููุฏูุฑ (Filament)

| ุงููููู                | ุงููุธููุฉ                                                                                                                               |
| --------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------- |
| `TrapResource`            | ุฅุฏุงุฑุฉ ุชูููู ุงููุตุงุฆุฏ (ุงูุงุณูุ ุงูููุฏุ ุงููุฒูุ ููุน ุงูุงุณุชุฌุงุจุฉ)                                      |
| `TrapInteractionResource` | ูุฑุงูุจุฉ ุญูุฉ ููู ุงูุชูุงุนูุงุช ูุน ููุงุชุฑ ูุจุญุซ                                                                       |
| `RiskWidget`              | ุฃุฏุงุฉ ููุญุฉ ุงูููุงุฏุฉ ุชุนุฑุถ**"ุฃุนูู ุงูููุธููู ุฎุทูุฑุฉ"** ูุฑุชุจุฉ ุจุงูููุงุท ุงูููุบุงุฑูุชููุฉ |

### 5.4 ุฃููุงุท ุงูุงุณุชุฌุงุจุฉ ุงููุฒููุฉ

| ุงููุตูุฏุฉ       | ููุน ุงูุงุณุชุฌุงุจุฉ | ูุง ูุฑุงู ุงูููุธู                                                         |
| -------------------- | ------------------------- | ---------------------------------------------------------------------------------- |
| SALARY_PEEK          | `success`               | ุฌุฏูู ุฑูุงุชุจ ูููู ุจุฃุฑูุงู ุนุดูุงุฆูุฉ                           |
| PRIVILEGE_ESCALATION | `success`               | ุฑุณุงูุฉ "ุชู ููุญู ุตูุงุญูุงุช ูุคูุชุฉ"                               |
| SYSTEM_BYPASS        | `warning`               | ุฑุณุงูุฉ "ุชู ุชุนุทูู ุงููุธุงู ูุคูุชุงู"                             |
| DATA_EXPORT          | `success`               | ุดุฑูุท ุชูุฏู โ "ุงูุชูู ุงูุชุตุฏูุฑ" โ ุฑุงุจุท CSV ูุดูุฑ ูุงุฑุบ |

---

## 6. ุงููุฑุญูุฉ ุงูุซุงูุซุฉ: ูุงุฌูุฉ ุงูููุธู (PWA) ูุงูุจูุงุบุงุช ุงูุณุฑูุฉ ูุงููุฑุงุณูุงุช ุงูุฐููุฉ (Phase 3)

### 6.1 ุจูุงุจุฉ ุงูููุธู (Employee PWA)

**ุงูููุณูุฉ:** ูุงุฌูุฉ "ุจุฏูู ุฌูุฏ" โ ุดุงุดุฉ ูุงุญุฏุฉ ุชุนุฑุถ ูู ูุง ูุญุชุงุฌู ุงูููุธู.

**ุฑุญูุฉ ุงููุณุชุฎุฏู:**

1. ูุฏุฎู ุงูููุธู โ ุชุธูุฑ ููุญุฉ ุงูููุงุฏุฉ ููุฑุงู ุจุงูุนุฑุจูุฉ (RTL)
2. ูุฑู 4 ุฃุฏูุงุช ุฐููุฉ:
   - ๐ฐ๏ธ **ุฃุฏุงุฉ ุงูุญุถูุฑ** โ ุญุงูุฉ GPS ูุจุงุดุฑุฉ (ุฏุงุฎู/ุฎุงุฑุฌ ูุทุงู 17ู)
   - ๐ **ูุฑูุฒ ุงูููุงุท** โ ุงูููุงุท ูุงูุฃูุงู ุงููุชุชุงููุฉ ูุงูุดุงุฑุงุช
   - ๐ฐ **ุงูุฃุซุฑ ุงููุงูู** โ "ููุงุท ุงูุงูุถุจุงุท" (ุชูููุฉ ุงูุชุฃุฎูุฑ)
   - ๐ข **ุงูุชุนูููุงุช** โ ุขุฎุฑ ุงูุชุนูููุงุช ูุน ุฒุฑ "ูุฑุฃุช ูุงุทูุนุช"
3. ูู ุงูุดุฑูุท ุงูุฌุงูุจู: ุงููุฑุงุณูุงุชุ ุงูุจูุงุบุงุช ุงูุณุฑูุฉ
4. **ุงููุตุงุฆุฏ ูุฏูุฌุฉ** ุจุณูุงุณุฉ โ ุชุจุฏู ูุฌุฒุก ุทุจูุนู ูู ุงููุงุฌูุฉ

**ุงูุชุตููู:**

- ุฎุท **Tajawal** ูุฎุท ุฃุณุงุณู
- RTL ุงูุชุฑุงุถู ูุน ุฏุนู LTR ููุฅูุฌููุฒูุฉ
- ูุชุฌุงูุจ (Mobile-First) ุนุจุฑ Tailwind CSS
- ุฃููุงู ูุคุณุณูุฉ: ุฃุฎุถุฑ ุฒูุฑุฏู + ุฑูุงุฏู ูุญูู

### 6.2 ูุธุงู ุงูุจูุงุบุงุช ุงูุณุฑูุฉ (ุงูููุงุฉ ุงูุขููุฉ)

**ุขููุฉ ุงูุณุฑูุฉ:**

- ูุง ููุทูุจ ุงุณู ุงูููุธู ููุง ุจุฑูุฏู โ ุจูุงุบ ูุฌููู 100%
- ูููุดุฃ **ุฑูุฒ ุชุชุจุน** ูุฑูุฏ (WB-XXXXXXXX-NNNNNN) + **ุฑูุฒ ุณุฑู** ูููุชุงุจุนุฉ
- ุงููุญุชูู ููุดููุฑ ุจู `AES-256-CBC` ุนุจุฑ `encrypt()` ูุจู ุงูุชุฎุฒูู
- **ูุง ูููู** ูุฃู ุดุฎุต ูุฑุงุกุฉ ุงูุจูุงุบ ุฅูุง ูุณุชูู ุฃููู 10 (ุงููุฏูุฑ ุงูุนุงู)

**ุชุฌุฑุจุฉ ุงูููุจููุบ:**

1. ูุฎุชุงุฑ ุงููุฆุฉ (fraud, harassment, corruption, safety)
2. ููุชุจ ุชูุงุตูู ุงูุจูุงุบ
3. ูุฎุชุงุฑ ูุณุชูู ุงูุฎุทูุฑุฉ
4. ูุญุตู ุนูู ุฑูุฒ ุงูุชุชุจุน + ุงูุฑูุฒ ุงูุณุฑู
5. ููููู ูุงุญูุงู ุงูุงุณุชุนูุงู ุจุงูุฑูุฒ ุงูุณุฑู ููุชุงุจุนุฉ ุญุงูุฉ ุงูุจูุงุบ

### 6.3 ุงููุฑุงุณูุงุช ุงูุฐููุฉ

| ุงูููุฒุฉ                        | ุงููุตู                                                                       |
| ----------------------------------- | -------------------------------------------------------------------------------- |
| ุงููุญุงุฏุซุงุช ุงููุจุงุดุฑุฉ | ุฑุณุงุฆู ุจูู ููุธูููู ูุน ุชุฃููุฏ ุงููุฑุงุกุฉ                  |
| ูุฌููุนุงุช ุงูุนูู           | ูุญุงุฏุซุงุช ุฌูุงุนูุฉ ููุฑู ุงูุนูู                                  |
| ุงูุชุนูููุงุช ุงูุฑุณููุฉ   | ุฅุนูุงูุงุช ูู ุงูุฅุฏุงุฑุฉ ูุน "ุฅุดุนุงุฑ ุงููุฑุงุกุฉ"              |
| ุชูุงูู ุงููุตุงุฆุฏ           | ุฃุฒุฑุงุฑ ูุฒููุฉ (ูู "ุชุณุฑูุจ ุงูุฑูุงุชุจ") ูุฏูุฌุฉ ุจุณูุงุณุฉ |

---

## 7. ุบุฑูุฉ ุงูููุงุฏุฉ: ููุณูุฉ "ุตูุฑ ุฌูุฏ" (v1.4.0)

### 7.1 ุงูููููู

ููุญุฉ ุชุญูู "ุบุฑูุฉ ุงูููุงุฏุฉ" ูุตููุฉ ูุชููุญ ุงููุฏูุฑ ูุงููุณุชูู 10 (Super Admin) ุฑุคูุฉ ููุฑูุฉ ุดุงููุฉ ูุตุญุฉ ุงูููุธูุฉ ุจุฏูู ุฃู ููุฑุงุช ุฅุถุงููุฉ:

| ุงูููููู                         | ุงููุธููุฉ                                                                                                         | ุงูุชุญุฏูุซ                       |
| -------------------------------------- | ---------------------------------------------------------------------------------------------------------------------- | ------------------------------------ |
| ุนุฏุงุฏ ุงูุฎุณุงุฆุฑ ุงููุญุธู   | ุฅุฌูุงูู ุงูุฎุณุงุฑุฉ ุงููุงููุฉ ูู ุงูุชุฃุฎูุฑุงุช โ ุฌููุน ุงููุฑูุน โ ุงูููู ุงูุญุงูู | ูุญุธู ุนูุฏ ุชุญููู Filament  |
| ุฎุฑูุทุฉ ุฃุฏุงุก ุงููุฑูุน       | ููุงุฑูุฉ ุจุตุฑูุฉ ุจูู ุงููุฑูุน: ุฏูุฉ ุงูุญุถูุฑ + ุงูุงูุชุซุงู ููุณูุงุฌ ุงูุฌุบุฑุงูู      | ุจูุงูุงุช ุงูุดูุฑ ุงูุญุงูู |
| ูุฑูุฒ ุชูุจููุงุช ุงููุฒุงูุฉ | ุขุฎุฑ ุชูุงุนูุงุช ุงููุตุงุฆุฏ + ุญุงูุงุช ุจูุงุบุงุช ุงููุจููุบูู (ูุณุชูู 10 ุญุตุฑูุงู)         | ูุญุธู                             |

### 7.2 ูุญุฑู ุงูุชุญููู ุงููุงูู

| ุงูุชูุฑูุฑ                         | ุงููุนุงุฏูุฉ                                                                         |
| -------------------------------------- | ---------------------------------------------------------------------------------------- |
| ุชุญููู ุฃุซุฑ ุงูุชุฃุฎูุฑ (ROI) | `ROI = (potential_loss - actual_loss) / potential_loss ร 100`                         |
| ุงูุชูุจุค ุงูุดูุฑู              | `predicted_monthly_loss = avg_daily_loss ร remaining_working_days + accumulated_loss` |
| ูุทุงู ุงูุชูุงุฑูุฑ              | ููุธู ูุฑุฏ / ูุณู / ูุฑุน / ุงูุดุฑูุฉ ุจุงููุงูู                          |

### 7.3 ูุจู ุงูุจูุงุบุงุช ูุงููุตุงุฆุฏ (ูุณุชูู 10)

- ูู ุชุดููุฑ ุจูุงุบุงุช ุงููุจููุบูู ูุน ุณุฌู ุงููุฑุงุฌุนุฉ ุงููุงูู
- ุฑุณู ุจูุงูู ูููู ุงููุฎุงุทุฑ ุจูุงุกู ุนูู ูุญุฑู ุงููุฎุงุทุฑ ุงูููุบุงุฑูุชูู
- ุจูุงุจุฉ ุฃูุงู: `security_level >= 10` ููุท โ ุฃู ูุญุงููุฉ ูุตูู ุบูุฑ ูุตุฑุญ ุจูุง ุชูุณุฌููู

---

## 8. ุณุฌู ุงูุชุญุฏูุซุงุช

| ุงูุชุงุฑูุฎ | ุงูุฅุตุฏุงุฑ | ุงููุตู                                                                                                                                                                                                                                                        |
| -------------- | -------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| 2026-02-07     | 1.0.0          | ุงูุชุฃุณูุณ ุงูุฃููู โ ูุฎุทุท ูุงุนุฏุฉ ุงูุจูุงูุงุช + ููุงุฐุฌ Eloquent + ุจุฐูุฑ RBAC ูุงูุดุงุฑุงุช                                                                                                                                        |
| 2026-02-07     | 1.1.0          | ุงููุฑุญูุฉ ุงูุฃููู โ ููุธููุฉ ุงูุญุถูุฑ ุงูุฌุบุฑุงูู ูุน GeofencingService ู AttendanceService ู Filament Resource                                                                                                                        |
| 2026-02-07     | 1.2.0          | ุงููุฑุญูุฉ ุงูุซุงููุฉ โ ูุธุงู ุงููุตุงุฆุฏ ุงูููุณูุฉ: ุฌุฏูู trapsุ TrapResponseServiceุ ูุญุฑู ุงููุฎุงุทุฑ ุงูููุบุงุฑูุชููุ Filament Resources + RiskWidget                                                                  |
| 2026-02-07     | 1.3.0          | ุงููุฑุญูุฉ ุงูุซุงูุซุฉ โ ุจูุงุจุฉ ุงูููุธู PWA (Livewire 3 + Alpine.js)ุ ุงูุจูุงุบุงุช ุงูุณุฑูุฉ ุงููุดูุฑุฉุ ุงููุฑุงุณูุงุช ุงูุฐููุฉุ ุชูุงูู ุงููุตุงุฆุฏ ุจุงููุงุฌูุฉ                                               |
| 2026-02-08     | 1.4.0          | ุงููุฑุญูุฉ ุงูุฑุงุจุนุฉ โ ุบุฑูุฉ ุงูููุงุฏุฉ: 3 widgets ูุญุธูุฉุ ูุญุฑู ุงูุชูุงุฑูุฑ ุงููุงููุฉุ ุงูุชุญูููุงุช ุงูุชูุจุคูุฉุ ูุจู ุงููุณุชูู 10                                                                        |
| 2026-02-08     | 1.5.0          | ุงููุฑุญูุฉ ุงูุฎุงูุณุฉ (ุงูุฃุฎูุฑุฉ) โ ุงูุชุฌููุฒ ููุฅูุชุงุฌ: ุชุตููุจ ุฃูููุ ููุงุฑุณ ุงูุฃุฏุงุกุ ุงูุชุฎุฒูู ุงููุคูุช ููุงุณุชุนูุงูุงุช ุงููุงููุฉุ ุฃูุฑ ุงูุชุซุจูุช `sarh:install`ุ ุฏููู ุงููุดุฑ |
| 2026-02-10 | 3.0.0 | ุฅุนุงุฏุฉ ููููุฉ BI: AttendanceOverview, RealTimeLossCounter, EfficiencyScoreCard, ROIMatrix, AttendanceHeatmap. ุฅุตูุงุญ Map Picker, DeploymentDataPage, ุชุฑุฌูุงุช ุนุฑุจูุฉ ุดุงููุฉ |
| 2026-02-11 | 3.1.0 | ููุชุฑ ุงูุชุงุฑูุฎ ูููุญุฉ ุงูููุงุฏุฉ: HasDashboardFilter trait, 7 ูุฏุฌุงุช ููุญุฏูุซุฉ, ุฅุตูุงุญ ุชุฑุฌูุฉ "ุนูุงุฆุฏ ูุณุชูุฑุฉ" |
| 2026-02-12 | 3.2.0 | ููุทู ุฏููุงูููู: GeneralSettingsPage, RecalculateMonthlyAttendanceJob, ุฅุตูุงุญ ุชุดููุฑ ูููุงุช ุงููุฑูุฑ ุงููุฒุฏูุฌ |
| 2026-02-12 | 3.3.0 | ุฅุตูุงุญ 500 ูููุญุฉ ุงูููุงุฏุฉ: safeFilters(), parseDateSafe(), wire:poll ูู 7 ูุฏุฌุงุช, ุงูููุฎุต ุงููุงูู ูููุฑูุน, ุฅุฌุฑุงุกุงุช ุฌูุงุนูุฉ |
| 2026-02-13 | 3.4.0 | **ุฅุนุงุฏุฉ ููููุฉ ูุนูุงุฑูุฉ:** UserShift + UserBadge ูููุงุฐุฌ ููุงูุงุช ูุณุชููุฉ, BelongsToManyโHasMany, scopes + business logic |
| 2026-02-13 | 3.4.1 | ูุตุงูุน (ShiftFactory, BadgeFactory, UserShiftFactory, UserBadgeFactory), ุงุฎุชุจุงุฑุงุช (UserShiftTest 11 ุญุงูุฉ, UserBadgeTest 9 ุญุงูุงุช), FixUserShiftsDataSeeder |

---

## 9. ุฏููู ุงููุฏูุฑ ุงูููุงุฆู โ ููุฎุต ุงูุชุดุบูู

### 9.1 ุฃูู ุฏุฎูู ูููุธุงู

ุจุนุฏ ุงูุชุซุจูุชุ ูุจุฏุฃ ุงููุฏูุฑ ุจุชูููุฐ:

```bash
php artisan sarh:install
```

ูุฐุง ุงูุฃูุฑ ูููุดุฆ ุงูุฃุฏูุงุฑ ุงูุนุดุฑุฉ ูุงูุตูุงุญูุงุช ูุงูุดุงุฑุงุช ูุงููุตุงุฆุฏ ููุทูุจ ุจูุงูุงุช ุงููุฏูุฑ ุงูุนุงู (Level 10).

### 9.2 ููุญุฉ ุงูููุงุฏุฉ โ ูุงุฐุง ุชุนูู ุงูุฃุฑูุงูุ

| ุงููุคุดุฑ                     | ุงููุนูู                          | ุงูุฅุฌุฑุงุก ุงููุทููุจ                   |
| -------------------------------- | ------------------------------------- | ----------------------------------------------- |
| ุนุฏุงุฏ ุงูุฎุณุงุฆุฑ = 0      | ูุง ุฎุณุงุฆุฑ ูุงููุฉ ุงูููู | ููุชุงุฒ โ ูุง ุฅุฌุฑุงุก                   |
| ุนุฏุงุฏ ุงูุฎุณุงุฆุฑ > 500    | ุฎุณุงุฆุฑ ุชุชุฌุงูุฒ 500 ุฑูุงู  | ูุฑุงุฌุนุฉ ูุฑุน ุงูุฎุณุงุฑุฉ ุงูุฃุนูู |
| ุชูุฏูุฑ ุงููุฑุน = ุถุนูู | ูุนุฏู ุงูุถุจุงุท ุฃูู ูู 70% | ุชุญููู ููุฑู ูู ุงููุฑุน             |
| ุชูุจูู ูุฒุงูุฉ (ุฃุญูุฑ) | ูุณุชูู ุฎุทุฑ ุญุฑุฌ              | ูุชุญ ูุจู ุงููุตุงุฆุฏ ููุฑุงู         |
| ุจูุงุบ ุณุฑู ุฌุฏูุฏ         | ุจูุงุบ ุจุฏุฑุฌุฉ "ุญุฑุฌ"          | ูู ุงูุชุดููุฑ ูุงูุชุญููู            |

### 9.3 ุงูุชุฎุฒูู ุงููุคูุช ูุงูุฃุฏุงุก

ุงูุชูุงุฑูุฑ ุงููุงููุฉ ุงูุซูููุฉ ูุชู ุชุฎุฒูููุง ูุคูุชุงู ููุฏุฉ 5 ุฏูุงุฆู. ูููู ูุณุญ ุงูุฐุงูุฑุฉ ุงููุคูุชุฉ ุนุจุฑ:

```bash
php artisan cache:clear
```

### 9.4 ุงููุณุฎ ุงูุงุญุชูุงุทู

ูููุตุญ ุจุนูู ูุณุฎุฉ ุงุญุชูุงุทูุฉ ููููุฉ ููุงุนุฏุฉ ุงูุจูุงูุงุช:

```bash
mysqldump -u root -p sarh > backup_$(date +%Y%m%d).sql
```

---

## 10. ุชุฑููุฉ ูุงุฌูุฉ ุงููุณุชุฎุฏู ูุงูุตูุงุญูุงุช ุงููุทููุฉ (ุงูุฅุตุฏุงุฑ 1.6.0)

### 10.1 ุงููููุฉ ุงูุจุตุฑูุฉ ุงูุฌุฏูุฏุฉ

| ุงูุนูุตุฑ | ุงููููุฉ ุงููุฏููุฉ | ุงููููุฉ ุงูุฌุฏูุฏุฉ |
|--------|---------------|----------------|
| ุงูููู ุงูุฃุณุงุณู | ุฃุฎุถุฑ ุฒูุฑุฏู | **ุจุฑุชูุงูู** |
| ุงูุฎุท | Tajawal (ุฌุฒุฆู) | **Tajawal (ุดุงูู)** |
| ุงูุดุฑูุท ุงูุฌุงูุจู | ุซุงุจุช | **ูุงุจู ููุทู ุนูู ุณุทุญ ุงูููุชุจ** |

### 10.2 ุชุจุณูุท ุฅุฏุงุฑุฉ ุงูููุธููู

**ุงูุฃุฑุจุนุฉ ุงูุฃุณุงุณูุฉ ุงููุทููุจุฉ:**
1. **ุงูุงุณู** (ุนุฑุจู + ุฅูุฌููุฒู)
2. **ุงูุจุฑูุฏ ุงูุฅููุชุฑููู**
3. **ูููุฉ ุงููุฑูุฑ**
4. **ุงูุฑุงุชุจ ุงูุฃุณุงุณู** (ุถุฑูุฑู ููุญุฑู ุชูููุฉ ุงูุฏูููุฉ)

**ุฅุถุงูุฉ ุฅูุฒุงููุฉ:** ุตูุฑุฉ ุดุฎุตูุฉ (ุฑูุน ููู ูุน ูุต ุฏุงุฆุฑู)

**ุงูููู ุงูุงูุชุฑุงุถูุฉ ุงูุชููุงุฆูุฉ:**
- ุฃูุงู ุงูุนูู ุงูุดูุฑูุฉ = 22
- ุณุงุนุงุช ุงูุนูู ุงูููููุฉ = 8
- ุงููุบุฉ = ุงูุนุฑุจูุฉ
- ุงูููุทูุฉ ุงูุฒูููุฉ = ุขุณูุง/ุงูุฑูุงุถ

### 10.3 ุฎุงุฑุทุฉ ุงููุฑูุน ุงูุฐููุฉ

- **ููุชูู ุฎุฑุงุฆุท Leaflet.js** โ ููุฑ ุฃู ุณุญุจ ูุชุญุฏูุฏ ุงููููุน
- **ูุตู ูุทุฑ ุงูุณูุงุฌ ุงูุฌุบุฑุงูู:** ูู 1 ูุชุฑ ุฅูู 100,000 ูุชุฑ ุจุฏูู ูููุฏ
- ุฏุงุฆุฑุฉ ูุฑุฆูุฉ ุจุฑุชูุงููุฉ ุชูุธูุฑ ูุทุงู ุงูุณูุงุฌ ุนูู ุงูุฎุฑูุทุฉ

### 10.4 ุณูุทุฉ ุงููุณุชูู ุงูุนุงุดุฑ ุงููุทููุฉ ("ูุถุน ุงููู")

- `Gate::before()` ูููุญ ุงููุณุชูู 10 ุตูุงุญูุงุช ูุทููุฉ ุจูุง ุงุณุชุซูุงุก
- **ุชุฌุงูุฒ ุงูุณูุงุฌ ุงูุฌุบุฑุงูู:** ุงููุณุชูู 10 ููููู ุชุณุฌูู ุญุถูุฑ ูู ุฃู ููุงู
- **ูุจู ุงูุจูุงุบุงุช:** ูุตูู ูุงูู ุบูุฑ ูุดูุฑ
- **ุณุฌู ุงููุตุงุฆุฏ:** ูุตูู ูุงูู ูุน ุชุชุจุน ุงููุฑุงุฌุนุฉ

---

## 11. ูุญุฑู ุงูููุงูุณุฉ ูููุญุฉ ูุณุชููุงุช ุงููุฑูุน (ุงูุฅุตุฏุงุฑ 1.7.0)

### 11.1 ุงูุจูุงูุงุช ุงูุฃูููุฉ ุงูุดุงููุฉ

- **5 ูุฑูุน ุญููููุฉ** (ุฌููุนูุง ุจูุตู ูุทุฑ ุณูุงุฌ 17 ูุชุฑุงู):
  - SARH-HQ: ุตุฑุญ ุงูุงุชูุงู ุงูุฑุฆูุณู (24.572368, 46.602829) โ 4 ููุธููู (Amjad, Ayman, Najeeb, Zaher)
  - SARH-CORNER: ุตุฑุญ ุงูุงุชูุงู ููุฑูุฑ (24.572439, 46.603008) โ 7 ููุธููู (Abawe, Arnous, Bilal, Inay_us, Musab, Shaaban, Wakas)
  - SARH-2: ุตุฑุญ ุงูุงุชูุงู 2 (24.572262, 46.602580) โ 5 ููุธููู (Abu Suleiman, Bukhari, Islam, Mohsen, Saber)
  - FADA-1: ูุถุงุก ุงููุญุฑูุงุช 1 (24.56968126, 46.61405911) โ 8 ููุธููู (Abbas, Abdulhadi, Afridi, Bilal.M, Jalal, Munther, Mustafa, Salvador)
  - FADA-2: ูุถุงุก ุงููุญุฑูุงุช 2 (24.566088, 46.621759) โ 11 ููุธูุงู (Abd_y, Afzal, Habib, Imti, Inay, Irfan, Jihad, Qutaiba, Risha, Shehata, Wassim)
- **36 ูุณุชุฎุฏูุงู** (35 ููุธูุงู + 1 ูุฏูุฑ ูุธุงู: abdullah@sarh.app, emp001)
- **ุฅุญุฏุงุซูุงุช GPS ูุนููุฉ** ููู ูุฑุน ูุน ูุตู ูุทุฑ ุณูุงุฌ 17 ูุชุฑุงู ููุญุฏ
- **ูููุฉ ูุฑูุฑ ููุญุฏุฉ:** `Goolbx512!!` ูุฌููุน ุงูุญุณุงุจุงุช ุงูุชุฌุฑูุจูุฉ

### 11.2 ููุญุฉ ูุณุชููุงุช ุงููุฑูุน (Branch Leaderboard)

**ูุงุฐุง ุชูุนู ูููุฏูุฑุ**

- ุชูุธูุฑ ุชุฑุชูุจ ุงููุฑูุน ุญุณุจ **ุฃูู ุฎุณุงุฑุฉ ูุงููุฉ** ูู ุงูุชุฃุฎูุฑุงุช (ูููุณ ุงูููุงุท)
- ุชุญูู ุงูููุงูุณุฉ ุจูู ุงููุฑูุน ุฅูู **ูุนุจุฉ ูุงุถุญุฉ** ุจูุณุชููุงุช ูุฑููุฒ
- ุชุญูุฒ ุงููุฏูุฑูู ุนูู ุชุญุณูู ุฃุฏุงุก ูุฑูุนูู ุจุดูู ุทุจูุนู

**ูุนุงุฏูุฉ ุงูุญุณุงุจ:**

- ุงููุงุนุฏุฉ: 100 ููุทุฉ ููู ูุฑุน
- ุฎุตู **-2** ููู ุชุฃุฎูุฑ ูู ุงูุดูุฑ
- ุฎุตู **-5** ููู ููู ุบูุงุจ
- ููุงูุฃุฉ **+10** ููู ููุธู ุจุฏูู ุฃู ุชุฃุฎูุฑ
- ููุงูุฃุฉ **+0.1ร** ููุงุท ุงูุชููุฒ ุงููุชุฑุงููุฉ

**ุงููุณุชููุงุช ุงูุณุชุฉ:**

| ุงููุณุชูู | ุงูุฑูุฒ | ุงููุทุงู |
|---------|-------|--------|
| ุฃุณุทูุฑู | ๐ | โฅ 150 |
| ุฃููุงุณู | ๐ | โฅ 120 |
| ุฐูุจู | ๐ฅ | โฅ 100 |
| ูุถู | ๐ฅ | โฅ 80 |
| ุจุฑููุฒู | ๐ฅ | โฅ 60 |
| ูุจุชุฏุฆ | ๐ข | < 60 |

### 11.3 ูุธุงู ุงููุฃุณ ูุงูุณูุญูุงุฉ

- **๐ ุงููุฃุณ:** ููุธูุฑ ุฃูู ุชุณุฌูู ุญุถูุฑ ุงูููู ููู ูุฑุน (ุฃุจูุฑ `check_in_at` ูู `attendance_logs`)
- **๐ข ุงูุณูุญูุงุฉ:** ููุธูุฑ ุขุฎุฑ ุชุณุฌูู ุญุถูุฑ ุงูููู ููู ูุฑุน (ุฃุญุฏุซ `check_in_at`)
- **ุดุฑูุท ุงูุฃุฎุจุงุฑ ุงููุชุญุฑู (DailyNewsTicker):** ูุนุฑุถ ููู ูุฑุน ๐ ุฃูู ุญุถูุฑ / ๐ข ุขุฎุฑ ุญุถูุฑ + ุฅุญุตุงุฆูุงุช ููููุฉ

### 11.4 ุงูุชุญูู ุงููุฏูู ูู ุงูููุงุท

- **ุงูููุงู:** ุฌุฏูู ุงูููุธููู โ ุฒุฑ "ุชุนุฏูู ุงูููุงุท" (โญ)
- **ุงูุตูุงุญูุฉ:** ุงููุณุชูู 10 ููุท
- **ุงูุขููุฉ:** ุฅุฏุฎุงู ุฑูู (ููุฌุจ ููุฅุถุงูุฉุ ุณุงูุจ ููุฎุตู) + ุณุจุจ ุงูุชุนุฏูู
- **ุงูุชุณุฌูู:** ููุญูุธ ุนุจุฑ ูููุฐุฌ `PointsTransaction` ูุน ูููุฉ ุงููุนุฏููู

### 11.5 ุฎุท Cairo ุงูุฌุฏูุฏ

- ุชู ุงุณุชุจุฏุงู ุฎุท **Tajawal** ุจุฎุท **Cairo** ูุฏุนู ุฃูุถู ููุนุฑุจูุฉ ูุงูุฅูุฌููุฒูุฉ
- ูุดูู 7 ุฃูุฒุงู: ูู ุฑููุน (300) ุฅูู ุซููู ุฌุฏุงู (900)

---

## 12. ุฅุนุงุฏุฉ ุงูููููุฉ ุงููุนูุงุฑูุฉ โ ููุงุฐุฌ ุงูููุงูุงุช ุงููุณุชููุฉ (ุงูุฅุตุฏุงุฑ 3.4)

### 12.1 ุงููุดููุฉ: ุงููุตุงู ูุนูุงุฑู

ูุงู ุงููุธุงู ูุณุชุฎุฏู 3 ููุณูุงุช ูุฎุชููุฉ ูุฌุฏุงูู ุงูุนูุงูุงุช:
1. **Pivot ุจุฏูู ููุฏูู** โ ูุฌุฏุงูู FK ููุท (ูุซู `role_permission`)
2. **Pivot ูุน `withPivot()`** โ ูุญููู ุจุณูุทุฉ (ูุซู `conversation_participants`)
3. **Pivot ุจููุทู ุฃุนูุงู** โ `user_shifts` ู`user_badges` ุจููุง ุชูุงุฑูุฎ ูุญุงูุงุช ูุดุฑูุท

ุงููุดููุฉ: ุงูููุณูุฉ ุงูุซุงูุซุฉ ุชุฎูู "ููุงู ูููููุน ุจุฒู Pivot". ุชุนูููุงุช ุงูููุงูุจุงุช ููุง **ุตูุงุญูุฉ ุฒูููุฉ** (effective_from/to)ุ ู**ุญุงูุฉ** (is_current)ุ ูููุญ ุงูุดุงุฑุงุช ููุง **ุชูุซูู** (awarded_at, awarded_reason). ูุฐู ููุณุช ุนูุงูุงุช ุจุณูุทุฉ โ ุฅููุง ุนููุฏ ูุฅูุฌุงุฒุงุช.

### 12.2 ุงูุญู: ููุงุฐุฌ ููุงูุงุช ูุณุชููุฉ

| ุงููููุฐุฌ ุงูุฌุฏูุฏ | ุงูุฌุฏูู | ุงูุบุฑุถ |
|---------------|--------|-------|
| `UserShift` | `user_shifts` | ุนูุฏ ุชุนููู ููุงูุจุฉ โ ุตูุงุญูุฉ ุฒูููุฉุ ุชุฏูููุ ููุงููุฉ |
| `UserBadge` | `user_badges` | ุฅูุฌุงุฒ ููุซู โ ูุงูุญุ ุณุจุจุ ููุช |

### 12.3 ูููุฐุฌ ุชุนููู ุงูููุงูุจุงุช (`UserShift`)

**ูุงุฐุง ููุนู ูููุฏูุฑุ**
- ููุซู **ูู ุนููู** ูุฐุง ุงูุดูุช (assigned_by) ู**ูู ูุงูู** (approved_by)
- ูุญูุธ **ุงููุชุฑุฉ ุงูุฒูููุฉ** (ูู/ุฅูู) ูุน ุฅููุงููุฉ ุงูุฅููุงุก (`terminate()`)
- ูููุน ุงูุชุนุงุฑุถ ุนุจุฑ `makeCurrent()` ุงูุฐู ูููุบู ุฌููุน ุงูุชุนูููุงุช ุงูุฃุฎุฑู ุชููุงุฆูุงู
- ูููุฑ **ุชุงุฑูุฎ ูุงูู** ููููุงูุจุงุช ุนุจุฑ `shiftHistory()`

**ุงูุฃุนูุฏุฉ:**

| ุงูุนููุฏ | ุงูููุน | ุงููุตู |
|--------|------|-------|
| `user_id` | FK | ุงูููุธู ุงููุนููู |
| `shift_id` | FK | ุงูููุงูุจุฉ |
| `assigned_by` | FK nullable | ูู ูุงู ุจุงูุชุนููู |
| `approved_by` | FK nullable | ูู ูุงูู ุนูู ุงูุชุนููู |
| `effective_from` | date | ุจุฏุงูุฉ ุงูุตูุงุญูุฉ |
| `effective_to` | date nullable | ููุงูุฉ ุงูุตูุงุญูุฉ (null = ููุชูุญ) |
| `is_current` | boolean | ูู ูุฐุง ุงูุชุนููู ุงูุญุงูู |
| `reason` | text nullable | ุณุจุจ ุงูุชุนููู/ุงูุฅููุงุก |
| `approved_at` | timestamp nullable | ููุช ุงูููุงููุฉ |

### 12.4 ูููุฐุฌ ููุญ ุงูุดุงุฑุงุช (`UserBadge`)

**ูุงุฐุง ููุนู ูููุฏูุฑุ**
- ููุซู **ูู ููุญ** ุงูุดุงุฑุฉ (awarded_by) โ ูุง ุดุงุฑุฉ ุจุฏูู ูุณุคูู
- ูุญุณุจ **ุงูููุงุท ุชููุงุฆูุงู** ุนุจุฑ `UserBadge::award()` โ ูุถูู ููุงุท ููููุธู ูููุดุฆ PointsTransaction
- ูููุฑ scopes ููุงุณุชุนูุงู ุญุณุจ ุงููุชุฑุฉ (`awardedBetween`) ุฃู ุงูููุธู (`forUser`)

### 12.5 ุชุญููู ุงูุนูุงูุงุช

| ุงููููุฐุฌ | ุงูุนูุงูุฉ ุงููุฏููุฉ | ุงูุนูุงูุฉ ุงูุฌุฏูุฏุฉ |
|---------|----------------|----------------|
| `User` | `badges(): BelongsToMany(Badge)` | `badges(): HasMany(UserBadge)` |
| `User` | `shifts(): BelongsToMany(Shift)` | `shifts(): HasMany(UserShift)` |
| `User` | `currentShift(): ?Shift` (via pivot) | `currentShift(): ?Shift` (via UserShiftโshift) |
| `Shift` | `users(): BelongsToMany(User)` | `assignments(): HasMany(UserShift)` |
| `Badge` | `users(): BelongsToMany(User)` | `awards(): HasMany(UserBadge)` |

**ุฏูุงู ุฌุฏูุฏุฉ ุนูู User:**
- `activeShift(): ?UserShift` โ ุงูุชุนููู ุงููุดุท ุงูุญุงูู
- `shiftHistory(): HasMany` โ ุชุงุฑูุฎ ุงูููุงูุจุงุช ูุฑุชุจ ูู ุงูุฃุญุฏุซ
- `awardedBadges(): HasMany` โ ุงูุดุงุฑุงุช ูุน eager-load ูุจูุงูุงุช ุงูุดุงุฑุฉ

### 12.6 ูุตุญุญ ุงูุจูุงูุงุช (FixUserShiftsDataSeeder)

- ูููุฃ ุงูุฃุนูุฏุฉ ุงูุฌุฏูุฏุฉ (`assigned_by`, `approved_by`, `approved_at`, `reason`, `awarded_by`) ูู ุงูุณุฌูุงุช ุงูููุฌูุฏุฉ
- ููุณูุฏ ุงูููู ูููุฏูุฑ ุงูุฃุนูู (Super Admin) ุงูุชุฑุงุถูุงู ูุน ุณุจุจ "ุชุฑุญูู ุชููุงุฆู"
- ููุดุบูู ูุฑุฉ ูุงุญุฏุฉ ููุท ุจุนุฏ ุชุดุบูู ุงููุงูุฌุฑูุดู

### 12.7 ูุตุงูุน ุงูุงุฎุชุจุงุฑ ูุงูุงุฎุชุจุงุฑุงุช

| ุงูููู | ุงูุบุฑุถ |
|-------|-------|
| `ShiftFactory` | ููุงูุจุงุช ุจุฃููุงุช ูุงูุนูุฉ (ุตุจุงุญู/ูุณุงุฆู/ูููู) ูุน ุญุงูุงุช `inactive()` ู`overnight()` |
| `BadgeFactory` | ุดุงุฑุงุช ุจูุฆุงุช ูุฃููุงู ูููุงุท ูุน ุญุงูุงุช `inactive()` ู`withPoints()` |
| `UserShiftFactory` | ุชุนูููุงุช ูุน ุญุงูุงุช `expired()`, `current()`, `withApproval()` |
| `UserBadgeFactory` | ููุญ ูุน ุญุงูุงุช `withReason()`, `awardedBy()` |
| `UserShiftTest` | 11 ุงุฎุชุจุงุฑ: ุนูุงูุงุชุ activeShiftุ currentShift (backward compat)ุ terminateุ makeCurrentุ isValidOnุ scopes |
| `UserBadgeTest` | 9 ุงุฎุชุจุงุฑุงุช: ุนูุงูุงุชุ award ูุน ููุงุทุ award ุจุฏูู ููุงุทุ scopes |

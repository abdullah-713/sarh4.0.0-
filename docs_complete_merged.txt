================================================================================
                    ุชูุซูู ูุธุงู ูุคุดุฑ ุตุฑุญ (SarhIndex) - ุงููุณุฎุฉ ุงููุงููุฉ
================================================================================

ุดุฌุฑุฉ ูููุงุช ูุฌูุฏ ุงูุชูุซูู (docs/):
โโโ 01-overview.md
โโโ 02-project-structure.md
โโโ 03-database-models.md
โโโ 04-roles-permissions.md
โโโ 05-filament-components.md
โโโ 06-financial-system.md
โโโ 07-attendance-system.md
โโโ 08-analytics-system.md
โโโ 09-communication-system.md
โโโ 10-gamification-system.md
โโโ 11-management-system.md
โโโ 12-trap-system.md
โโโ 13-commands-services.md
โโโ 14-ui-design.md
โโโ 15-deployment.md
โโโ 16-development-guide.md
โโโ 17-glossary.md
โโโ README.md

================================================================================


================================================================================
ุงูููู: 01-overview.md
================================================================================

# 1. ูุธุฑุฉ ุนุงูุฉ ุนูู ูุธุงู ูุคุดุฑ ุตุฑุญ (SarhIndex)

## 1.1 ูุง ูู ูุธุงู ูุคุดุฑ ุตุฑุญุ

**ูุคุดุฑ ุตุฑุญ (SarhIndex)** ูู ูุธุงู ูุชูุงูู ูุฅุฏุงุฑุฉ ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ ูุตูู ุฎุตูุตูุง ูููุคุณุณุงุช ุงูุนุฑุจูุฉ. ูุฌูุน ุจูู ุฅุฏุงุฑุฉ ุงูุญุถูุฑ ูุงูุงูุตุฑุงูุ ุงูุฑูุงุชุจุ ุงูุชุญูููุงุช ุงููุงููุฉุ ุงูุชูุงุตู ุงูุฏุงุฎููุ ูุงูุชุญููุฒ ูู ููุตุฉ ูุงุญุฏุฉ ุฐููุฉ.

### ุงูุงุณู
- **ุณูุฑ**: ุงุฎุชุตุงุฑ ูู "**ุณ**ููุธุงู **ูู**ููููุฉ ูุฅุฏุงุฑุฉ ุงูููุง**ุฑ**ูุฏ ุงูุจุดุฑูุฉ"
- **ุงูุฅุชูุงู**: ูุนูุณ ููุณูุฉ ุงููุธุงู ูู ุชุชุจุน ุฌูุฏุฉ ุงูุฃุฏุงุก ูุงูุฏูุฉ

## 1.2 ุงูุฃูุฏุงู ุงูุฑุฆูุณูุฉ

1. **ุชุญููู ุงูุชูููุฉ ุฅูู ูููุฉ ูุฑุฆูุฉ**: ูู ุฏูููุฉ ุชุฃุฎูุฑ ุชูุญุณุจ ุจุงูุฑูุงู ููุฑุงูุง ุงููุฏูุฑ ูู ุงูููุช ุงูุญูููู
2. **ุงูุดูุงููุฉ ุงููุงููุฉ**: ุงูููุธู ูุฑู ุชุฃุซูุฑ ุญุถูุฑู ุงููุงูู ุนูู ูุฑุนู
3. **ุงูุชุญููุฒ ุงูุณูููู**: ูุธุงู ููุงุท ูุดุงุฑุงุช ูููุงูุณุงุช ุจูู ุงููุฑูุน
4. **ุงููุดู ุงููุจูุฑ**: ุชุญููู ุฃููุงุท ุงูุณููู ูุงูุชุดุงู ุงูุดุฐูุฐ ูุจู ุชูุงููู
5. **ุงูุฃูุงู ุงููุชุนุฏุฏ ุงูุทุจูุงุช**: 10 ูุณุชููุงุช ุฃูููุฉ + ูุฎุงุฎ ููุณูุฉ ูููุชูุงุนุจูู

## 1.3 ุงูุจููุฉ ุงููุนูุงุฑูุฉ

### ููุญุชุงู ูููุตูุชุงู

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                     ูุธุงู ูุคุดุฑ ุตุฑุญ (SarhIndex)                         โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ   ููุญุฉ ุงูุฅุฏุงุฑุฉ /admin   โ     ุจูุงุจุฉ ุงูููุธู /app             โ
โ   (ุงููุณุชูู 4 ูุฃุนูู)     โ     (ุงููุณุชูู 1-3)                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ โข ุฅุฏุงุฑุฉ ุงูููุธููู        โ โข ุชุณุฌูู ุงูุญุถูุฑ (GPS)              โ
โ โข ูุดูู ุงูุฑูุงุชุจ          โ โข ุทูุจ ุงูุฅุฌุงุฒุงุช                    โ
โ โข ุงูุชูุงุฑูุฑ ุงููุงููุฉ       โ โข ุงููุญุงุฏุซุงุช                       โ
โ โข ุงูุชุญูููุงุช             โ โข ุงูุชุนุงููู                        โ
โ โข ุงูุชุนุงููู              โ โข ุงูููุงุท ูุงูุดุงุฑุงุช                 โ
โ โข ุงูุฅุนุฏุงุฏุงุช             โ โข ููุงูุณุฉ ุงููุฑูุน                   โ
โ โข ูุธุงู ุงููุฎุงุฎ (L10)     โ โข ุงูุจูุงุบุงุช ุงูุณุฑูุฉ                 โ
โ โข ุงูุฎุฒูุฉ ุงูุณุฑูุฉ (L10)   โ โข ุงูุฅุญุตุงุฆูุงุช ุงูุดุฎุตูุฉ              โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ุงููุญุฑู ุงููุงูู ุงูุฃุณุงุณู

ุงูููุฑุฉ ุงููุฑูุฒูุฉ ูู ุณูุฑ ูู ุชุญููู **ููุช ุงูููุธู ุฅูู ุชูููุฉ ูุงููุฉ ุจุงูุฏูููุฉ**:

```
ุชูููุฉ ุงูุฏูููุฉ = ุงูุฑุงุชุจ ุงูุฅุฌูุงูู รท ุฃูุงู ุงูุนูู ุงูุดูุฑูุฉ รท ุณุงุนุงุช ุงูุนูู ุงูููููุฉ รท 60

ูุซุงู: ุฑุงุชุจ 10,000 ุฑูุงู รท 22 ููู รท 8 ุณุงุนุงุช รท 60 ุฏูููุฉ = 0.95 ุฑูุงู/ุฏูููุฉ

ุชูููุฉ ุงูุชุฃุฎูุฑ = ุฏูุงุฆู ุงูุชุฃุฎูุฑ ร ุชูููุฉ ุงูุฏูููุฉ ร ูุนุงูู ุงูุฎุณุงุฑุฉ (2.0)
```

ูุฐุง ูุนูู ุฃู ุชุฃุฎูุฑ 30 ุฏูููุฉ ูููุธู ุฑุงุชุจู 10,000 ุฑูุงู = **57 ุฑูุงู ุฎุณุงุฑุฉ** (ูุน ูุนุงูู ร2).

## 1.4 ุงููููุฒุงุช ุงูุฑุฆูุณูุฉ

### ๐ ุงูุญุถูุฑ ูุงูุงูุตุฑุงู
- ุชุณุฌูู ุญุถูุฑ ุนุจุฑ GPS ูุน ุณูุงุฌ ุฌุบุฑุงูู (Geofencing)
- ุญุณุงุจ ุงููุณุงูุฉ ูู ุงููุฑุน ุจุฏูุฉ (ุฎูุงุฑุฒููุฉ Haversine)
- ุงุณุชุซูุงุกุงุช ูุฑูุฉ (ุนูู ุนู ุจูุนุฏุ ุณุงุนุงุช ูุฑูุฉุ VIP)
- ูุฑุฏูุงุช ูุชุนุฏุฏุฉ ูุน ุฏุนู ุงููุฑุฏูุงุช ุงูููููุฉ

### ๐ฐ ุงููุธุงู ุงููุงูู
- ุชุญููู ุชููุงุฆู ููุชุฃุฎูุฑ ุฅูู ุฎุณุงุฑุฉ ูุงููุฉ
- ูุดูู ุฑูุงุชุจ ุดุงููุฉ (ุฃุณุงุณู + ุจุฏูุงุช + ุฎุตููุงุช)
- ุชูุงุฑูุฑ ูุงููุฉ ุนูู ูุณุชูู ุงูุดุฑูุฉ/ุงููุฑุน/ุงููุณู/ุงูููุธู
- ุชููุนุงุช ุงูุฎุณุงุฑุฉ ุงูุดูุฑูุฉ

### ๐ ุงูุชุญูููุงุช
- ููุงุกุฉ ุงููุฑุน (40% ุญุถูุฑ + 30% ุงูุถุจุงุท + 20% ุงุณุชุจูุงุก + 10% ุณูุงุณู)
- ูุตูููุฉ ROI (ูุฌู / ุจูุฑุฉ ุญููุจ / ุฅููุงููุฉ / ุฎุทุฑ)
- ุฎุฑูุทุฉ ุญุฑุงุฑูุฉ ููุญุถูุฑ
- ูุดู ุงูุฃููุงุท ุงูุณููููุฉ (ุชุฃุฎูุฑ ุฃูุงู ูุญุฏุฏุฉุ ูุบุงุฏุฑุฉ ูุจูุฑุฉ ูุชูุฑุฑุฉ...)
- ุนุฏุงุฏ ุงููุฑุต ุงูุถุงุฆุนุฉ ุจุงูููุช ุงูุญูููู

### ๐ ุงูุชุญููุฒ ูุงูููุงูุณุฉ
- ุดุงุฑุงุช ุฅูุฌุงุฒ (ุฃูู ุญุถูุฑุ ุณูุณูุฉ ุญุถูุฑุ ุจุทู ุงูุดูุฑ...)
- ููุงุท ุชุฌููุนูุฉ ูุน ุณุฌู ุงููุนุงููุงุช
- ููุงูุณุฉ ุจูู ุงููุฑูุน ูุน 6 ูุณุชููุงุช (ูุจุชุฏุฆ โ ุฃุณุทูุฑู)
- ููุญุฉ ูุชุตุฏุฑูู ุญูุฉ

### ๐ ุงูุฃูุงู
- 10 ูุณุชููุงุช ุฃูููุฉ ูุฑููุฉ
- ุตูุงุญูุงุช ูุฑุฏูุฉ (ููุญ/ุณุญุจ) ููู ูุณุชุฎุฏู
- ูุฎุงุฎ ููุณูุฉ ููุดู ุงููุชูุงุนุจูู
- ุชุดููุฑ ุงูุจูุงุบุงุช ุงูุณุฑูุฉ
- ุณุฌู ุชุฏููู ุดุงูู

### ๐ฑ ุงูุชุฌุฑุจุฉ
- ุชุตููู Mobile-First ูุนูู ุจูุฏ ูุงุญุฏุฉ
- ุชุทุจูู ููุจ ุชูุฏูู (PWA) ููุซุจูุช ูุชุทุจูู
- ูุงุฌูุฉ ุนุฑุจูุฉ ูุงููุฉ (RTL)
- ุซูู Navy + Gold ุฃููู

## 1.5 ุงูุชูููุงุช ุงููุณุชุฎุฏูุฉ

| ุงูุชูููุฉ | ุงูุฅุตุฏุงุฑ | ุงูุงุณุชุฎุฏุงู |
|---------|---------|-----------|
| PHP | 8.2+ | ูุบุฉ ุงูุฎุงุฏู ุงูุฑุฆูุณูุฉ |
| Laravel | 11.x | ุฅุทุงุฑ ุงูุนูู ุงูุฃุณุงุณู |
| Filament | 3.x | ููุญุฉ ุงูุฅุฏุงุฑุฉ (Admin Panel) |
| Livewire | 3.x | ููููุงุช ุชูุงุนููุฉ ุจุฏูู JavaScript |
| Tailwind CSS | 3.x | ุชูุณูู ุงููุงุฌูุฉ |
| Alpine.js | 3.x | ุชูุงุนูุงุช JavaScript ุฎูููุฉ |
| MySQL/MariaDB | 8.x/10.x | ูุงุนุฏุฉ ุงูุจูุงูุงุช |
| Vite | 6.x | ุจูุงุก ุงูุฃุตูู ุงูุฃูุงููุฉ |
| Symfony ExpressionLanguage | 7.x | ุชูููู ุงููุนุงุฏูุงุช ุงููุงููุฉ ุจุฃูุงู |

## 1.6 ูุชุทูุจุงุช ุงููุธุงู

### ูุชุทูุจุงุช ุงูุฎุงุฏู
- PHP 8.2 ุฃู ุฃุญุฏุซ ูุน ุงูุฅุถุงูุงุช: BCMath, Ctype, JSON, Mbstring, OpenSSL, PDO, Tokenizer, XML
- MySQL 8.0+ ุฃู MariaDB 10.5+
- Composer 2.x
- Node.js 18+ (ููุจูุงุก ููุท)
- ูุณุงุญุฉ ุชุฎุฒูู: 500 ููุฌุงุจุงูุช ุนูู ุงูุฃูู

### ูุชุทูุจุงุช ุงููุชุตูุญ
- Chrome 90+ (ููุตู ุจู)
- Safari 15+
- Firefox 90+
- Edge 90+
- ูุฏุนู ุงูููุงุชู ุงูุฐููุฉ (Android 8+, iOS 14+)

---

> **ุงูุชุงูู**: [ูููู ุงููุดุฑูุน](02-project-structure.md) โ ุดุฑุญ ุชูุตููู ููุฌูุฏุงุช ููููุงุช ุงููุดุฑูุน



================================================================================
ุงูููู: 02-project-structure.md
================================================================================

# 2. ูููู ุงููุดุฑูุน

## 2.1 ูุธุฑุฉ ุนุงูุฉ ุนูู ุงููุฌูุฏุงุช

```
sarh/
โโโ app/                    โ ุงูููุฏ ุงูุฑุฆูุณู ููุชุทุจูู
โ   โโโ Console/            โ ุฃูุงูุฑ Artisan ุงููุฎุตุตุฉ
โ   โโโ Events/             โ ุงูุฃุญุฏุงุซ (Events)
โ   โโโ Exceptions/         โ ุงูุงุณุชุซูุงุกุงุช ุงููุฎุตุตุฉ
โ   โโโ Filament/           โ ููููุงุช ููุญุฉ ุงูุฅุฏุงุฑุฉ
โ   โโโ Helpers/            โ ุงูุฏูุงู ุงููุณุงุนุฏุฉ
โ   โโโ Http/               โ ุงููุชุญููุงุช ูุงููุณูุทุงุช
โ   โโโ Jobs/               โ ุงููุธุงุฆู ุงููุคุฌูุฉ (Queued Jobs)
โ   โโโ Listeners/          โ ูุณุชูุนุงุช ุงูุฃุญุฏุงุซ
โ   โโโ Livewire/           โ ููููุงุช ุจูุงุจุฉ ุงูููุธู
โ   โโโ Models/             โ ููุงุฐุฌ ูุงุนุฏุฉ ุงูุจูุงูุงุช
โ   โโโ Policies/           โ ุณูุงุณุงุช ุงูุชูููุถ
โ   โโโ Providers/          โ ูุฒูุฏุงุช ุงูุฎุฏูุฉ
โ   โโโ Services/           โ ุฎุฏูุงุช ููุทู ุงูุนูู
โโโ bootstrap/              โ ูููุงุช ุฅููุงุน Laravel
โโโ config/                 โ ูููุงุช ุงูุฅุนุฏุงุฏุงุช
โโโ database/               โ ุงูุชูุฌูุฑุงุช ูุงูุจุฐูุฑ ูุงููุตุงูุน
โโโ docs/                   โ ุงูุชูุซูู (ุฃูุช ููุง)
โโโ lang/                   โ ูููุงุช ุงูุชุฑุฌูุฉ (ar/en)
โโโ public/                 โ ุงููููุงุช ุงูุนุงูุฉ (ููุทุฉ ุงูุฏุฎูู)
โโโ resources/              โ ุงูุนุฑูุถ ูุงูุฃุตูู
โโโ routes/                 โ ุชุนุฑูู ุงููุณุงุฑุงุช
โโโ storage/                โ ุงูุชุฎุฒูู ุงููุญูู ูุงูุณุฌูุงุช
โโโ tests/                  โ ุงูุงุฎุชุจุงุฑุงุช
โโโ vendor/                 โ ุญุฒู Composer (ูุง ุชูุนุฏูู)
```

## 2.2 ูุฌูุฏ app/ โ ุงูุชูุตูู ุงููุงูู

### app/Console/Commands/
ุฃูุงูุฑ Artisan ุงููุฎุตุตุฉ ุงูุชู ูููู ุชุดุบูููุง ูู ุณุทุฑ ุงูุฃูุงูุฑ:

| ุงูููู | ุงูุฃูุฑ | ุงููุตู |
|-------|-------|-------|
| `InstallCommand.php` | `sarh:install` | ูุนุงูุฌ ุงูุชุซุจูุช ุงููุงูู |
| `AutoDocumentCommand.php` | `sarh:auto-document` | ุชูููุฏ ุงูุชูุซูู ุชููุงุฆููุง |
| `RunAnalyticsCommand.php` | `sarh:analytics` | ุชุดุบูู ูุญุฑู ุงูุชุญูููุงุช |
| `GeneratePayrollCommand.php` | `sarh:payroll` | ุชูููุฏ ูุดูู ุงูุฑูุงุชุจ |
| `DailyTelemetryStatsCommand.php` | `telemetry:daily-stats` | ุฅุญุตุงุฆูุงุช ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ |

### app/Events/
ุงูุฃุญุฏุงุซ ุงูุชู ููุทูููุง ุงููุธุงู ุนูุฏ ุญุฏูุซ ุนูููุงุช ูุนููุฉ:

| ุงูููู | ูุชู ููุทููุ | ุงูุจูุงูุงุช ุงููุฑููุฉ |
|-------|-----------|-----------------|
| `AttendanceRecorded.php` | ุนูุฏ ุชุณุฌูู ุญุถูุฑ/ุงูุตุฑุงู | ุณุฌู ุงูุญุถูุฑ `AttendanceLog` |
| `BadgeAwarded.php` | ุนูุฏ ููุญ ุดุงุฑุฉ ูููุธู | ุดุงุฑุฉ ุงููุณุชุฎุฏู `UserBadge` |
| `AnomalyDetected.php` | ุนูุฏ ุงูุชุดุงู ุดุฐูุฐ ูู ุงูุจูุงูุงุช | ุงููุณุชุฎุฏู + ุงููุฑุงุกุฉ + ุณุฌู ุงูุดุฐูุฐ |
| `TrapTriggered.php` | ุนูุฏ ุชูุนูู ูุฎ ููุณู | ุงููุฎ + ุงููุณุชุฎุฏู + ุงูุชูุงุนู |

### app/Exceptions/
ุงุณุชุซูุงุกุงุช ูุฎุตุตุฉ ููุชุนุงูู ูุน ุญุงูุงุช ุงุณุชุซูุงุฆูุฉ:

| ุงูููู | ุงูุงุณุชุฎุฏุงู |
|-------|-----------|
| `BusinessException.php` | ุฃุฎุทุงุก ููุทู ุงูุนูู (ูุซู: ุงูููุธู ุบูุฑ ูุดุท) |
| `OutOfGeofenceException.php` | ูุญุงููุฉ ุชุณุฌูู ุญุถูุฑ ุฎุงุฑุฌ ุงููุทุงู ุงูุฌุบุฑุงูู |

### app/Filament/
ููููุงุช ููุญุฉ ุงูุฅุฏุงุฑุฉ ุงููุจููุฉ ุนูู Filament v3:

```
Filament/
โโโ App/                    โ ุจูุงุจุฉ ุงูููุธู (/app)
โ   โโโ Pages/              โ ุตูุญุงุช ุงูููุธู
โ   โโโ Resources/          โ ููุงุฑุฏ ุงูููุธู (ุญุถูุฑูุ ุฅุฌุงุฒุงุชู)
โ   โโโ Widgets/            โ ููุฏุฌุงุช ููุญุฉ ุงูููุธู
โโโ Pages/                  โ ุตูุญุงุช ุงูุฅุฏุงุฑุฉ (14 ุตูุญุฉ)
โโโ Resources/              โ ููุงุฑุฏ ุงูุฅุฏุงุฑุฉ (21 ููุฑุฏ)
โโโ Widgets/                โ ููุฏุฌุงุช ููุญุฉ ุงูุฅุฏุงุฑุฉ (11 ููุฏุฌุช)
```

โ ุชูุงุตูู ูุงููุฉ ูู [ููููุงุช Filament](05-filament-components.md)

### app/Helpers/
ุฏูุงู ูุณุงุนุฏุฉ ุนุงูุฉ:

| ุงูููู | ุงูุฏุงูุฉ | ุงููุตู |
|-------|--------|-------|
| `ArabicHelper.php` | `toArabicDigits()` | ุชุญููู ุงูุฃุฑูุงู ุงูุบุฑุจูุฉ (0-9) ุฅูู ุฃุฑูุงู ุนุฑุจูุฉ (ู-ูฉ) |

### app/Http/
ุงููุชุญููุงุช ูุงููุณูุทุงุช:

#### Middleware/
| ุงูููู | ุงููุธููุฉ |
|-------|---------|
| `EnsureAdminPanelAccess.php` | ูููุน ุงูููุธููู (ุงููุณุชูู < 4) ูู ุงููุตูู ูููุญุฉ ุงูุฅุฏุงุฑุฉ |
| `SetPermissionsPolicy.php` | ูุถูู ุฑุคูุณ ุฃูุงู HTTP: ูุณูุญ ุจุงููููุน ุงูุฌุบุฑุงูู ููููุน ุงููุงููุฑุง ูุงููููุฑูููู |

### app/Jobs/
ุงููุธุงุฆู ุงููุคุฌูุฉ ุงูุชู ุชุนูู ูู ุงูุฎูููุฉ:

| ุงูููู | ุงููุธููุฉ | ุงููููุฉ | ุงููุญุงููุงุช |
|-------|---------|--------|-----------|
| `ProcessAttendanceJob.php` | ูุนุงูุฌุฉ ุชุณุฌูู ุงูุญุถูุฑ ุนุจุฑ ุงูุทุงุจูุฑ | 30 ุซุงููุฉ | 3 |
| `RecalculateMonthlyAttendanceJob.php` | ุฅุนุงุฏุฉ ุญุณุงุจ ุงูุญุถูุฑ ูุงููุงููุฉ ุงูุดูุฑูุฉ | 300 ุซุงููุฉ | 1 |
| `SendCircularJob.php` | ุฅุฑุณุงู ุงูุชุนุงููู ูุฅุดุนุงุฑุงุช (ุฏูุนุงุช ูู 100) | โ | โ |

### app/Listeners/
ูุณุชูุนุงุช ุงูุฃุญุฏุงุซ โ ุชููุฐ ููุทููุง ุนูุฏ ุฅุทูุงู ุญุฏุซ:

| ุงูููู | ูุณุชูุน ูู | ูุงุฐุง ููุนู |
|-------|----------|----------|
| `HandleAttendanceRecorded.php` | `AttendanceRecorded` | ููุดุฆ ุณุฌู ุชุฏููู `AuditLog` |
| `HandleBadgePoints.php` | `BadgeAwarded` | ููุดุฆ ุชูุจูู ุฃุฏุงุก ุชููุฆุฉ |
| `HandleAnomalyDetected.php` | `AnomalyDetected` | ููุดุฆ ุชูุจูู ุฃุฏุงุก ุจุชูุงุตูู ุงูุดุฐูุฐ |
| `HandleTrapTriggered.php` | `TrapTriggered` | ูุณุฌู ูู ููุงุฉ ุณุฌู ููููุฉุ ุญุฑุฌ ุนูุฏ ุงูุชุตุนูุฏ |

### app/Livewire/
ููููุงุช Livewire ูุจูุงุจุฉ ุงูููุธู (12 ูููู):

| ุงูููู | ุงููุณุงุฑ | ุงููุธููุฉ |
|-------|--------|---------|
| `EmployeeDashboard.php` | `/dashboard` | ููุญุฉ ุงูููุธู ุงูุฑุฆูุณูุฉ |
| `AttendanceWidget.php` | ููุฏุฌุช | ุชุณุฌูู ุงูุญุถูุฑ ุจุงูู GPS |
| `AttendanceStatsWidget.php` | ููุฏุฌุช | ุฅุญุตุงุฆูุงุช ุงูุญุถูุฑ ุงูุดูุฑูุฉ |
| `FinancialWidget.php` | ููุฏุฌุช | ุชุฃุซูุฑ ุงูุชุฃุฎูุฑ ุงููุงูู |
| `GamificationWidget.php` | ููุฏุฌุช | ุงูููุงุท ูุงูุดุงุฑุงุช ูุงูุณูุงุณู |
| `CompetitionWidget.php` | ููุฏุฌุช | ููุญุฉ ููุงูุณุฉ ุงููุฑูุน |
| `BranchProgressWidget.php` | ููุฏุฌุช | ุชูุฏู ุงููุฑุน ุงูุญุงูู |
| `CircularsWidget.php` | ููุฏุฌุช | ุงูุชุนุงููู ุงููุดุทุฉ |
| `MessagingInbox.php` | `/messaging` | ุตูุฏูู ุงููุญุงุฏุซุงุช |
| `MessagingChat.php` | `/messaging/{id}` | ุงููุญุงุฏุซุฉ ุงููุจุงุดุฑุฉ |
| `WhistleblowerForm.php` | `/whistleblower` | ูููุฐุฌ ุงูุจูุงุบ ุงูุณุฑู (ูุฌููู) |
| `WhistleblowerTrack.php` | `/whistleblower/track` | ุชุชุจุน ุงูุจูุงุบ ุจุงูุฑูุฒ ุงูุณุฑู |

### app/Models/
ููุงุฐุฌ Eloquent โ 37 ูููุฐุฌ ููุซูู ุฌุฏุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช:

โ ุชูุงุตูู ูุงููุฉ ูู [ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูููุงุฐุฌ](03-database-models.md)

### app/Policies/
ุณูุงุณุงุช ุงูุชูููุถ ุงูุชู ุชุญุฏุฏ ูู ูุณุชุทูุน ูุนู ูุงุฐุง ุนูู ูุณุชูู ุงูุณุฌู:

โ ุชูุงุตูู ูุงููุฉ ูู [ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช](04-roles-permissions.md)

### app/Providers/
ูุฒูุฏุงุช ุงูุฎุฏูุฉ โ ุชูููููุฐ ุนูุฏ ุฅููุงุน ุงูุชุทุจูู:

| ุงูููู | ุงููุณุคูููุงุช |
|-------|-----------|
| `AppServiceProvider.php` | ุชุณุฌูู ุงูุฃุญุฏุงุซ ูุงููุณุชูุนุงุชุ ุชุนุฑูู ุงูุจูุงุจุงุช (Gates)ุ ุชุณุฌูู ุงูุณูุงุณุงุช (Policies)ุ ุฅุนุฏุงุฏ Blade ู Scramble |

### app/Services/
ุฎุฏูุงุช ููุทู ุงูุนูู โ ุงูุทุจูุฉ ุงููุณูุทุฉ ุจูู ุงููุชุญููุงุช ูุงูููุงุฐุฌ:

| ุงูููู | ุงููุณุคูููุฉ |
|-------|-----------|
| `AttendanceService.php` | ุชุณุฌูู ุงูุญุถูุฑ ูุงูุงูุตุฑุงู ูุน ุงูุณูุงุฌ ุงูุฌุบุฑุงูู |
| `GeofencingService.php` | ุญุณุงุจ ุงููุณุงูุงุช ูุงูุชุญูู ูู ุงููุทุงู ุงูุฌุบุฑุงูู |
| `FinancialReportingService.php` | ุญุณุงุจ ุงูุฎุณุงุฆุฑ ุงููุงููุฉ ูุชุญููู ุงูุชุฃุฎูุฑ |
| `FormulaEngineService.php` | ุชูููู ุงููุนุงุฏูุงุช ุงููุงููุฉ ุงููุฎุตุตุฉ |
| `AnalyticsService.php` | ูุญุฑู ุงูุชุญูููุงุช ุงูุดุงูู (889 ุณุทุฑ) |
| `TelemetryService.php` | ูุนุงูุฌุฉ ุจูุงูุงุช ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ |
| `TrapResponseService.php` | ูุนุงูุฌุฉ ุชูุงุนูุงุช ุงููุฎุงุฎ ุงูููุณูุฉ |
| `AnomalyDetector.php` | ูุดู ุงูุดุฐูุฐ ุงููุชูุฏู ูู ุงูุจูุงูุงุช |

โ ุชูุงุตูู ูุงููุฉ ูู [ุงูุฃูุงูุฑ ูุงูุฎุฏูุงุช](13-commands-services.md)

## 2.3 ูุฌูุฏ config/

| ุงูููู | ุงููุตู |
|-------|-------|
| `app.php` | ุฅุนุฏุงุฏุงุช ุงูุชุทุจูู: ุงููุบุฉ ุงูุนุฑุจูุฉุ ููุทูุฉ ุฒูููุฉ UTCุ Faker ุจุงูุนุฑุจูุฉ |
| `auth.php` | ุฅุนุฏุงุฏุงุช ุงููุตุงุฏูุฉ |
| `cache.php` | ุฅุนุฏุงุฏุงุช ุงูุชุฎุฒูู ุงููุคูุช (file driver) |
| `database.php` | ุฅุนุฏุงุฏุงุช ูุงุนุฏุฉ ุงูุจูุงูุงุช (MySQL) |
| `filesystems.php` | ุฅุนุฏุงุฏุงุช ูุธุงู ุงููููุงุช (local + public disks) |
| `logging.php` | ุฅุนุฏุงุฏุงุช ุงูุชุณุฌูู (daily channels) |
| `mail.php` | ุฅุนุฏุงุฏุงุช ุงูุจุฑูุฏ ุงูุฅููุชุฑููู |
| `queue.php` | ุฅุนุฏุงุฏุงุช ุงูุทูุงุจูุฑ (database driver) |
| `scramble.php` | ุฅุนุฏุงุฏุงุช ุชูุซูู API (ูุญูู ุจู auth middleware) |
| `session.php` | ุฅุนุฏุงุฏุงุช ุงูุฌูุณุงุช (file driver, SameSite=lax) |
| `services.php` | ุฅุนุฏุงุฏุงุช ุงูุฎุฏูุงุช ุงูุฎุงุฑุฌูุฉ |
| `telemetry.php` | ุฅุนุฏุงุฏุงุช ุงูููุงุณ ุนู ุจุนุฏ (ูุนุฏูุงุช ุงูุนููุงุชุ ุงูุฃูุฒุงูุ ุงูุนุชุจุงุช) |

## 2.4 ูุฌูุฏ database/

```
database/
โโโ factories/          โ ูุตุงูุน ุงูุจูุงูุงุช ุงูููููุฉ ููุงุฎุชุจุงุฑุงุช
โโโ migrations/         โ 35+ ููู ุชูุฌูุฑ ูุฅูุดุงุก ุงูุฌุฏุงูู
โโโ seeders/            โ ุจุฐูุฑ ุงูุจูุงูุงุช ุงูุฃูููุฉ
    โโโ DatabaseSeeder.php                    โ ุงูููุณูู ุงูุฑุฆูุณู
    โโโ RolesAndPermissionsSeeder.php         โ ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช
    โโโ BadgesSeeder.php                      โ ุงูุดุงุฑุงุช
    โโโ TrapsSeeder.php                       โ ุงููุฎุงุฎ ุงูููุณูุฉ
    โโโ ProjectDataSeeder.php                 โ ุจูุงูุงุช ุงููุดุฑูุน ุงููููุฐุฌูุฉ
    โโโ FixUserShiftsDataSeeder.php           โ ุฅุตูุงุญ ุฑุจุท ุงููุฑุฏูุงุช
```

## 2.5 ูุฌูุฏ lang/

```
lang/
โโโ ar/                 โ ุงูุชุฑุฌูุฉ ุงูุนุฑุจูุฉ (13 ููู)
โ   โโโ analytics.php   โ ูุตุทูุญุงุช ุงูุชุญูููุงุช
โ   โโโ app.php         โ ูุตุทูุญุงุช ุนุงูุฉ
โ   โโโ attendance.php  โ ูุตุทูุญุงุช ุงูุญุถูุฑ
โ   โโโ branches.php    โ ูุตุทูุญุงุช ุงููุฑูุน
โ   โโโ circulars.php   โ ูุตุทูุญุงุช ุงูุชุนุงููู
โ   โโโ command.php     โ ูุตุทูุญุงุช ุงูุฃูุงูุฑ
โ   โโโ competition.php โ ูุตุทูุญุงุช ุงูููุงูุณุฉ
โ   โโโ dashboard.php   โ ูุตุทูุญุงุช ููุญุฉ ุงูููุงุฏุฉ
โ   โโโ holidays.php    โ ูุตุทูุญุงุช ุงูุนุทูุงุช
โ   โโโ install.php     โ ูุตุทูุญุงุช ุงูุชุซุจูุช
โ   โโโ leaves.php      โ ูุตุทูุญุงุช ุงูุฅุฌุงุฒุงุช
โ   โโโ pwa.php         โ ูุตุทูุญุงุช ุงูุชุทุจูู ุงูุชูุฏูู
โ   โโโ users.php       โ ูุตุทูุญุงุช ุงููุณุชุฎุฏููู
โโโ en/                 โ ุงูุชุฑุฌูุฉ ุงูุฅูุฌููุฒูุฉ
    โโโ analytics.php   โ ูุตุทูุญุงุช ุงูุชุญูููุงุช ุจุงูุฅูุฌููุฒูุฉ
```

## 2.6 ูุฌูุฏ resources/

```
resources/
โโโ css/
โ   โโโ app.css                     โ ุฃููุงุท Tailwind ุงูุฑุฆูุณูุฉ
โโโ js/
โ   โโโ app.js                      โ JavaScript ุงูุฑุฆูุณู (Axios)
โโโ views/
    โโโ welcome.blade.php           โ ุตูุญุฉ ุงููุจูุท
    โโโ layouts/
    โ   โโโ pwa.blade.php           โ ุชุฎุทูุท PWA ูุจูุงุจุฉ ุงูููุธู
    โโโ livewire/                   โ ุนุฑูุถ ููููุงุช Livewire (12 ููู)
    โโโ filament/
    โ   โโโ pages/                  โ ุนุฑูุถ ุตูุญุงุช Filament (14 ููู)
    โ   โโโ widgets/                โ ุนุฑูุถ ููุฏุฌุงุช ุงูุฅุฏุงุฑุฉ (6 ูููุงุช)
    โ   โโโ app/                    โ ุนุฑูุถ ุจูุงุจุฉ ุงูููุธู
    โโโ components/
        โโโ map-picker.blade.php         โ ูููู ุงุฎุชูุงุฑ ุงููููุน (Leaflet)
        โโโ arabic-numerals.blade.php    โ ูููู ุงูุฃุฑูุงู ุงูุนุฑุจูุฉ
        โโโ pwa-install-button.blade.php โ ุฒุฑ ุชุซุจูุช PWA
```

## 2.7 ูุฌูุฏ routes/

| ุงูููู | ุงููุญุชูู |
|-------|---------|
| `web.php` | ุฌููุน ูุณุงุฑุงุช ุงูููุจ: API ุงูุญุถูุฑุ ุงูููุงุณ ุนู ุจุนุฏุ ุงููุฎุงุฎุ ุงูุจูุงุบุงุชุ PWA manifest |
| `console.php` | ุงูููุงู ุงููุฌุฏููุฉ (analytics ููููุ telemetry ููููุ recalculate ุดูุฑู) |

## 2.8 ูุฌูุฏ public/

| ุงูููู | ุงููุธููุฉ |
|-------|---------|
| `index.php` | ููุทุฉ ุงูุฏุฎูู ุงูุฑุฆูุณูุฉ (ูุณุงุฑุงุช ูุณุจูุฉ) |
| `robots.txt` | ุชุนูููุงุช ูุญุฑูุงุช ุงูุจุญุซ |
| `generate_icon.php` | ุชูููุฏ ุฃููููุงุช PWA |
| `build/` | ูููุงุช Vite ุงููุจููุฉ (CSS + JS) |

## 2.9 ูููุงุช ุงูุฌุฐุฑ ุงููููุฉ

| ุงูููู | ุงููุธููุฉ |
|-------|---------|
| `artisan` | ููุทุฉ ุฏุฎูู ุฃูุงูุฑ Artisan |
| `composer.json` | ุชุจุนูุงุช PHP ูุฅุนุฏุงุฏุงุช Composer |
| `package.json` | ุชุจุนูุงุช JavaScript ูุณูุฑูุจุชุงุช ุงูุจูุงุก |
| `vite.config.js` | ุฅุนุฏุงุฏุงุช Vite ูุจูุงุก ุงูุฃุตูู |
| `tailwind.config.js` | ุฅุนุฏุงุฏุงุช Tailwind CSS |
| `phpunit.xml` | ุฅุนุฏุงุฏุงุช PHPUnit ููุงุฎุชุจุงุฑุงุช |
| `deploy.sh` | ุณูุฑูุจุช ุงููุดุฑ ุงููุงูู |
| `deploy-quick.sh` | ุณูุฑูุจุช ุงููุดุฑ ุงูุณุฑูุน (git pull ููุท) |

---

> **ุงูุณุงุจู**: [ูุธุฑุฉ ุนุงูุฉ](01-overview.md) | **ุงูุชุงูู**: [ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูููุงุฐุฌ](03-database-models.md)



================================================================================
ุงูููู: 03-database-models.md
================================================================================

# 3. ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูููุงุฐุฌ

## 3.1 ูุธุฑุฉ ุนุงูุฉ

ูุญุชูู ุงููุธุงู ุนูู **35+ ุฌุฏูู** ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช ู **37 ูููุฐุฌ Eloquent**. ุงูุฌุฏุงูู ููุณูุฉ ุฅูู ูุฌููุนุงุช ูุธูููุฉ:

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ุฌุฏุงูู ูุงุนุฏุฉ ุงูุจูุงูุงุช                        โ
โโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโค
โ  ุงููููู      โ   ุงูููุธููู   โ   ุงูุชุดุบูู   โ   ุงูุชุญูููุงุช    โ
โ  ุงูุชูุธููู    โ   ูุงูุฃูุงู    โ   ุงููููู    โ   ูุงูุฑูุงุจุฉ     โ
โโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโค
โ branches     โ users        โ attendance   โ analytics       โ
โ departments  โ roles        โ leave_req    โ _snapshots      โ
โ shifts       โ permissions  โ payrolls     โ anomaly_logs    โ
โ holidays     โ user_perms   โ financial    โ employee        โ
โ user_shifts  โ role_perm    โ _reports     โ _patterns       โ
โ              โ              โ sensor       โ loss_alerts     โ
โ              โ              โ _readings    โ work_rest_stats โ
โ              โ              โ              โ audit_logs      โ
โโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโค
โ  ุงูุชูุงุตู ูุงูุชุญููุฒ          โ  ุงูุฃูุงู ูุงููุฎุงุฎ                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ conversations              โ traps                           โ
โ messages                   โ trap_interactions               โ
โ circulars                  โ whistleblower_reports           โ
โ badges / user_badges       โ score_adjustments               โ
โ points_transactions        โ report_formulas                 โ
โ employee_documents         โ attendance_exceptions           โ
โ employee_reminders         โ                                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

## 3.2 ุงูุฌุฏุงูู ุงูุฑุฆูุณูุฉ โ ุงูุชูุตูู ุงููุงูู

---

### 3.2.1 ุฌุฏูู `users` โ ุงูููุธููู

**ุงููููุฐุฌ**: `App\Models\User`  
**ุงูุณูุงุช ุงูุฎุงุตุฉ**: `SoftDeletes`, `FilamentUser`

#### ุงูุญููู

| ุงูุญูู | ุงูููุน | ุงููุตู |
|-------|-------|-------|
| `id` | bigint auto | ุงููุนุฑู ุงูุฃุณุงุณู |
| `employee_id` | string unique | ุงูุฑูู ุงููุธููู (`SI-YY-NNNN`) โ ูููููุฏ ุชููุงุฆููุง |
| `name_ar` | string | ุงูุงุณู ุจุงูุนุฑุจูุฉ |
| `name_en` | string nullable | ุงูุงุณู ุจุงูุฅูุฌููุฒูุฉ |
| `email` | string unique | ุงูุจุฑูุฏ ุงูุฅููุชุฑููู |
| `password` | string | ูููุฉ ุงููุฑูุฑ (ูุดููุฑุฉ bcrypt) |
| `phone` | string nullable | ุฑูู ุงููุงุชู |
| `national_id` | string nullable | ุฑูู ุงููููุฉ |
| `avatar` | string nullable | ูุณุงุฑ ุตูุฑุฉ ุงูููู ุงูุดุฎุตู |
| `gender` | enum(male,female) | ุงูุฌูุณ |
| `date_of_birth` | date nullable | ุชุงุฑูุฎ ุงููููุงุฏ |
| `branch_id` | FK โ branches | ุงููุฑุน |
| `department_id` | FK โ departments | ุงููุณู |
| `role_id` | FK โ roles | ุงูุฏูุฑ (ุดุฑูู ููุท) |
| `direct_manager_id` | FK โ users (self) | ุงููุฏูุฑ ุงููุจุงุดุฑ |
| `job_title_ar` | string nullable | ุงููุณูู ุงููุธููู ุจุงูุนุฑุจูุฉ |
| `job_title_en` | string nullable | ุงููุณูู ุงููุธููู ุจุงูุฅูุฌููุฒูุฉ |
| `hire_date` | date nullable | ุชุงุฑูุฎ ุงูุชุนููู |
| `employment_type` | enum(full_time,part_time,contract) | ููุน ุงูุชูุธูู |
| `status` | enum(active,inactive,suspended,terminated) | ุงูุญุงูุฉ |
| `is_super_admin` | boolean default false | ูู ูู ูุฏูุฑ ุฃุนููุ |
| `security_level` | integer default 2 | ูุณุชูู ุงูุฃูุงู (1-10) |
| **ุงูุญููู ุงููุงููุฉ** | | |
| `basic_salary` | decimal(10,2) default 0 | ุงูุฑุงุชุจ ุงูุฃุณุงุณู |
| `housing_allowance` | decimal(10,2) default 0 | ุจุฏู ุงูุณูู |
| `transport_allowance` | decimal(10,2) default 0 | ุจุฏู ุงูููู |
| `other_allowances` | decimal(10,2) default 0 | ุจุฏูุงุช ุฃุฎุฑู |
| `working_days_per_month` | integer default 22 | ุฃูุงู ุงูุนูู ุงูุดูุฑูุฉ |
| `working_hours_per_day` | decimal(4,2) default 8 | ุณุงุนุงุช ุงูุนูู ุงูููููุฉ |
| **ุญููู ุงูุชุญููุฒ** | | |
| `total_points` | integer default 0 | ูุฌููุน ุงูููุงุท |
| `current_streak` | integer default 0 | ุณูุณูุฉ ุงูุญุถูุฑ ุงูุญุงููุฉ |
| `longest_streak` | integer default 0 | ุฃุทูู ุณูุณูุฉ ุญุถูุฑ |
| **ุงูุชูุถููุงุช** | | |
| `locale` | string default 'ar' | ูุบุฉ ุงููุงุฌูุฉ |
| `timezone` | string default 'Asia/Riyadh' | ุงูููุทูุฉ ุงูุฒูููุฉ |

#### ุงูุนูุงูุงุช

```php
// ุนูุงูุงุช "ููุชูู ุฅูู" (BelongsTo)
$user->branch          // ุงููุฑุน
$user->department      // ุงููุณู
$user->role            // ุงูุฏูุฑ
$user->directManager   // ุงููุฏูุฑ ุงููุจุงุดุฑ

// ุนูุงูุงุช "ูุฏูู ูุซูุฑ" (HasMany)
$user->attendanceLogs      // ุณุฌูุงุช ุงูุญุถูุฑ
$user->leaveRequests       // ุทูุจุงุช ุงูุฅุฌุงุฒุฉ
$user->payrolls            // ูุดูู ุงูุฑูุงุชุจ
$user->badges              // ุงูุดุงุฑุงุช (ุนุจุฑ user_badges)
$user->pointsTransactions  // ูุนุงููุงุช ุงูููุงุท
$user->documents           // ุงููุซุงุฆู
$user->reminders           // ุงูุชุฐููุฑุงุช
$user->subordinates        // ุงููุฑุคูุณูู ุงููุจุงุดุฑูู
$user->userPermissions     // ุงูุตูุงุญูุงุช ุงููุฑุฏูุฉ
```

#### ุงูุฎุตุงุฆุต ุงููุญุณูุจุฉ (Accessors)

```php
$user->total_salary        // ุงูุฑุงุชุจ ุงูุฅุฌูุงูู = ุฃุณุงุณู + ุณูู + ููู + ุฃุฎุฑู
$user->monthly_working_minutes  // ุฏูุงุฆู ุงูุนูู ุงูุดูุฑูุฉ
$user->cost_per_minute     // ุชูููุฉ ุงูุฏูููุฉ ูู ุงูุฑุงุชุจ ุงูุฃุณุงุณู
$user->total_cost_per_minute   // ุชูููุฉ ุงูุฏูููุฉ ูู ุงูุฑุงุชุจ ุงูุฅุฌูุงูู
```

#### ุงูููุทู ุงูุฎุงุต

- **ุชูููุฏ ุงูุฑูู ุงููุธููู ุชููุงุฆููุง**: ุนูุฏ ุงูุฅูุดุงุก ูููููุฏ ุจุตูุบุฉ `SI-{ุณูุฉ}-{ุฑูู ุชุณูุณูู 4 ุฃุฑูุงู}`
- **ูุธุงู ุงูุตูุงุญูุงุช**: `hasPermission($slug)` ููุญุต: super_admin โ ุณุญุจ ูุฑุฏู โ ููุญ ูุฑุฏู โ ุตูุงุญูุฉ ุถูููุฉ โ false
- **ุงููุตูู ูููุญุงุช**: `canAccessPanel('admin')` ูุชุทูุจ security_level โฅ 4

---

### 3.2.2 ุฌุฏูู `branches` โ ุงููุฑูุน

**ุงููููุฐุฌ**: `App\Models\Branch` | **ุงูุณูุงุช**: `SoftDeletes`

| ุงูุญูู | ุงูููุน | ุงููุตู |
|-------|-------|-------|
| `id` | bigint auto | ุงููุนุฑู |
| `name_ar` / `name_en` | string | ุงุณู ุงููุฑุน |
| `code` | string unique | ุฑูุฒ ุงููุฑุน |
| `address` | text nullable | ุงูุนููุงู |
| `city_ar` / `city_en` | string nullable | ุงููุฏููุฉ |
| `latitude` / `longitude` | decimal(10,7) | ุงูุฅุญุฏุงุซูุงุช ุงูุฌุบุฑุงููุฉ |
| `geofence_radius` | integer default 100 | ูุตู ูุทุฑ ุงูุณูุงุฌ ุจุงูุฃูุชุงุฑ |
| `default_shift_start` / `end` | time | ุฃููุงุช ุงูุฏูุงู ุงูุงูุชุฑุงุถูุฉ |
| `default_grace_period` | integer default 15 | ูุชุฑุฉ ุงูุณูุงุญ ุจุงูุฏูุงุฆู |
| `monthly_salary_budget` | decimal(12,2) | ููุฒุงููุฉ ุงูุฑูุงุชุจ ุงูุดูุฑูุฉ |
| `target_attendance_rate` | decimal(5,2) | ูุนุฏู ุงูุญุถูุฑ ุงููุณุชูุฏู |
| `vpm_target` | decimal(8,2) | ูุฏู ุงููููุฉ ููู ุฏูููุฉ |
| `is_active` | boolean | ุงูุญุงูุฉ |

#### ุงูููุทู ุงูุฎุงุต
- `distanceTo($lat, $lng)` โ ุญุณุงุจ ุงููุณุงูุฉ ุจุงูุฃูุชุงุฑ ุจุงุณุชุฎุฏุงู Haversine
- `isWithinGeofence($lat, $lng)` โ ูู ุงูููุทุฉ ุฏุงุฎู ุงูุณูุงุฌุ
- `recalculateSalaryBudget()` โ ุฅุนุงุฏุฉ ุญุณุงุจ ุงูููุฒุงููุฉ ูู ุฑูุงุชุจ ุงูููุธููู

---

### 3.2.3 ุฌุฏูู `attendance_logs` โ ุณุฌูุงุช ุงูุญุถูุฑ

**ุงููููุฐุฌ**: `App\Models\AttendanceLog`

| ุงูุญูู | ุงูููุน | ุงููุตู |
|-------|-------|-------|
| `id` | bigint auto | ุงููุนุฑู |
| `user_id` | FK โ users | ุงูููุธู |
| `branch_id` | FK โ branches | ุงููุฑุน |
| `attendance_date` | date | ุชุงุฑูุฎ ุงูุญุถูุฑ |
| `check_in_time` | timestamp nullable | ููุช ุงูุญุถูุฑ |
| `check_in_latitude` / `longitude` | decimal | ุฅุญุฏุงุซูุงุช ุงูุญุถูุฑ |
| `check_in_distance` | decimal | ุงููุณุงูุฉ ูู ุงููุฑุน (ูุชุฑ) |
| `check_in_within_geofence` | boolean | ุฏุงุฎู ุงูุณูุงุฌุ |
| `check_in_ip` | string nullable | ุนููุงู IP |
| `check_in_device` | string nullable | ูุนูููุงุช ุงูุฌูุงุฒ |
| `check_out_time` | timestamp nullable | ููุช ุงูุงูุตุฑุงู |
| `check_out_latitude` / `longitude` | decimal | ุฅุญุฏุงุซูุงุช ุงูุงูุตุฑุงู |
| `status` | enum(present,late,absent,on_leave,holiday,exception) | ุงูุญุงูุฉ |
| `delay_minutes` | integer default 0 | ุฏูุงุฆู ุงูุชุฃุฎูุฑ |
| `early_leave_minutes` | integer default 0 | ุฏูุงุฆู ุงููุบุงุฏุฑุฉ ุงููุจูุฑุฉ |
| `overtime_minutes` | integer default 0 | ุฏูุงุฆู ุงูุนูู ุงูุฅุถุงูู |
| `cost_per_minute` | decimal(8,4) | ุชูููุฉ ุงูุฏูููุฉ (ููุทุฉ ูุงููุฉ) |
| `delay_cost` | decimal(10,2) | ุชูููุฉ ุงูุชุฃุฎูุฑ |
| `overtime_value` | decimal(10,2) | ูููุฉ ุงูุนูู ุงูุฅุถุงูู |
| `notes` | text nullable | ููุงุญุธุงุช |
| `approved_by` | FK โ users nullable | ูุนุชูุฏ ูู |

#### ุงูููุงุฑุณ ุงูููุฑูููุจุฉ
- `(branch_id, attendance_date)` โ ููุงุณุชุนูุงูุงุช ุญุณุจ ุงููุฑุน ูุงูุชุงุฑูุฎ
- `(user_id, attendance_date)` โ ููุงุณุชุนูุงูุงุช ุญุณุจ ุงูููุธู ูุงูุชุงุฑูุฎ

#### ุงูููุทู ุงูุฎุงุต
- `calculateFinancials()` โ ูุฃุฎุฐ ููุทุฉ ูู `cost_per_minute` ูููุณุชุฎุฏู ููุช ุงูุชุณุฌูู
- `evaluateAttendance()` โ ูุญุฏุฏ ุงูุญุงูุฉ (ุญุงุถุฑ/ูุชุฃุฎุฑ/ุบุงุฆุจ) ุจูุงุกู ุนูู ุงููุฑุฏูุฉ ููุชุฑุฉ ุงูุณูุงุญ

---

### 3.2.4 ุฌุฏูู `payrolls` โ ูุดูู ุงูุฑูุงุชุจ

**ุงููููุฐุฌ**: `App\Models\Payroll` | **ุงูุณูุงุช**: `SoftDeletes`

| ุงูุญูู | ุงูููุน | ุงููุตู |
|-------|-------|-------|
| `user_id` | FK โ users | ุงูููุธู |
| `branch_id` | FK โ branches | ุงููุฑุน |
| `period` | string | ุงููุชุฑุฉ (ูุซู 2026-02) |
| `basic_salary` | decimal | ุงูุฑุงุชุจ ุงูุฃุณุงุณู |
| `housing_allowance` | decimal | ุจุฏู ุงูุณูู |
| `transport_allowance` | decimal | ุจุฏู ุงูููู |
| `other_allowances` | decimal | ุจุฏูุงุช ุฃุฎุฑู |
| `total_salary` | decimal | ุฅุฌูุงูู ุงูุฑุงุชุจ ูุจู ุงูุฎุตููุงุช |
| `total_deductions` | decimal | ุฅุฌูุงูู ุงูุฎุตููุงุช |
| `absence_deduction` | decimal | ุฎุตู ุงูุบูุงุจ |
| `delay_deduction` | decimal | ุฎุตู ุงูุชุฃุฎูุฑ |
| `other_deductions` | decimal | ุฎุตููุงุช ุฃุฎุฑู |
| `total_additions` | decimal | ุฅุฌูุงูู ุงูุฅุถุงูุงุช |
| `overtime_addition` | decimal | ุฃุฌุฑ ุงูุนูู ุงูุฅุถุงูู |
| `bonus` | decimal | ุงูููุงูุขุช |
| `net_salary` | decimal | ุตุงูู ุงูุฑุงุชุจ |
| `working_days` | integer | ุฃูุงู ุงูุนูู |
| `present_days` | integer | ุฃูุงู ุงูุญุถูุฑ |
| `absent_days` | integer | ุฃูุงู ุงูุบูุงุจ |
| `late_days` | integer | ุฃูุงู ุงูุชุฃุฎุฑ |
| `total_delay_minutes` | integer | ุฅุฌูุงูู ุฏูุงุฆู ุงูุชุฃุฎูุฑ |
| `total_overtime_minutes` | integer | ุฅุฌูุงูู ุฏูุงุฆู ุงูุนูู ุงูุฅุถุงูู |
| `status` | enum(draft,approved,paid) | ุงูุญุงูุฉ |
| `approved_by` | FK โ users | ูุนุชูุฏ ูู |
| `notes` | text nullable | ููุงุญุธุงุช |

---

### 3.2.5 ุฌุฏูู `leave_requests` โ ุทูุจุงุช ุงูุฅุฌุงุฒุฉ

**ุงููููุฐุฌ**: `App\Models\LeaveRequest` | **ุงูุณูุงุช**: `SoftDeletes`

| ุงูุญูู | ุงูููุน | ุงููุตู |
|-------|-------|-------|
| `user_id` | FK โ users | ุงูููุธู |
| `leave_type` | enum(annual,sick,emergency,unpaid,...) | ููุน ุงูุฅุฌุงุฒุฉ |
| `start_date` / `end_date` | date | ูุชุฑุฉ ุงูุฅุฌุงุฒุฉ |
| `days_count` | integer | ุนุฏุฏ ุงูุฃูุงู |
| `reason` | text | ุงูุณุจุจ |
| `status` | enum(pending,approved,rejected,cancelled) | ุงูุญุงูุฉ |
| `approved_by` | FK โ users nullable | ูุนุชูุฏ ูู |
| `rejection_reason` | text nullable | ุณุจุจ ุงูุฑูุถ |

---

### 3.2.6 ุฌุฏูู `shifts` โ ุงููุฑุฏูุงุช

**ุงููููุฐุฌ**: `App\Models\Shift`

| ุงูุญูู | ุงูููุน | ุงููุตู |
|-------|-------|-------|
| `name_ar` / `name_en` | string | ุงุณู ุงููุฑุฏูุฉ |
| `start_time` / `end_time` | time | ููุช ุงูุจุฏุงูุฉ ูุงูููุงูุฉ |
| `grace_period_minutes` | integer default 15 | ูุชุฑุฉ ุงูุณูุงุญ |
| `is_overnight` | boolean | ูุฑุฏูุฉ ููููุฉุ |
| `is_active` | boolean | ูุดุทุฉุ |

**ุฌุฏูู ูุณูุท** `user_shifts`:

| ุงูุญูู | ุงููุตู |
|-------|-------|
| `user_id` | ุงูููุธู |
| `shift_id` | ุงููุฑุฏูุฉ |
| `is_current` | ูู ูู ุงููุฑุฏูุฉ ุงูุญุงููุฉุ |
| `effective_from` / `effective_to` | ูุชุฑุฉ ุงูุณุฑูุงู |

---

### 3.2.7 ุฌุฏูู `roles` โ ุงูุฃุฏูุงุฑ

**ุงููููุฐุฌ**: `App\Models\Role`

| ุงูุญูู | ุงูููุน | ุงููุตู |
|-------|-------|-------|
| `name_ar` / `name_en` | string | ุงุณู ุงูุฏูุฑ |
| `slug` | string unique | ุงููุนุฑู ุงููุฑูุฏ |
| `level` | integer (1-10) | ุงููุณุชูู ุงูุฃููู |
| `description` | text nullable | ุงููุตู |
| `is_system` | boolean | ุฏูุฑ ูุธุงูู (ูุง ูููู ุญุฐูู)ุ |

> โ๏ธ **ููู**: ุงูุฃุฏูุงุฑ ูู ุณูุฑ **ุดุฑููุฉ ููุท** โ ูุง ุชููุญ ุตูุงุญูุงุช. ุงูุตูุงุญูุงุช ุชูููุญ ุนุจุฑ `user_permissions`.

---

### 3.2.8 ุฌุฏูู `permissions` โ ุงูุตูุงุญูุงุช

**ุงููููุฐุฌ**: `App\Models\Permission`

| ุงูุญูู | ุงูููุน | ุงููุตู |
|-------|-------|-------|
| `name_ar` / `name_en` | string | ุงุณู ุงูุตูุงุญูุฉ |
| `slug` | string unique | ุงููุนุฑู (`manage-attendance`, `view-payroll`...) |
| `group` | string | ุงููุฌููุนุฉ (attendance, payroll, users...) |
| `description_en` | text nullable | ุงููุตู |

**ุฌุฏูู** `user_permissions`:

| ุงูุญูู | ุงููุตู |
|-------|-------|
| `user_id` | ุงูููุธู |
| `permission_id` | ุงูุตูุงุญูุฉ |
| `type` | enum(grant, revoke) โ ููุญ ุฃู ุณุญุจ |
| `expires_at` | datetime nullable โ ุชุงุฑูุฎ ุงูุงูุชูุงุก |

---

### 3.2.9 ุฌุฏูู `whistleblower_reports` โ ุงูุจูุงุบุงุช ุงูุณุฑูุฉ

**ุงููููุฐุฌ**: `App\Models\WhistleblowerReport`

| ุงูุญูู | ุงูููุน | ุงููุตู |
|-------|-------|-------|
| `ticket_number` | string unique | ุฑูู ุงูุชุฐูุฑุฉ (`WB-YMDHIS-RAND`) |
| `encrypted_content` | text | ุงููุญุชูู ุงููุดููุฑ (Laravel encrypt) |
| `category` | enum(corruption,harassment,...) | ุงูุชุตููู |
| `severity` | enum(low,medium,high,critical) | ุงูุฎุทูุฑุฉ |
| `status` | enum(new,investigating,resolved,dismissed) | ุงูุญุงูุฉ |
| `anonymous_token` | string(64) | ุฑูุฒ ุงูุชุชุจุน ุงููุฌููู |
| `evidence_path` | string nullable | ูุณุงุฑ ุงูุฏููู ุงููุฑูู |

#### ุงูุฎุตูุตูุฉ ูุงูุฃูุงู
- ุงููุญุชูู ูุดููุฑ ุนุจุฑ `encrypt()`/`decrypt()` ูู Laravel
- ูุง ูููู ูุฑุงุกุฉ ุงููุญุชูู ุฅูุง ูู ุตูุญุฉ ุงูุฎุฒูุฉ ุงูุณุฑูุฉ (ุงููุณุชูู 10)
- ุตูุญุฉ ุงูุชุชุจุน ูุง ุชุนุฑุถ ุงููุญุชูู ุฃุจุฏูุง โ ููุท ุงูุญุงูุฉ ูุงูุชุญุฏูุซุงุช

---

### 3.2.10 ุฌุฏุงูู ุงูุชูุงุตู

#### `conversations` โ ุงููุญุงุฏุซุงุช
| ุงูุญูู | ุงููุตู |
|-------|-------|
| `title` | ุนููุงู ุงููุญุงุฏุซุฉ |
| `type` | ููุน (direct, group) |
| `created_by` | ุงูููุดุฆ |

#### `conversation_participants` โ ุงููุดุงุฑููู (ุฌุฏูู ูุณูุท)
| ุงูุญูู | ุงููุตู |
|-------|-------|
| `conversation_id` / `user_id` | ุงููุญุงุฏุซุฉ ูุงููุณุชุฎุฏู |
| `is_muted` | ูุชู ุงูุฅุดุนุงุฑุงุช |
| `last_read_at` | ุขุฎุฑ ูุฑุงุกุฉ |

#### `messages` โ ุงูุฑุณุงุฆู
| ุงูุญูู | ุงููุตู |
|-------|-------|
| `conversation_id` | ุงููุญุงุฏุซุฉ |
| `user_id` | ุงููุฑุณู |
| `body` | ูุต ุงูุฑุณุงูุฉ |
| `type` | ููุน (text, image, file) |

---

### 3.2.11 ุฌุฏุงูู ุงูุชุญููุฒ

#### `badges` โ ุงูุดุงุฑุงุช
| ุงูุญูู | ุงููุตู |
|-------|-------|
| `name_ar` / `name_en` | ุงุณู ุงูุดุงุฑุฉ |
| `description_ar` / `description_en` | ุงููุตู |
| `icon` | ุฃููููุฉ |
| `color` | ุงูููู |
| `points` | ุงูููุงุท ุงูููููุญุฉ |
| `criteria_type` | ููุน ุงููุนูุงุฑ |
| `criteria_value` | ูููุฉ ุงููุนูุงุฑ |

#### `user_badges` โ ุดุงุฑุงุช ุงููุณุชุฎุฏููู
| ุงูุญูู | ุงููุตู |
|-------|-------|
| `user_id` | ุงูููุธู |
| `badge_id` | ุงูุดุงุฑุฉ |
| `awarded_at` | ุชุงุฑูุฎ ุงูููุญ |
| `awarded_by` | ูู ูุจู |
| `context` | ุงูุณูุงู |

**ุฏุงูุฉ ูููุฉ**: `UserBadge::award($userId, $badgeSlug, $context)` โ ุชููุญ ุงูุดุงุฑุฉ ูุชุทูู ุญุฏุซ `BadgeAwarded`

#### `points_transactions` โ ูุนุงููุงุช ุงูููุงุท
| ุงูุญูู | ุงููุตู |
|-------|-------|
| `user_id` | ุงูููุธู |
| `points` | ุงูููุงุท (+ ุฃู -) |
| `type` | ุงูููุน (earned, deducted, bonus, manual) |
| `source_type` / `source_id` | ุงููุตุฏุฑ (morphTo) |
| `description` | ุงููุตู |

---

### 3.2.12 ุฌุฏุงูู ุงููุฎุงุฎ ุงูููุณูุฉ

#### `traps` โ ุชุนุฑููุงุช ุงููุฎุงุฎ
| ุงูุญูู | ุงููุตู |
|-------|-------|
| `name_ar` / `name_en` | ุงุณู ุงููุฎ |
| `trap_code` | ุฑูุฒ ุงููุฎ ุงููุฑูุฏ |
| `trigger_type` | ููุน ุงูุชูุนูู |
| `risk_weight` | ูุฒู ุงูุฎุทุฑ (0.1 - 5.0) |
| `target_levels` | JSON โ ุงููุณุชููุงุช ุงููุณุชูุฏูุฉ |
| `fake_response` | JSON โ ุงูุงุณุชุฌุงุจุฉ ุงูููููุฉ |
| `is_active` | ูุดุทุ |

#### `trap_interactions` โ ุชูุงุนูุงุช ุงููุฎุงุฎ
| ุงูุญูู | ุงููุตู |
|-------|-------|
| `trap_id` | ุงููุฎ |
| `user_id` | ุงููุณุชุฎุฏู ุงููุชูุงุนู |
| `risk_score` | ุฏุฑุฌุฉ ุงูุฎุทุฑ (0-100%) |
| `action_taken` | ุงูุฅุฌุฑุงุก (logged, warned, escalated) |
| `context_data` | JSON โ ุจูุงูุงุช ุงูุณูุงู |
| `ip_address` | ุนููุงู IP |

---

### 3.2.13 ุฌุฏุงูู ุงูุชุญูููุงุช

#### `analytics_snapshots` โ ููุทุงุช ุชุญููููุฉ
| ุงูุญูู | ุงููุตู |
|-------|-------|
| `branch_id` | ุงููุฑุน |
| `snapshot_date` | ุงูุชุงุฑูุฎ |
| `period_type` | ุงูููุน (daily, weekly, monthly) |
| `metrics` | JSON โ ููุงููุณ ุดุงููุฉ |

#### `anomaly_logs` โ ุณุฌูุงุช ุงูุดุฐูุฐ
| ุงูุญูู | ุงููุตู |
|-------|-------|
| `user_id` | ุงูููุธู |
| `anomaly_type` | ููุน ุงูุดุฐูุฐ |
| `confidence` | ุฏุฑุฌุฉ ุงูุซูุฉ |
| `context_data` | JSON โ ุจูุงูุงุช ุงูุณูุงู |

#### `employee_patterns` โ ุฃููุงุท ุงูููุธููู
| ุงูุญูู | ุงููุตู |
|-------|-------|
| `user_id` | ุงูููุธู |
| `pattern_type` | ููุน ุงูููุท |
| `frequency_score` | ุชูุฑุงุฑ ุงูููุท |
| `financial_impact` | ุงูุฃุซุฑ ุงููุงูู |
| `risk_level` | ูุณุชูู ุงูุฎุทุฑ |

#### `loss_alerts` โ ุชูุจููุงุช ุงูุฎุณุงุฑุฉ
| ุงูุญูู | ุงููุตู |
|-------|-------|
| `branch_id` | ุงููุฑุน |
| `alert_type` | ุงูููุน |
| `severity` | ุงูุฎุทูุฑุฉ |
| `current_value` / `threshold_value` | ุงููููุฉ ุงูุญุงููุฉ ูุงูุนุชุจุฉ |

#### `work_rest_stats` โ ุฅุญุตุงุฆูุงุช ุงูุนูู ูุงูุฑุงุญุฉ
| ุงูุญูู | ุงููุตู |
|-------|-------|
| `user_id` | ุงูููุธู |
| `date` | ุงูุชุงุฑูุฎ |
| `work_minutes` / `rest_minutes` | ุฏูุงุฆู ุงูุนูู ูุงูุฑุงุญุฉ |
| `productivity_ratio` | ูุณุจุฉ ุงูุฅูุชุงุฌูุฉ |
| `rating` | ุงูุชูููู |

#### `sensor_readings` โ ูุฑุงุกุงุช ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ
| ุงูุญูู | ุงููุตู |
|-------|-------|
| `user_id` | ุงูููุธู |
| `accelerometer_data` | ุจูุงูุงุช ูููุงุณ ุงูุชุณุงุฑุน |
| `variance` | ุงูุชุจุงูู |
| `frequency` | ุงูุชุฑุฏุฏ |
| `decibel_level` | ูุณุชูู ุงูุตูุช |
| `work_probability` | ุงุญุชูุงููุฉ ุงูุนูู (0-1) |
| `motion_signature` | ุชูููุน ุงูุญุฑูุฉ |

---

### 3.2.14 ุฌุฏุงูู ุฃุฎุฑู

#### `financial_reports` โ ุงูุชูุงุฑูุฑ ุงููุงููุฉ
- ุชูุงุฑูุฑ ูุฌููุนุฉ ุนูู ูุณุชูู ุงูุดุฑูุฉ/ุงููุฑุน/ุงููุณู/ุงูููุธู
- ุฅุญุตุงุฆูุงุช ุงูุญุถูุฑ + ุงูุฃุซุฑ ุงููุงูู ููุชุฃุฎูุฑ

#### `attendance_exceptions` โ ุงุณุชุซูุงุกุงุช ุงูุญุถูุฑ
- ุฃููุงุน: ุณุงุนุงุช ูุฑูุฉุ ุนูู ุนู ุจุนุฏุ VIPุ ุทุจู
- ุชุชุฌุงูุฒ ููุงุนุฏ ุงูุณูุงุฌ ุงูุฌุบุฑุงูู ู/ุฃู ุงูุชุฃุฎูุฑ

#### `holidays` โ ุงูุนุทูุงุช
- ุฃููุงุน: ูุทููุฉุ ุฏูููุฉุ ุฎุงุตุฉ ุจุงูุดุฑูุฉ
- ูููู ุฑุจุทูุง ุจูุฑุน ูุญุฏุฏ ุฃู ุชููู ุนุงูุฉ

#### `circulars` โ ุงูุชุนุงููู + `circular_acknowledgments`
- ูุทุงู ุงูุงุณุชูุฏุงู: ุงููู / ูุฑุน / ูุณู / ุฏูุฑ
- ุชุชุจุน ูู ูุฑุฃ ุงูุชุนููู

#### `audit_logs` โ ุณุฌู ุงูุชุฏููู
- ูุณุฌู ุฌููุน ุงูุนูููุงุช ุงููููุฉ
- `auditable_type` / `auditable_id` โ ูุธุงู MorphTo

#### `employee_documents` โ ูุณุชูุฏุงุช ุงูููุธููู
- 9 ุฃููุงุน (ูููุฉ ูุทููุฉุ ุฌูุงุฒ ุณูุฑุ ุฑุฎุตุฉ ููุงุฏุฉุ ุดูุงุฏุฉ...)
- ุชุชุจุน ุชุงุฑูุฎ ุงูุฅุตุฏุงุฑ ูุงูุงูุชูุงุก

#### `employee_reminders` โ ุชุฐููุฑุงุช ุงูููุธููู
- ููุชุงุญ ุงูุชุฐููุฑ + ุงูุชุงุฑูุฎ + ุญุงูุฉ ุงูุฅููุงู
- ุชูุจููุงุช ุนุงุฌูุฉ ูููุซุงุฆู ุงูููุชููุฉ

#### `report_formulas` โ ูุนุงุฏูุงุช ุงูุชูุงุฑูุฑ
- ูุนุงุฏูุงุช ูุฎุตุตุฉ ุชูููููู ุจุฃูุงู ุนุจุฑ Symfony ExpressionLanguage
- ูุชุบูุฑุงุช: basic_salary, total_salary, delay_minutes, cost_per_minute...

#### `score_adjustments` โ ุชุนุฏููุงุช ุงูุชูููู
- ุชุนุฏููุงุช ูุฏููุฉ ุนูู ุงูููุงุท ูุงูููู ุงููุงููุฉ
- ูุทุงู: ูุฑุน / ููุธู / ูุณู

#### `settings` โ ุงูุฅุนุฏุงุฏุงุช
- ุตู ูุงุญุฏ (singleton) ูุน ุชุฎุฒูู ูุคูุช ุณุงุนุฉ ูุงุญุฏุฉ
- ูุดูู: ุงูุดุนุงุฑุ ุงูุฃููููุฉุ ุดุงุดุฉ ุงูุชุฑุญูุจุ ุจูุงูุงุช PWAุ ูุนุงููุงุช ููุทู ุงูุนูู

---

## 3.3 ูุฎุทุท ุงูุนูุงูุงุช ุงูุฑุฆูุณูุฉ

```
users โโโโโโโโโโฌโโ branches (branch_id)
               โโโ departments (department_id)
               โโโ roles (role_id)
               โโโ users (direct_manager_id) [self-reference]
               โ
               โโโโ attendance_logs (user_id)
               โโโโ leave_requests (user_id)
               โโโโ payrolls (user_id)
               โโโโ user_badges (user_id) โโโ badges
               โโโโ points_transactions (user_id)
               โโโโ user_permissions (user_id) โโโ permissions
               โโโโ user_shifts (user_id) โโโ shifts
               โโโโ employee_documents (user_id)
               โโโโ employee_reminders (user_id)
               โโโโ trap_interactions (user_id)
               โโโโ performance_alerts (user_id)
               โโโโ sensor_readings (user_id)
               โโโโ anomaly_logs (user_id)
               โโโโ employee_patterns (user_id)
               โโโโ work_rest_stats (user_id)

branches โโโโโโโฌโโโ departments (branch_id)
               โโโโ attendance_logs (branch_id)
               โโโโ holidays (branch_id) [nullable = ุนุงูุฉ]
               โโโโ analytics_snapshots (branch_id)
               โโโโ loss_alerts (branch_id)

departments โโโโฌโโ departments (parent_id) [self-reference]
               โโโ users (head_id)

roles โโโโโโโโโโฌโโโ role_permission โโโ permissions
               โโโ users (role_id)

circulars โโโโโโฌโโ users (created_by)
               โโโโ circular_acknowledgments
               โโโ branches (target_branch_id)
               โโโ departments (target_department_id)
```

---

> **ุงูุณุงุจู**: [ูููู ุงููุดุฑูุน](02-project-structure.md) | **ุงูุชุงูู**: [ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช](04-roles-permissions.md)



================================================================================
ุงูููู: 04-roles-permissions.md
================================================================================

# 4. ูุธุงู ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช

## 4.1 ูุธุฑุฉ ุนุงูุฉ

ูุนุชูุฏ ุณูุฑ ุนูู ูุธุงู ุฃูุงู **ูุฑูู ูู 10 ูุณุชููุงุช** ูุน ูุธุงู ุตูุงุญูุงุช ูุฑุฏู (Grant/Revoke). ูุฐุง ุงูุชุตููู ูุชูุญ:

1. **ุชุญูู ุฏููู**: ููุญ ุฃู ุณุญุจ ุตูุงุญูุงุช ูุฑุฏูุฉ ููู ููุธู
2. **ุชุฏุฑุฌ ุทุจูุนู**: ุงููุณุชููุงุช ุงูุฃุนูู ุชููู ุตูุงุญูุงุช ุถูููุฉ ุฃูุณุน
3. **ูุถุน ุงูุฅูู**: ุงููุณุชูู 10 ู `is_super_admin` ูุชุฌุงูุฒุงู ุฌููุน ุงููููุฏ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                   ูุฑู ุงููุณุชููุงุช ุงูุฃูููุฉ                      โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ุงููุณุชูู 10  โ  ุงูุฅูู (God Mode)                             โ
โ              โ  ุชุฌุงูุฒ ูู ุงูุจูุงุจุงุช + ุงูุฎุฒูุฉ ุงูุณุฑูุฉ + ุงููุฎุงุฎ  โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ุงููุณุชูู 8-9 โ  ุฅุฏุงุฑุฉ ุนููุง                                   โ
โ              โ  ูุฏูุฑ ุชูููุฐู / ูุฏูุฑ ุนูููุงุช                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ุงููุณุชูู 7   โ  ูุฏูุฑ ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ                          โ
โ              โ  ุฅุฏุงุฑุฉ ุงุณุชุซูุงุกุงุช ุงูุญุถูุฑ                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ุงููุณุชูู 5-6 โ  ูุดุฑููู ููุฏูุฑู ุฃูุณุงู                          โ
โ              โ  ูุตูู ูุฃุบูุจ ุงูุจูุงูุงุช                          โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ุงููุณุชูู 4   โ  ุงูุญุฏ ุงูุฃุฏูู ูุฏุฎูู ููุญุฉ ุงูุฅุฏุงุฑุฉ               โ
โ              โ  ุนุฑุถ ูุญุฏูุฏ                                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ุงููุณุชูู 1-3 โ  ููุธููู ุนุงุฏููู                                โ
โ              โ  ุจูุงุจุฉ ุงูููุธู ููุท (PWA)                       โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## 4.2 ุขููุฉ ุงูุชุญูู ูู ุงูุตูุงุญูุงุช

### 4.2.1 ุจูุงุจุฉ God Mode (`Gate::before`)

```php
// AppServiceProvider.php
Gate::before(function ($user, $ability) {
    if ($user->security_level === 10 || $user->is_super_admin) {
        return true;   // โ ุชุฌุงูุฒ ูู ุดูุก
    }
});
```

> โ๏ธ **ูุงู**: ูุง ูููู ูุฃู Policy ุฃู Gate ุฑูุถ ูุตูู ุงููุณุชูู 10. ูุฐุง ุจุชุตููู ูุชุนูุฏ.

### 4.2.2 ุชุฑุชูุจ ูุญุต ุงูุตูุงุญูุงุช ูู `User::hasPermission()`

```
1. is_super_admin === true  โ โ ุณูุงุญ ููุฑู
2. user_permissions (type=revoke, slug=X) ููุฌูุฏ ููุนูุงู  โ โ ุฑูุถ ููุฑู
3. user_permissions (type=grant, slug=X) ููุฌูุฏ ููุนูุงู   โ โ ุณูุงุญ
4. security_level >= implied_level(slug)                โ โ ุณูุงุญ ุถููู
5. โ โ ุฑูุถ ุงูุชุฑุงุถู
```

### 4.2.3 ุงูุตูุงุญูุงุช ุงูุถูููุฉ (Implied)

ุงููุณุชูู ุงูุฃููู ูููุญ ุตูุงุญูุงุช ุถูููุฉ ุฏูู ุงูุญุงุฌุฉ ูููุญ ุตุฑูุญ:

| ุงููุณุชูู | ุงูุตูุงุญูุงุช ุงูุถูููุฉ |
|---------|-------------------|
| 10 | ูู ุดูุก |
| 7+ | ุฅุฏุงุฑุฉ ุงุณุชุซูุงุกุงุช ุงูุญุถูุฑ |
| 5+ | ุนุฑุถ ุงูุชูุงุฑูุฑ ุงููุงููุฉุ ุนุฑุถ ุชูุงุฑูุฑ ุงูุฃุฏุงุก |
| 4+ | ุฏุฎูู ููุญุฉ ุงูุฅุฏุงุฑุฉ |

---

## 4.3 ุงูุจูุงุจุงุช ุงููุณูุงุฉ (Named Gates)

| ุงูุจูุงุจุฉ | ุงูุดุฑุท | ุงูุงุณุชุฎุฏุงู |
|---------|-------|-----------|
| `access-whistleblower-vault` | level โฅ 10 | ูุชุญ ุงูุฎุฒูุฉ ุงูุณุฑูุฉ |
| `bypass-geofence` | level โฅ 10 ุฃู super_admin | ุชุฌุงูุฒ ุงูุณูุงุฌ ุงูุฌุบุฑุงูู |
| `manage-competition` | level โฅ 10 ุฃู super_admin | ุฅุฏุงุฑุฉ ุงููุณุงุจูุงุช |
| `adjust-points` | level โฅ 10 ุฃู super_admin | ุชุนุฏูู ุงูููุงุท |
| `manage-roles` | level โฅ 10 ุฃู super_admin | ุฅุฏุงุฑุฉ ุงูุฃุฏูุงุฑ |
| `manage-permissions` | level โฅ 10 ุฃู super_admin | ุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช |
| `manage-attendance-exceptions` | level โฅ 7 ุฃู super_admin | ุฅุฏุงุฑุฉ ุงุณุชุซูุงุกุงุช ุงูุญุถูุฑ |
| `manage-score-adjustments` | level โฅ 10 ุฃู super_admin | ุชุนุฏููุงุช ุงูุชูููู |
| `manage-report-formulas` | level โฅ 10 ุฃู super_admin | ุฅุฏุงุฑุฉ ูุนุงุฏูุงุช ุงูุชูุงุฑูุฑ |
| `access-stealth-resources` | level โฅ 10 ุฃู super_admin | ุงูููุงุฑุฏ ุงููุฎููุฉ |
| `access-trap-audit` | level โฅ 10 ุฃู super_admin | ุณุฌู ุชุฏููู ุงููุฎุงุฎ |

---

## 4.4 ุงูุณูุงุณุงุช (Policies)

ุชู ุชุณุฌูู **11 ุณูุงุณุฉ** ูู `AppServiceProvider`:

| ุงููููุฐุฌ | ุงูุณูุงุณุฉ | ุงูููุงุนุฏ ุงูุฑุฆูุณูุฉ |
|---------|---------|------------------|
| `User` | `UserPolicy` | ุนุฑุถ: level โฅ 4ุ ุฅูุดุงุก/ุชุนุฏูู: level โฅ 7ุ ุญุฐู: level โฅ 10ุ ููุน ุญุฐู ุงูููุณ |
| `AttendanceLog` | `AttendanceLogPolicy` | ุนุฑุถ: level โฅ 4 ุฃู ูุงูู ุงูุณุฌูุ ุชุนุฏูู: level โฅ 7ุ ุญุฐู: level โฅ 10 |
| `Payroll` | `PayrollPolicy` | ุนุฑุถ: level โฅ 5 ุฃู ูุงูู ุงููุดูุ ุฅูุดุงุก/ุชุนุฏูู: level โฅ 7ุ ุงุนุชูุงุฏ: level โฅ 8 |
| `LeaveRequest` | `LeaveRequestPolicy` | ุนุฑุถ: level โฅ 4 ุฃู ููุฏู ุงูุทูุจุ ุฅูุดุงุก: ุฃู ููุธูุ ุงุนุชูุงุฏ/ุฑูุถ: level โฅ 5 |
| `EmployeeDocument` | `EmployeeDocumentPolicy` | ุนุฑุถ: level โฅ 5 ุฃู ูุงูู ุงููุณุชูุฏุ ุฅูุดุงุก/ุชุนุฏูู: level โฅ 5 |
| `PerformanceAlert` | `PerformanceAlertPolicy` | ุนุฑุถ: level โฅ 5ุ ุฅูุดุงุก/ุชุนุฏูู: level โฅ 7 |
| `Circular` | `CircularPolicy` | ุนุฑุถ: ุฃู ูุณุฌูุ ุฅูุดุงุก: level โฅ 5ุ ุชุนุฏูู: level โฅ 5 ุฃู ุงูููุดุฆ |
| `Holiday` | `HolidayPolicy` | ุนุฑุถ: ุฃู ูุณุฌูุ ุฅูุดุงุก/ุชุนุฏูู/ุญุฐู: level โฅ 5 |
| `Branch` | `BranchPolicy` | ุนุฑุถ: level โฅ 4ุ ุฅูุดุงุก/ุชุนุฏูู: level โฅ 7ุ ุญุฐู: level โฅ 10 |
| `Department` | `DepartmentPolicy` | ุนุฑุถ: level โฅ 4ุ ุฅูุดุงุก/ุชุนุฏูู: level โฅ 6ุ ุญุฐู: level โฅ 9 |
| `Shift` | `ShiftPolicy` | ุนุฑุถ: level โฅ 4ุ ุฅูุดุงุก/ุชุนุฏูู: level โฅ 6ุ ุญุฐู: level โฅ 8 |

### ุจููุฉ ุงูุณูุงุณุฉ ุงููููุฐุฌูุฉ

```php
class ExamplePolicy
{
    // ุนุฑุถ ุฃู ุณุฌู
    public function viewAny(User $user): bool
    {
        return $user->security_level >= 4;
    }

    // ุนุฑุถ ุณุฌู ูุญุฏุฏ
    public function view(User $user, Model $record): bool
    {
        return $user->security_level >= 4
            || $user->id === $record->user_id;   // ุงููุงูู ูุฑู ุจูุงูุงุชู
    }

    // ุฅูุดุงุก ุณุฌู ุฌุฏูุฏ
    public function create(User $user): bool
    {
        return $user->security_level >= 7;
    }

    // ูุง ูุญุฐู โ ูุคุฑุดู (SoftDelete)
    public function delete(User $user, Model $record): bool
    {
        return $user->security_level >= 10;
    }
}
```

---

## 4.5 ุงูุชุญูู ูู ูุงุฌูุฉ Filament

### 4.5.1 `canAccessPanel()`

```php
// User Model
public function canAccessPanel(Panel $panel): bool
{
    return match ($panel->getId()) {
        'admin' => $this->security_level >= 4,
        'app'   => true,   // ุจูุงุจุฉ ุงูููุธู ูุชุงุญุฉ ููุฌููุน
        default => false,
    };
}
```

### 4.5.2 `canAccess()` ูู ุงูููุงุฑุฏ ูุงูุตูุญุงุช

ูู ููุฑุฏ ูุตูุญุฉ ูู Filament ุชูุญุฏุฏ ุญุฏ ุงููุตูู ุงูุฃุฏูู:

```php
// ูุซุงู: FinancialReportsPage
public static function canAccess(): bool
{
    return auth()->user()?->security_level >= 7;
}
```

| ุงููููู | ุงูุญุฏ ุงูุฃุฏูู |
|--------|-------------|
| ููุงุฑุฏ ุนุงูุฉ (Users, Attendance, etc.) | 4 |
| ุตูุญุงุช ูุงููุฉ | 7 |
| ุตูุญุงุช ุงูุชุญูููุงุช ุงููุชูุฏูุฉ | 8 |
| ุตูุญุฉ ุจูุงูุงุช ุงููุดุฑ | 10 |
| ุตูุญุฉ ุงูุฎุฒูุฉ ุงูุณุฑูุฉ | 10 |
| ุฃุฏูุงุช ุงููุฎุงุฎ | 10 |

---

## 4.6 ูุธุงู ุงูุตูุงุญูุงุช ุงููุฑุฏูุฉ

### ุฌุฏูู `user_permissions`

```sql
-- ููุญ ุตูุงุญูุฉ
INSERT INTO user_permissions (user_id, permission_id, type) VALUES (5, 3, 'grant');

-- ุณุญุจ ุตูุงุญูุฉ (ุฃููู ูู ุงูููุญ)
INSERT INTO user_permissions (user_id, permission_id, type) VALUES (5, 7, 'revoke');

-- ุตูุงุญูุฉ ูุคูุชุฉ (ุชูุชูู ุชููุงุฆููุง)
INSERT INTO user_permissions (user_id, permission_id, type, expires_at) 
VALUES (5, 3, 'grant', '2026-03-01 00:00:00');
```

### ุฃููููุฉ ุงูุญุณู

```
ุงูุฃููู โโโโโโโโโโโโโโโโโโโโโโโโโโโโ ุงูุฃุถุนู
revoke ูุฑุฏู > grant ูุฑุฏู > ุตูุงุญูุฉ ุถูููุฉ > ุฑูุถ
```

### ูุฌููุนุงุช ุงูุตูุงุญูุงุช

| ุงููุฌููุนุฉ | ุฃูุซูุฉ |
|----------|-------|
| `attendance` | `manage-attendance`, `view-attendance-reports` |
| `payroll` | `view-payroll`, `generate-payroll`, `approve-payroll` |
| `users` | `manage-users`, `view-users`, `delete-users` |
| `leaves` | `manage-leave-requests`, `approve-leaves` |
| `reports` | `view-financial-reports`, `export-reports` |
| `settings` | `manage-settings`, `manage-branches` |

---

## 4.7 ุณููุงุฑูููุงุช ุดุงุฆุนุฉ

### ุณููุงุฑูู 1: ููุธู ุนุงุฏู (ูุณุชูู 2)
- โ ุจูุงุจุฉ ุงูููุธู PWA
- โ ุชุณุฌูู ุญุถูุฑ/ุงูุตุฑุงู
- โ ุนุฑุถ ุจูุงูุงุชู ุงูุดุฎุตูุฉ ููุท
- โ ููุญุฉ ุงูุฅุฏุงุฑุฉ

### ุณููุงุฑูู 2: ูุดุฑู (ูุณุชูู 5) ูุน ุณุญุจ ุตูุงุญูุฉ
- โ ููุญุฉ ุงูุฅุฏุงุฑุฉ
- โ ูุนุธู ุงูุตูุงุญูุงุช ุงูุถูููุฉ ูููุณุชูู 5
- โ ุนุฑุถ ูุดูู ุงูุฑูุงุชุจ (ูุญุฌูุจ ุจู `revoke` ูุฑุฏู)

### ุณููุงุฑูู 3: ููุธู (ูุณุชูู 2) ูุน ููุญ ุตูุงุญูุฉ ูุคูุชุฉ
- โ ุจูุงุจุฉ ุงูููุธู
- โ ุนุฑุถ ุชูุงุฑูุฑ ุงูุฃุฏุงุก (ููููุญ ูุคูุชูุง ุญุชู ุชุงุฑูุฎ ูุญุฏุฏ)
- ุจุนุฏ ุงูุชูุงุก ุงูุตูุงุญูุฉ ูุนูุฏ ูููุถุน ุงูุงูุชุฑุงุถู

### ุณููุงุฑูู 4: ูุฏูุฑ ุนุงู (ูุณุชูู 10)
- โ **ูู ุดูุก** ุจุฏูู ุงุณุชุซูุงุก
- โ ุงูุฎุฒูุฉ ุงูุณุฑูุฉ + ุณุฌูุงุช ุงููุฎุงุฎ
- โ ุชุฌุงูุฒ ุงูุณูุงุฌ ุงูุฌุบุฑุงูู
- โ ูุง ูููู ูุฃู `revoke` ุฃู ูุคุซุฑ ุนููู (Gate::before ูุชุฌุงูุฒ)

---

> **ุงูุณุงุจู**: [ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูููุงุฐุฌ](03-database-models.md) | **ุงูุชุงูู**: [ููููุงุช Filament](05-filament-components.md)



================================================================================
ุงูููู: 05-filament-components.md
================================================================================

# 5. ููููุงุช Filament

## 5.1 ูุธุฑุฉ ุนุงูุฉ

ูุณุชุฎุฏู ุณูุฑ **Filament v3** ูุน ููุญุชูู (Panel) ูููุตูุชูู:

| ุงูููุญุฉ | ุงููุณุงุฑ | ุงูุฌูููุฑ | ุงูุญุฏ ุงูุฃุฏูู |
|--------|--------|---------|-------------|
| **Admin** | `/admin` | ุงููุดุฑููู ูุงูุฅุฏุงุฑุฉ | security_level โฅ 4 |
| **App** | `/app` | ุฌููุน ุงูููุธููู | ุฃู ูุณุฌูู |

```
Admin Panel (/admin)
โโโ 21 Resource (CRUD ูุงูู)
โโโ 13 Page (ุตูุญุงุช ูุฎุตุตุฉ)
โโโ 11 Widget (ุฃุฏูุงุช ููุญุฉ ุงููุนูููุงุช)

Employee Portal (/app)
โโโ 2 Resource (ุญุถูุฑ + ุฅุฌุงุฒุงุช โ ูุฑุงุกุฉ ููุท)
โโโ 1 Page (ููุญุฉ ุงูููุธู)
โโโ 2 Widget (ุชุฑุญูุจ + ูุฑุขุฉ ุงูุฃุฏุงุก)
```

---

## 5.2 ููุงุฑุฏ ููุญุฉ ุงูุฅุฏุงุฑุฉ (Admin Resources)

### 5.2.1 ุงููููู ุงูุชูุธููู

#### BranchResource โ ุงููุฑูุน
- **ุงููููุฐุฌ**: `Branch`
- **ุงููุฌููุนุฉ**: ุงููููู ุงูุชูุธููู
- **ุงููุตูู**: ุฌููุน ูุณุชุฎุฏูู ุงูููุญุฉ
- **ุงูุญููู**: ุงุณู ุนุฑุจู/ุฅูุฌููุฒูุ ุฑูุฒุ ุฎุฑูุทุฉ ุชูุงุนููุฉ (Leaflet) ูุชุญุฏูุฏ ุงูุฅุญุฏุงุซูุงุชุ ูุตู ูุทุฑ ุงูุณูุงุฌุ ุฃููุงุช ุงูุฏูุงูุ ูุชุฑุฉ ุงูุณูุงุญุ ุงูููุฒุงููุฉ
- **ุงูุฃุนูุฏุฉ**: ุงูุฑูุฒุ ุงูุงุณูุ ุงููุฏููุฉุ ูุตู ูุทุฑ ุงูุณูุงุฌุ ุฃููุงุช ุงูุฏูุงู
- **ุฎุงุต**: ุญููู ุญุณุงุจูุฉ ููููุฒุงููุฉ ูุนุฏุฏ ุงูููุธููู ูVPM

#### DepartmentResource โ ุงูุฃูุณุงู
- **ุงููููุฐุฌ**: `Department`
- **ุงููุฌููุนุฉ**: ุงููููู ุงูุชูุธููู
- **ุงูุญููู**: ุงุณูุ ุฑูุฒุ ูุฑุนุ ูุณู ุฃุจ (ูุฑูู)ุ ุฑุฆูุณ ุงููุณู
- **ุงูุฃุนูุฏุฉ**: ุงูุงุณูุ ุงูุฑูุฒ (ุดุงุฑุฉ)ุ ุงููุฑุนุ ุงููุณู ุงูุฃุจุ ุงูุฑุฆูุณุ ุนุฏุฏ ุงูููุธููู

#### ShiftResource โ ุงููุฑุฏูุงุช
- **ุงููููุฐุฌ**: `Shift`
- **ุงููุฌููุนุฉ**: ุฅุฏุงุฑุฉ ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ
- **ุงูุญููู**: ุงุณูุ ููุช ุงูุจุฏุงูุฉ/ุงูููุงูุฉุ ูุชุฑุฉ ุงูุณูุงุญุ ูุฑุฏูุฉ ููููุฉ
- **ุงูุฃุนูุฏุฉ**: ุงูุงุณูุ ุงูุฃููุงุชุ ูุชุฑุฉ ุงูุณูุงุญุ ุฃููููุฉ ููููุ ุนุฏุฏ ุงููุนููููู

---

### 5.2.2 ุงูููุธููู

#### UserResource โ ุงูููุธููู
- **ุงููููุฐุฌ**: `User`
- **ุงููุฌููุนุฉ**: ุงูููุธููู
- **ูุทุงู ุงูุจูุงูุงุช**: ูุฑู ููุธูู ูุฑุนู ููุท (ุงููุณุชูู 10 ูุฑู ุงููู)
- **ุงูุญููู**: ุตูุฑุฉ ุดุฎุตูุฉ (ูุทููุจุฉ)ุ ุฃุณูุงุกุ ุจุฑูุฏุ ูููุฉ ูุฑูุฑุ ุฑุงุชุจ (ุฃุณุงุณู + ุจุฏูุงุช)ุ ูุฑุน/ูุณู/ุฏูุฑ/ูุฏูุฑ ูุจุงุดุฑุ ูุงุชูุ ุฑูู ูุธูููุ ุญุงูุฉุ ููุน ุชูุธูู
- **ุงูุฃุนูุฏุฉ**: ุชุฎุทูุท Stack/Split ููููุจุงูู โ ุตูุฑุฉ ุฏุงุฆุฑูุฉุ ุงุณู ุนุฑุจู (ุนุฑูุถ)ุ ุฑูู ูุธููู (ุดุงุฑุฉ)ุ ูุฑุนุ ุฏูุฑ. ููุญุฉ ูุงุจูุฉ ููุทู: ุฑุงุชุจ (ูุณุชูู 6+)ุ ููุงุทุ ูุณุชูู ุฃููู (ูุณุชูู 7+)ุ ุญุงูุฉ
- **ุฅุฌุฑุงุกุงุช ุฎุงุตุฉ**:
  - `adjust_points` โ ุชุนุฏูู ููุงุท (ุจูุงุจุฉ `adjust-points`)
  - ุฅุฌุฑุงุกุงุช ุฌูุงุนูุฉ: ุชุนุฏูู ุงูุฑุงุชุจ (ูุจูุบ/ุฅุถุงูุฉ/ูุณุจุฉ)ุ ููู ููุฑุนุ ุชุบููุฑ ุญุงูุฉ
- **ูุฏูุฑ ุงูุนูุงูุงุช**: `PermissionsRelationManager` โ ุฅุฏุงุฑุฉ ุงูุตูุงุญูุงุช ุงููุฑุฏูุฉ

#### EmployeeDocumentResource โ ูุซุงุฆู ุงูููุธููู
- **ุงููููุฐุฌ**: `EmployeeDocument`
- **ุงููุฌููุนุฉ**: ุงูููุธููู
- **ูุทุงู ุงูุจูุงูุงุช**: ูุณุชูู 10 ูุฑู ุงูููุ ูุณุชูู 6+ ูุฑู ูุฑุนูุ ุงูุจุงูู ูุฑู ูุซุงุฆูู
- **ุงูุญููู**: ููุธูุ ููุน ุงููุซููุฉ (9 ุฃููุงุน)ุ ุฑููุ ููู PDF/ุตูุฑุฉุ ุชูุงุฑูุฎ ุฅุตุฏุงุฑ/ุงูุชูุงุก
- **ุงูุฃุนูุฏุฉ**: ุงุณู ุงูููุธูุ ุงูููุน (ุดุงุฑุฉ)ุ ุงูุฑููุ ุชูุงุฑูุฎุ ุฃูุงู ุญุชู ุงูุงูุชูุงุก (ุดุงุฑุฉ ููููุฉ)

#### EmployeeReminderResource โ ุชูุจููุงุช ุงูููุธููู
- **ุงููููุฐุฌ**: `EmployeeReminder`
- **ุงููุฌููุนุฉ**: ุงูููุธููู
- **ุงูุฃุนูุฏุฉ**: ุงูููุธูุ ููุชุงุญ ุงูุชุฐููุฑุ ุงูุชุงุฑูุฎ (ููููู)ุ ุงูุญุงูุฉ (ุดุงุฑุฉ ูุงุจุถุฉ ุฅุฐุง ุนุงุฌู)ุ ููุชูู
- **ุดุงุฑุฉ ุงูุชููู**: ุนุฏุฏ ุงูุชูุจููุงุช ุงูุนุงุฌูุฉ

#### PerformanceAlertResource โ ุชูุจููุงุช ุงูุฃุฏุงุก
- **ุงููููุฐุฌ**: `PerformanceAlert`
- **ุงููุตูู**: security_level โฅ 5
- **ุงููุฌููุนุฉ**: ุงูููุธููู
- **ุงูุฃููุงุน**: ุดุงุฑุฉ ููุชุณุจุฉุ ุชุนูููุ ุชุญุฐูุฑ ุชุฃุฎุฑุ ุชุญุฐูุฑ ุบูุงุจุ ูุฑุงุฌุนุฉ ุฃุฏุงุก
- **ุฅุฌุฑุงุกุงุช**: ุชุนููู ูููุฑูุก (ูุฑุฏู ูุฌูุงุนู)

---

### 5.2.3 ุงูุญุถูุฑ ูุงูุงูุตุฑุงู

#### AttendanceLogResource โ ุณุฌูุงุช ุงูุญุถูุฑ
- **ุงููููุฐุฌ**: `AttendanceLog`
- **ุงููุฌููุนุฉ**: ุงูุญุถูุฑ ูุงูุงูุตุฑุงู
- **ูุทุงู ุงูุจูุงูุงุช**: ูุฑุน ุงููุณุชุฎุฏู ููุท (ุงููุณุชูู 10 ูุฑู ุงููู)
- **ุงูุญููู**: ููุธูุ ูุฑุนุ ุชุงุฑูุฎุ ููุช ุญุถูุฑ/ุงูุตุฑุงูุ ุญุงูุฉ (7 ุฃููุงุน)ุ ุชุฃุฎูุฑุ ุชูููุฉ ุงูุฏูููุฉุ ูุณุงูุฉุ ุณูุงุฌ ุฌุบุฑุงููุ ุฅุฏุฎุงู ูุฏููุ ููุงุญุธุงุช
- **ุงูุฃุนูุฏุฉ**: ุชุฎุทูุท Stack/Split โ ุชุงุฑูุฎุ ุงุณูุ ุญุงูุฉ (ุดุงุฑุฉ)ุ ูุฑุนุ ุฃููุงุชุ ุชุฃุฎูุฑุ ุชูููุฉ ุงูุชุฃุฎูุฑ (ุฑ.ุณ ูุน ูุฌููุน)ุ ูููุฉ ุงูุฅุถุงูู (ุฑ.ุณ ูุน ูุฌููุน)ุ ุชูููุฉ ุงูุฏูููุฉ

#### AttendanceExceptionResource โ ุงุณุชุซูุงุกุงุช ุงูุญุถูุฑ
- **ุงููููุฐุฌ**: `AttendanceException`
- **ุงููุตูู**: ุงููุณุชูู 10 ููุท
- **ุงููุฌููุนุฉ**: ุงูุญุถูุฑ ูุงูุงูุตุฑุงู
- **ุงูุฃููุงุน**: ุณุงุนุงุช ูุฑูุฉุ ุนูู ุนู ุจุนุฏุ VIPุ ุทุจูุ ูุฎุตุต
- **ููุงุชูุญ**: ุชุฌุงูุฒ ุงูุณูุงุฌุ ุชุฌุงูุฒ ุนูู ุงูุชุฃุฎูุฑุ ูุฑุฏูุฉ ูุฎุตุตุฉ

#### LeaveRequestResource โ ุทูุจุงุช ุงูุฅุฌุงุฒุฉ
- **ุงููููุฐุฌ**: `LeaveRequest`
- **ุงููุฌููุนุฉ**: ุงูุญุถูุฑ ูุงูุงูุตุฑุงู
- **ูุทุงู ุงูุจูุงูุงุช**: ูุฑุน ุงููุณุชุฎุฏู ููุท
- **ุฃููุงุน ุงูุฅุฌุงุฒุฉ**: ุณูููุฉุ ูุฑุถูุฉุ ุทุงุฑุฆุฉุ ุจุฏูู ุฑุงุชุจุ ุฃูููุฉุ ุฃุจูุฉุ ุญุฌุ ููุงุฉุ ุฒูุงุฌ
- **ุฅุฌุฑุงุกุงุช ูุจุงุดุฑุฉ**: ูุจูู/ุฑูุถ ูุน ุชุฃููุฏ
- **ุดุงุฑุฉ ุงูุชููู**: ุนุฏุฏ ุงูุทูุจุงุช ุงููุนููุฉ

#### HolidayResource โ ุงูุนุทูุงุช
- **ุงููููุฐุฌ**: `Holiday`
- **ุงููุฌููุนุฉ**: ุงูุญุถูุฑ ูุงูุงูุตุฑุงู
- **ุงูุฃููุงุน**: ูุทููุฉุ ุฏูููุฉุ ุฎุงุตุฉ ุจุงูุดุฑูุฉ
- **ุฎุงุต**: ุงูุนุทูุฉ ุจุฏูู ูุฑุน = ุชูุทุจู ุนูู ุฌููุน ุงููุฑูุน

---

### 5.2.4 ุงููุงููุฉ

#### PayrollResource โ ูุดูู ุงูุฑูุงุชุจ
- **ุงููููุฐุฌ**: `Payroll`
- **ุงููุตูู**: security_level โฅ 7
- **ุงููุฌููุนุฉ**: ุงููุงููุฉ
- **ุงูุญููู**: ููุธูุ ูุชุฑุฉุ ุญุงูุฉ (ูุณูุฏุฉ/ูุนุชูุฏ/ูุฏููุน)ุ ุฑุงุชุจ ุฃุณุงุณู + ุจุฏูุงุชุ ุฎุตููุงุช (ุชุฃุฎูุฑ/ุบูุงุจ/ูุบุงุฏุฑุฉ ูุจูุฑุฉ)ุ ุฅุถุงูุงุช (ุฅุถุงูู/ููุงูุขุช)ุ ุตุงูู ุงูุฑุงุชุจ (ูุญุณูุจ)
- **ุฅุฌุฑุงุกุงุช**: ุงุนุชูุงุฏ (ูุณูุฏุฉ โ ูุนุชูุฏ)

---

### 5.2.5 ุงูุฃูุงู ูุงูุตูุงุญูุงุช

#### RoleResource โ ุงูุฃุฏูุงุฑ
- **ุงููููุฐุฌ**: `Role`
- **ุงููุตูู**: ุงููุณุชูู 10
- **ุชูุจูู**: ุงูุฃุฏูุงุฑ ูุฎุฑูุฉ ููุท โ ูุง ุชููุญ ุตูุงุญูุงุช ูุนููุฉ

#### PermissionResource โ ุงูุตูุงุญูุงุช
- **ุงููููุฐุฌ**: `Permission`
- **ุงููุตูู**: ุงููุณุชูู 10
- **ุงููุฌููุนุงุช**: attendance, finance, users, branches, reports, security, competition, messaging, system

#### TrapResource โ ุงููุฎุงุฎ ุงูููุณูุฉ
- **ุงููููุฐุฌ**: `Trap`
- **ุงููุตูู**: ุงููุณุชูู 10 (God Mode)
- **ุงูุญููู**: ุฑูุฒ ุงููุฎุ ุงุณูุ ููุน ุงูุชูุนูู (click/page_visit/form_submit/data_export)ุ ูุฒู ุงูุฎุทุฑุ ุงูููุงูุนุ ูุณุชููุงุช ูุณุชูุฏูุฉุ ุงุณุชุฌุงุจุฉ ููููุฉ (KeyValue)

#### TrapInteractionResource โ ุชูุงุนูุงุช ุงููุฎุงุฎ
- **ุงููููุฐุฌ**: `TrapInteraction`
- **ุงููุตูู**: ุงููุณุชูู 10
- **ุฎุงุต**: ูุฑุงุกุฉ ููุท โ ูุง ูููู ุงูุฅูุดุงุก

---

### 5.2.6 ุงูุชุญูููุงุช

#### EmployeePatternResource โ ุฃููุงุท ุงูููุธููู
- **ุงููููุฐุฌ**: `EmployeePattern`
- **ุงููุตูู**: ุงููุณุชูู 10
- **ุงูุฃุนูุฏุฉ**: ุงูููุธูุ ุงููุฑุนุ ููุน ุงูููุทุ ุชูุฑุงุฑ ุงูููุท (ููููู)ุ ุงูุฃุซุฑ ุงููุงูู (ุฑ.ุณ)ุ ูุณุชูู ุงูุฎุทุฑ

#### LossAlertResource โ ุชูุจููุงุช ุงูุฎุณุงุฑุฉ
- **ุงููููุฐุฌ**: `LossAlert`
- **ุงููุตูู**: ุงููุณุชูู 10
- **ุงูุฃููุงุน**: ุชุฌุงูุฒ ุนุชุจุฉุ ุญุถูุฑ ููุฎูุถุ ุชุฃุฎุฑ ุฌูุงุนูุ ููุท ููุชุดูุ ุดุฐูุฐ
- **ุฅุฌุฑุงุก**: ุฅูุฑุงุฑ ุงูุชูุจูู

#### ReportFormulaResource โ ูุนุงุฏูุงุช ุงูุชูุงุฑูุฑ
- **ุงููููุฐุฌ**: `ReportFormula`
- **ุงููุตูู**: ุงููุณุชูู 10
- **ุฎุงุต**: ุญูู ุงููุนุงุฏูุฉ ุงูุฑูุงุถูุฉ + ุงุฎุชูุงุฑ ุงููุชุบูุฑุงุช + ุฅุฌุฑุงุก ุงุฎุชุจุงุฑ ุงููุนุงุฏูุฉ ุนูู ููุธู

#### ScoreAdjustmentResource โ ุชุนุฏููุงุช ุงูุชูููู
- **ุงููููุฐุฌ**: `ScoreAdjustment`
- **ุงููุตูู**: ุงููุณุชูู 10
- **ุงููุทุงูุงุช**: ูุฑุน / ููุธู / ูุณู
- **ุงููุฆุงุช**: ูุฏููุ ููุงูุฃุฉุ ุนููุจุฉุ ุชุตุญูุญ

---

## 5.3 ุตูุญุงุช ููุญุฉ ุงูุฅุฏุงุฑุฉ (Admin Pages)

### 5.3.1 Dashboard โ ููุญุฉ ุงููุนูููุงุช ุงูุฑุฆูุณูุฉ
- **ุงููุตูู**: ุฌููุน ูุณุชุฎุฏูู ุงูููุญุฉ
- **ุงููุฑุดุญุงุช**: ุงูููู / ุงูุฃุณุจูุน / ุงูุดูุฑ / ุงูุณูุฉ / ูุฎุตุต
- **ุงูุฃุฏูุงุช ุงููุนุฑูุถุฉ**: ุฌููุน ุงูู 11 Widget ุงููุณุฌูุฉ

### 5.3.2 AnalyticsDashboard โ ููุญุฉ ุงูุชุญูููุงุช ุงููุชูุฏูุฉ
- **ุงููุตูู**: ุงููุณุชูู 10
- **ุงููุฌููุนุฉ**: ุงูุชุญูููุงุช
- **ุงููุธุงุฆู**: ุณุงุนุฉ ุงููุฑุตุฉ ุงูุถุงุฆุนุฉุ ุชูุจููุงุช ุงูุฎุณุงุฑุฉ ุงูุฃุฎูุฑุฉุ ุฃููุงุท ุงูููุธููู ุนุงููุฉ ุงูุฎุทุฑ
- **ุฅุฌุฑุงุก**: "ุชุดุบูู ุงูุชุญูููุงุช ุงูุขู" โ ูููููุฐ ุชุญูููุงู ุดุงููุงู ููุฑููุง

### 5.3.3 FinancialReportsPage โ ุงูุชูุงุฑูุฑ ุงููุงููุฉ
- **ุงููุตูู**: ุงููุณุชูู 7
- **ุงููุฌููุนุฉ**: ุบุฑูุฉ ุงูููุงุฏุฉ
- **ุงููุทุงูุงุช**: ุดุฑูุฉ / ูุฑุน / ูุณู / ููุธู ูุน ูุทุงู ุชุงุฑูุฎ
- **ุงูุชูุงุฑูุฑ**: ุชุญููู ุฃุซุฑ ุงูุชุฃุฎูุฑ + ุชููุน ุงูุฎุณุงุฑุฉ ุงูุดูุฑูุฉ

### 5.3.4 BroadcastPage โ ุงูุฅุฐุงุนุฉ
- **ุงููุตูู**: ุงููุณุชูู 7
- **ุงููุฌููุนุฉ**: ุงูุชูุงุตู
- **ุงููุธููุฉ**: ุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุฌูุงุนูุฉ (ุงููู / ูุฑุน / ูุณู)

### 5.3.5 BranchLeaderboardPage โ ููุญุฉ ุงูููุงูุณุฉ
- **ุงููุตูู**: ุฌููุน ูุณุชุฎุฏูู ุงูููุญุฉ
- **ุงููุฌููุนุฉ**: ุงูููุงูุณุฉ
- **ุงููุธููุฉ**: ุชุฑุชูุจ ุงููุฑูุน ุจุฃูู ุฎุณุงุฑุฉ ูุงููุฉ ุฅุฌูุงููุฉ
- **ุงููุณุชููุงุช**: ุฃุณุทูุฑู / ุฃููุงุณู / ุฐูุจู / ูุถู / ุจุฑููุฒู / ูุจุชุฏุฆ
- **ุฃููููุงุช**: ๐ ููุฃููุ ๐ข ููุฃุฎูุฑ

### 5.3.6 WhistleblowerVaultPage โ ุงูุฎุฒูุฉ ุงูุณุฑูุฉ
- **ุงููุตูู**: ุงููุณุชูู 10
- **ุงููุฌููุนุฉ**: ุบุฑูุฉ ุงูููุงุฏุฉ
- **ุงููุธููุฉ**: ุนุฑุถ ุงูุจูุงุบุงุช ุงูุณุฑูุฉ ุงููุดููุฑุฉ
- **ุงูุฃูุงู**: ูุณุฌู ูู ุนูููุฉ ูุชุญ ูู AuditLog

### 5.3.7 TrapAuditPage โ ุณุฌู ุชุฏููู ุงููุฎุงุฎ
- **ุงููุตูู**: ุงููุณุชูู 10
- **ุงููุฌููุนุฉ**: ุงูุฃูุงู
- **ุงููุธููุฉ**: ุฅุญุตุงุฆูุงุช ุงููุฎุงุฎุ ุงููุณุชุฎุฏููู ุนุงููู ุงูุฎุทุฑุ ุขุฎุฑ 20 ุชูุงุนู

### 5.3.8 GeneralSettingsPage โ ุฅุนุฏุงุฏุงุช ุงููุธุงู
- **ุงููุตูู**: ุงููุณุชูู 10
- **ุงูุฅุนุฏุงุฏุงุช**: ุงุณู ุงูุชุทุจููุ ุงูุดุนุงุฑุ ุงูุฃููููุฉุ ุดุงุดุฉ ุงูุชุฑุญูุจุ ุฅุนุฏุงุฏุงุช PWAุ ููุทู ุงูุนูู (ูุถุงุนู ุงูุฎุณุงุฑุฉุ ูุตู ูุทุฑ ุงูุณูุงุฌุ ูุชุฑุฉ ุงูุณูุงุญุ ูุถุงุนู ุงูุฅุถุงูู)

### 5.3.9 DemoDataGenerator โ ููููุฏ ุงูุจูุงูุงุช ุงูุชุฌุฑูุจูุฉ
- **ุงููุตูู**: ุงููุณุชูู 10
- **ุงูุฅุฌุฑุงุกุงุช**: ูุนุงููุฉุ ุชุฃููุฏ (ุฅุฏุฑุงุฌ ุฌูุงุนู)ุ ูุณุญ (ุญุฐู ูุทุงู ุชุงุฑูุฎ)
- **ุงูุชุญูู**: ูุทุงู ุงูุชูุงุฑูุฎุ ุงููุฑุนุ ุฅุนุฏุงุฏุงุช ุงููุฑุฏูุฉุ ุฃูุงู ุงูุนุทูุฉุ ูููุงุณ ุงูุงูุชุฒุงู (1-10)

### 5.3.10 DeploymentDataPage โ ุจูุงูุงุช ุงููุดุฑ
- **ุงููุตูู**: ุงููุณุชูู 10
- **ุงูุฅุฌุฑุงุกุงุช**: ูุณุญ ุฌููุน ุงูุณุฌูุงุชุ ุชุนููู ุงูุดุนุงุฑ ูุตูุฑุฉ ุดุฎุตูุฉุ ุชุทุจูู ูุฑุฏูุฉ ููุงุณูุฉุ ุฅุนุงุฏุฉ ุถุจุท ุงููุดุฑ ุงููุงูู

### 5.3.11 AllRemindersPage โ ุฌููุน ุงูุชุฐููุฑุงุช
- **ุงููุตูู**: ุงููุณุชูู 10
- **ุงููุธููุฉ**: ุนุฑุถ ุฌููุน ุงูุชุฐููุฑุงุช ุบูุฑ ุงูููุชููุฉ ูุฑุชุจุฉ ุญุณุจ ุงูุงุณุชุนุฌุงู

### 5.3.12 ApiDocsPage โ ุชูุซูู API
- **ุงููุตูู**: ุงููุณุชูู 7
- **ุงููุธููุฉ**: ุนุฑุถ ุตูุญุฉ ุชูุซูู Scramble API

### 5.3.13 CustomLogin โ ุชุณุฌูู ุงูุฏุฎูู
- **ุงููุตูู**: ุนุงู
- **ุงููุธููุฉ**: ุตูุญุฉ ุชุณุฌูู ุฏุฎูู ูุฎุตุตุฉ

---

## 5.4 ุฃุฏูุงุช ููุญุฉ ุงููุนูููุงุช (Admin Widgets)

| ุงูุชุฑุชูุจ | ุงูุฃุฏุงุฉ | ุงููุตู | ุงูุชุญุฏูุซ |
|---------|--------|-------|---------|
| -3 | **LostOpportunityClockWidget** | ุณุงุนุฉ ุงููุฑุตุฉ ุงูุถุงุฆุนุฉ โ ุชูููุฉ ุงูุชุฃุฎูุฑ ุงููุชุฑุงููุฉ ููุดุฑูุฉ ุจุงููุงูู | 60 ุซ |
| -1 | **DailyNewsTicker** | ุดุฑูุท ุฃุฎุจุงุฑ ูุชุญุฑู: ุฃูู/ุขุฎุฑ ุญุถูุฑ ุจุงููุฑุนุ ุนุฏุฏ ุงูุญุงุถุฑูู/ุงููุชุฃุฎุฑููุ ุฃูุถู ููุงุท | โ |
| 0 | **RealTimeLossCounter** | ุนุฏุงุฏ ุงูุฎุณุงุฑุฉ ุงููุญุธู: ุฅุฌูุงูู ุงูุฎุณุงุฑุฉ ูุน ููุงุฑูุฉ ุงููุชุฑุฉ ุงูุณุงุจูุฉุ ุนุฏุฏ ุงููุชุฃุฎุฑูู/ุงูุบุงุฆุจููุ ุชููุน ุดูุฑู | 30 ุซ |
| 1 | **AttendanceOverview** | ููุฎุต: ุญุงุถุฑุ ูุชุฃุฎุฑุ ุบุงุฆุจุ ุฎุณุงุฆุฑ ุงูุชุฃุฎูุฑ (ุฑ.ุณ)ุ ูููุฉ ุงูุฅุถุงูู (ุฑ.ุณ) | 60 ุซ |
| 1 | **BranchPerformanceHeatmap** | ุฌุฏูู ุฃุฏุงุก ุงููุฑูุน: ููุธูููุ ูุณุจุฉ ุงูุญุถูุฑุ ูุณุจุฉ ุงูุณูุงุฌุ ุงูุฎุณุงุฑุฉ ุงูุดูุฑูุฉุ ุงูุฏุฑุฌุฉ | 60 ุซ |
| 2 | **RemindersCalendarWidget** | ุชุฐููุฑุงุช ุชูุชูู ุฎูุงู 90 ููููุง (ูุณุชูู 6+) | โ |
| 3 | **AttendanceHeatmapWidget** | ุฎุฑูุทุฉ ุญุฑุงุฑูุฉ ููุญุถูุฑ ุญุณุจ ุงููุฑุน | 60 ุซ |
| 4 | **EfficiencyScoreCardWidget** | ุจุทุงูุฉ ููุงุกุฉ: ุฏุฑุฌุฉ ุงูููุงุกุฉุ VPMุ ูุฌูุฉ ุงูุฅูุชุงุฌูุฉุ ูุนุฏู ุงูุญุถูุฑ ุงููุณุชูุฏู | 60 ุซ |
| 5 | **ROIMatrixWidget** | ูุตูููุฉ ุงูุนุงุฆุฏ ุนูู ุงูุงุณุชุซูุงุฑ | 60 ุซ |
| 15 | **WorkRestRatioWidget** | ูุณุจุฉ ุงูุนูู/ุงูุฑุงุญุฉ ููููุธููู (ูุณุชูู 6+) | 60 ุซ |
| 16 | **AnomalyAlertWidget** | ุชูุจููุงุช ุงูุดุฐูุฐ: ุขุฎุฑ 24 ุณุงุนุฉ (ูุณุชูู 7+) | 30 ุซ |

> **ูุทุงู ุงูุจูุงูุงุช**: ูุนุธู ุงูุฃุฏูุงุช ุชุนุฑุถ ุจูุงูุงุช ูุฑุน ุงููุณุชุฎุฏู ููุท. ุงููุณุชูู 10 ูุฑู ุฌููุน ุงููุฑูุน.

---

## 5.5 ุจูุงุจุฉ ุงูููุธู (Employee Portal โ `/app`)

### ุงูููุงุฑุฏ

#### AttendanceResource โ ุญุถูุฑู
- **ุงููุณุงุฑ**: `/app/my-attendance`
- **ุงููุทุงู**: ุณุฌูุงุช ุงูููุธู ุงููุณุฌูู ููุท
- **ุงูุนูููุงุช**: ุนุฑุถ + ุฅูุดุงุก ุชุณุฌูู ุญุถูุฑ ููุท (ูุง ุชุนุฏูู ุฃู ุญุฐู)
- **ุงูุญููู ุงูุชููุงุฆูุฉ**: ุงูุชุงุฑูุฎุ ุงูููุชุ GPSุ IPุ ุงูุฌูุงุฒ
- **ุชุฎุทูุท**: Stack/Split ููููุจุงูู โ ุงูุชุงุฑูุฎุ ุงูุญุงูุฉุ ุงูุฃููุงุชุ ุงูุฏูุงุฆู. ููุญุฉ ูุงุจูุฉ ููุทู: ุญุงูุฉ ุงูุณูุงุฌุ ููุงุญุธุงุช

#### LeaveResource โ ุฅุฌุงุฒุงุชู
- **ุงููุณุงุฑ**: `/app/my-leaves`
- **ุงููุทุงู**: ุทูุจุงุช ุงูููุธู ุงููุณุฌูู ููุท
- **ุงูุนูููุงุช**: ุฅูุดุงุก + ุนุฑุถ + ุชุนุฏูู/ุญุฐู ุงููุนูููุฉ ููุท
- **ุฃููุงุน ุงูุฅุฌุงุฒุฉ**: 9 ุฃููุงุน ูุน ูุฑูู

### ุงูุฃุฏูุงุช

| ุงูุฃุฏุงุฉ | ุงููุธููุฉ |
|--------|---------|
| **EmployeeWelcomeWidget** | ุชุฑุญูุจ ุดุฎุตู: ุงุณู ุงูููุธูุ ุงูุชุงุฑูุฎุ ุญุงูุฉ ุงูุญุถูุฑ ุงููููุ ููุช ุงูุชุณุฌูู |
| **PersonalMirrorWidget** | ูุฑุขุฉ ุงูุฃุฏุงุก ุงูุดุฎุตูุฉ ูู `AnalyticsService::getPersonalMirror()` |

---

> **ุงูุณุงุจู**: [ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช](04-roles-permissions.md) | **ุงูุชุงูู**: [ุงููุธุงู ุงููุงูู](06-financial-system.md)



================================================================================
ุงูููู: 06-financial-system.md
================================================================================

# 6. ุงููุธุงู ุงููุงูู

## 6.1 ูุธุฑุฉ ุนุงูุฉ

ูุนุชูุฏ ูุธุงู ูุคุดุฑ ุตุฑุญ ุงููุงูู ุนูู ูุจุฏุฃ **ุชุญููู ุงูุฑุงุชุจ ุฅูู ูููุฉ ุฒูููุฉ** (ุชูููุฉ ุงูุฏูููุฉ). ูู ุฏูููุฉ ุชุฃุฎูุฑ ุฃู ุบูุงุจ ุชูุญูููู ุฅูู ุฎุณุงุฑุฉ ูุงููุฉ ูุงุจูุฉ ููููุงุณ.

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ุงููุญุฑู ุงููุงูู ูุณูุฑ                           โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ                                                                 โ
โ   ุงูุฑุงุชุจ ุงูุฅุฌูุงูู = ุฃุณุงุณู + ุณูู + ููู + ุฃุฎุฑู                   โ
โ                                                                 โ
โ   ุฏูุงุฆู ุงูุนูู ุงูุดูุฑูุฉ = ุฃูุงู_ุงูุนูู ร ุณุงุนุงุช_ุงูููู ร 60          โ
โ                  ูุซุงู = 22 ร 8 ร 60 = 10,560 ุฏูููุฉ             โ
โ                                                                 โ
โ   ุชูููุฉ ุงูุฏูููุฉ = ุงูุฑุงุชุจ ุงูุฅุฌูุงูู รท ุฏูุงุฆู_ุงูุนูู_ุงูุดูุฑูุฉ       โ
โ            ูุซุงู = 10,000 รท 10,560 = 0.9470 ุฑ.ุณ/ุฏูููุฉ          โ
โ                                                                 โ
โ   ุชูููุฉ ุงูุชุฃุฎูุฑ = ุฏูุงุฆู_ุงูุชุฃุฎูุฑ ร ุชูููุฉ_ุงูุฏูููุฉ               โ
โ            ูุซุงู = 30 ุฏูููุฉ ร 0.9470 = 28.41 ุฑ.ุณ                โ
โ                                                                 โ
โ   ูููุฉ ุงูุฅุถุงูู = ุฏูุงุฆู_ุงูุฅุถุงูู ร ุชูููุฉ_ุงูุฏูููุฉ ร 1.5          โ
โ            ูุซุงู = 60 ุฏูููุฉ ร 0.9470 ร 1.5 = 85.23 ุฑ.ุณ          โ
โ                                                                 โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## 6.2 ุงูุฎุตุงุฆุต ุงููุญุณูุจุฉ ูู ูููุฐุฌ User

```php
// ุงูุฑุงุชุจ ุงูุฅุฌูุงูู
$user->total_salary = basic_salary + housing_allowance 
                    + transport_allowance + other_allowances;

// ุฏูุงุฆู ุงูุนูู ุงูุดูุฑูุฉ
$user->monthly_working_minutes = working_days_per_month 
                               ร working_hours_per_day ร 60;

// ุชูููุฉ ุงูุฏูููุฉ (ูู ุงูุฅุฌูุงูู)
$user->total_cost_per_minute = total_salary / monthly_working_minutes;

// ุชูููุฉ ุงูุฏูููุฉ (ูู ุงูุฃุณุงุณู ููุท)
$user->cost_per_minute = basic_salary / monthly_working_minutes;
```

---

## 6.3 ุงูููุทุฉ ุงููุงููุฉ (Financial Snapshot)

> **ูุจุฏุฃ ููู**: ุนูุฏ ุชุณุฌูู ุงูุญุถูุฑุ ุชูุฌููุฏ ูููุฉ `cost_per_minute` ูู ุณุฌู ุงูุญุถูุฑ. ุญุชู ูู ุชุบููุฑ ุงูุฑุงุชุจ ูุงุญููุงุ ูุธู ุงูุญุณุงุจ ุจุงููููุฉ ููุช ุงูุชุณุฌูู.

```php
// AttendanceService::checkIn()
$log->calculateFinancials();
// โ ุชููุณุฎ ุชูููุฉ_ุงูุฏูููุฉ ูู ุงูููุธู โ ุณุฌู ุงูุญุถูุฑ
// $log->cost_per_minute = $user->total_cost_per_minute

// AttendanceService::checkOut()
$log->delay_cost       = delay_minutes ร cost_per_minute
$log->early_leave_cost = early_leave_minutes ร cost_per_minute
$log->overtime_value   = overtime_minutes ร cost_per_minute ร 1.5
```

---

## 6.4 ูุดูู ุงูุฑูุงุชุจ (Payroll)

### ุชูููุฏ ุงููุดู

ุงูุฃูุฑ: `php artisan sarh:payroll --period=2026-02 --branch=1`

```
ููู ููุธู ูุดุท:
  1. ูุณุฎ ุจูุงูุงุช ุงูุฑุงุชุจ ุงูุญุงููุฉ (ุฃุณุงุณู + ุจุฏูุงุช)
  2. ุชุฌููุน ุณุฌูุงุช ุงูุญุถูุฑ ูููุชุฑุฉ:
     - ุฃูุงู ุงูุญุถูุฑ / ุงูุบูุงุจ / ุงูุชุฃุฎุฑ
     - ุฅุฌูุงูู ุฏูุงุฆู ุงูุชุฃุฎูุฑ
     - ุฅุฌูุงูู ุฏูุงุฆู ุงูุฅุถุงูู
  3. ุญุณุงุจ ุงูุฎุตููุงุช:
     - ุฎุตู ุงูุชุฃุฎูุฑ = ูุฌููุน delay_cost ูู attendance_logs
     - ุฎุตู ุงูุบูุงุจ = ุฃูุงู_ุงูุบูุงุจ ร (ุงูุฑุงุชุจ_ุงููููู)
     - ุฎุตู ุงููุบุงุฏุฑุฉ ุงููุจูุฑุฉ = ูุฌููุน early_leave_cost
  4. ุญุณุงุจ ุงูุฅุถุงูุงุช:
     - ุฃุฌุฑ ุงูุฅุถุงูู = ูุฌููุน overtime_value
     - ููุงูุขุช (ูุฏูู)
  5. ุตุงูู ุงูุฑุงุชุจ = ุฅุฌูุงูู - ุฎุตููุงุช + ุฅุถุงูุงุช
```

### ุฏูุฑุฉ ุญูุงุฉ ุงููุดู

```
draft (ูุณูุฏุฉ) โ approved (ูุนุชูุฏ) โ paid (ูุฏููุน)
```

- **draft**: ูููู ุชุนุฏููู
- **approved**: ูุง ูููู ุชุนุฏููู ุฅูุง ุจุฅูุบุงุก ุงูุงุนุชูุงุฏ (ูุณุชูู 8+)
- **paid**: ูุคุฑุดู

---

## 6.5 ุฎุฏูุฉ ุงูุชูุงุฑูุฑ ุงููุงููุฉ (FinancialReportingService)

### `getDailyLoss($date, $branchId?)`
ุฅุฌูุงูู ุฎุณุงุฆุฑ ุงูุชุฃุฎูุฑ ูููู ูุญุฏุฏ. ูุฎุฒู ูุคูุชูุง 5 ุฏูุงุฆู.

### `getBranchPerformance($month)`
ุฃุฏุงุก ูู ูุฑุน ุดูุฑููุง:
- ุนุฏุฏ ุงูููุธูููุ ุนุฏุฏ ุงูุณุฌูุงุช
- ูุณุจุฉ ุงูุญุถูุฑ ูู ุงูููุช / ุงูุชุฃุฎุฑ / ุงูุบูุงุจ
- ุงูุชูุงูุงุช ุงูุณูุงุฌ ุงูุฌุบุฑุงูู ููุณุจุฉ ุงูุงูุชุฒุงู
- ุฅุฌูุงูู ุงูุฎุณุงุฑุฉุ ุงูุฏุฑุฌุฉ:

| ุงูุฏุฑุฌุฉ | ูุณุจุฉ ุงูุญุถูุฑ ูู ุงูููุช |
|--------|----------------------|
| ููุชุงุฒ | โฅ 95% |
| ุฌูุฏ | โฅ 85% |
| ูุชูุณุท | โฅ 70% |
| ุถุนูู | < 70% |

### `getDelayImpactAnalysis($start, $end, $scope, $scopeId?)`
ุชุญููู ุนุงุฆุฏ ุงูุงูุถุจุงุท (ROI):
- ุงูุฎุณุงุฑุฉ ุงููุญุชููุฉ (ุจุฏูู ูุธุงู ุชุญููุฒ) = ุงูุฎุณุงุฑุฉ ุงููุนููุฉ ร 1.3
- ุงูุฎุณุงุฑุฉ ุงููุนููุฉ
- ุงูุชูููุฑ = ุงููุญุชููุฉ - ุงููุนููุฉ
- ROI% = (ุงูุชูููุฑ / ุงููุญุชููุฉ) ร 100

### `getPredictiveMonthlyLoss($month)`
ุชููุน ุงูุฎุณุงุฑุฉ ุงูุดูุฑูุฉ:
- ุฃูุงู ุงูุนูู ุงููููุถูุฉ
- ุงูุฎุณุงุฑุฉ ุงููุชุฑุงููุฉ
- ูุชูุณุท ุงูุฎุณุงุฑุฉ ุงูููููุฉ
- ุงูุชููุน = ุงููุชูุณุท ร 22 ููู ุนูู

---

## 6.6 ูุญุฑู ุงููุนุงุฏูุงุช (FormulaEngineService)

ูุชูุญ ุฅูุดุงุก **ูุนุงุฏูุงุช ูุฎุตุตุฉ** ุชูููููู ุนุจุฑ ููุชุจุฉ Symfony ExpressionLanguage:

### ุงููุชุบูุฑุงุช ุงููุชุงุญุฉ (13 ูุชุบูุฑูุง)

| ุงููุชุบูุฑ | ุงููุตู |
|---------|-------|
| `attendance` | ูุณุจุฉ ุงูุญุถูุฑ (%) |
| `delay_rate` | ูุณุจุฉ ุงูุชุฃุฎุฑ (%) |
| `on_time_rate` | ูุณุจุฉ ุงูุญุถูุฑ ูู ุงูููุช (%) |
| `total_points` | ูุฌููุน ููุงุท ุงูููุธู |
| `overtime_rate` | ูุณุจุฉ ุงูุฅุถุงูู (%) |
| `early_leave_rate` | ูุณุจุฉ ุงููุบุงุฏุฑุฉ ุงููุจูุฑุฉ (%) |
| `financial_loss` | ุงูุฎุณุงุฑุฉ ุงููุงููุฉ (ุฑ.ุณ) |
| `task_completion` | ูุณุจุฉ ุฅูุฌุงุฒ ุงูููุงู (ุญุงูููุง = 100) |
| `current_streak` | ุณูุณูุฉ ุงูุญุถูุฑ ุงูุญุงููุฉ |
| `longest_streak` | ุฃุทูู ุณูุณูุฉ ุญุถูุฑ |
| `total_delay_minutes` | ุฅุฌูุงูู ุฏูุงุฆู ุงูุชุฃุฎูุฑ |
| `total_overtime_minutes` | ุฅุฌูุงูู ุฏูุงุฆู ุงูุฅุถุงูู |
| `manual_adjustments` | ุงูุชุนุฏููุงุช ุงููุฏููุฉ ูู score_adjustments |

### ูุซุงู ูุนุงุฏูุฉ

```
(on_time_rate * 0.4) + (attendance * 0.3) + (current_streak * 2) - (delay_rate * 0.2)
```

### ุงูุฃูุงู
- ุงููุนุงุฏูุงุช ุชูููููู ุนุจุฑ `ExpressionLanguage` ูููุณ `eval()` โ ุขููุฉ ูู ุญูู ุงูููุฏ
- ุฅุฌุฑุงุก "ุงุฎุชุจุงุฑ ุงููุนุงุฏูุฉ" ูู ReportFormulaResource ูุชูุญ ุงูุชุญูู ูุจู ุงูุชูุนูู

---

## 6.7 ุณุงุนุฉ ุงููุฑุตุฉ ุงูุถุงุฆุนุฉ (Lost Opportunity Clock)

ุฎุงุตูุฉ ูุฑูุฏุฉ ุชุนุฑุถ **ุชูููุฉ ุงูุชุฃุฎูุฑ ุงููุชุฑุงููุฉ ูุญุธููุง** ุนุจุฑ ุฌููุน ุงููุฑูุน:

```php
// AnalyticsService::getLostOpportunityClock()
ููู ูุฑุน ูุดุท:
  - ุชุฌููุน delay_cost + early_leave_cost ูู ุณุฌูุงุช ุงูููู
  - ุญุณุงุจ ุฎุณุงุฑุฉ ุงูุบูุงุจ = (ููุธููู ูุดุทูู - ุญุงุถุฑูู) ร VPM ร ุฏูุงุฆู_ุงููุฑุฏูุฉ
  
ุงููุชูุฌุฉ:
  - total_loss: ุฅุฌูุงูู ุงูุฎุณุงุฑุฉ (ุฑ.ุณ)
  - total_delay_minutes: ุฅุฌูุงูู ุฏูุงุฆู ุงูุชุฃุฎูุฑ
  - absent_count: ุนุฏุฏ ุงูุบุงุฆุจูู
  - branches: ุชูุตูู ุฃุนูู 5 ูุฑูุน ุฎุณุงุฑุฉ
```

**ุชุชุญุฏุซ ุชููุงุฆููุง** ูู 60 ุซุงููุฉ ูู ููุญุฉ ุงููุนูููุงุช.

---

> **ุงูุณุงุจู**: [ููููุงุช Filament](05-filament-components.md) | **ุงูุชุงูู**: [ูุธุงู ุงูุญุถูุฑ](07-attendance-system.md)



================================================================================
ุงูููู: 07-attendance-system.md
================================================================================

# 7. ูุธุงู ุงูุญุถูุฑ ูุงูุงูุตุฑุงู

## 7.1 ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุญุถูุฑ ุฐูู ูุนุชูุฏ ุนูู **GPS + ุงูุณูุงุฌ ุงูุฌุบุฑุงูู** ูุน ุฏุนู ููุงุณุชุซูุงุกุงุช ูุงููุนุงูุฌุฉ ุบูุฑ ุงููุชุฒุงููุฉ.

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                ุชุฏูู ุชุณุฌูู ุงูุญุถูุฑ                 โ
โ                                                  โ
โ   ๐ฑ ุงูููุธู ููุชุญ ุงูุชุทุจูู                        โ
โ     โ                                            โ
โ   ๐ ูุฑุงุกุฉ GPS (latitude, longitude)             โ
โ     โ                                            โ
โ   ๐ POST /attendance/check-in                   โ
โ     โ                                            โ
โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ       โ
โ   โ  AttendanceService::checkIn()        โ       โ
โ   โ  1. ุชุญุฏูุฏ ุงููุฑุน                      โ       โ
โ   โ  2. ูุญุต ุงูุณูุงุฌ ุงูุฌุบุฑุงูู              โ       โ
โ   โ  3. ูุญุต ุงูุงุณุชุซูุงุกุงุช                  โ       โ
โ   โ  4. ุชุญุฏูุฏ ุงููุฑุฏูุฉ                    โ       โ
โ   โ  5. ุชูููู ุงูุญุงูุฉ (ุญุงุถุฑ/ูุชุฃุฎุฑ)       โ       โ
โ   โ  6. ุชุฌููุฏ ุงูุจูุงูุงุช ุงููุงููุฉ            โ       โ
โ   โ  7. ุญูุธ ุงูุณุฌู                        โ       โ
โ   โ  8. ุฅุทูุงู ุญุฏุซ AttendanceRecorded     โ       โ
โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ       โ
โ     โ                                            โ
โ   โ ุณุฌู ุงูุญุถูุฑ ูุญููุธ                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## 7.2 ุฎุฏูุฉ ุงูุญุถูุฑ (AttendanceService)

### 7.2.1 `checkIn()` โ ุชุณุฌูู ุงูุญุถูุฑ

**ุงููุนุงููุงุช**: `User`, `$lat`, `$lng`, `$ip?`, `$device?`

**ุงูุชุฏูู ุงูููุตูู**:

1. **ุชุญุฏูุฏ ุงููุฑุน**: `$user->branch` โ ูุฌุจ ุฃู ูููู ููููุธู ูุฑุน ูุนููู
2. **ูุญุต ุงูุณูุงุฌ ุงูุฌุบุฑุงูู**:
   - ุญุณุงุจ ุงููุณุงูุฉ ุจู Haversine: `GeofencingService::validatePosition()`
   - ุฅุฐุง ุฎุงุฑุฌ ุงูุณูุงุฌ:
     - ุงููุณุชูู 10 ูุชุฌุงูุฒ (`bypass-geofence` Gate)
     - ุงุณุชุซูุงุก ุญุถูุฑ ูุดุท ูุน `bypass_geofence` ูุชุฌุงูุฒ
     - ูุฅูุง: `OutOfGeofenceException` ูุน ุงููุณุงูุฉ ูุงููุตู ูุทุฑ
3. **ุชุญุฏูุฏ ุงููุฑุฏูุฉ** (ุจุงูุฃููููุฉ):
   ```
   ุงุณุชุซูุงุก ุญุถูุฑ (custom_shift_start) โ ูุฑุฏูุฉ ุงููุณุชุฎุฏู ุงูุญุงููุฉ โ ูุฑุฏูุฉ ุงููุฑุน ุงูุงูุชุฑุงุถูุฉ
   ```
   ูุชุฑุฉ ุงูุณูุงุญ ุจููุณ ุงูุฃููููุฉ.
4. **ุฅูุดุงุก ุณุฌู ุงูุญุถูุฑ** ูุน ุจูุงูุงุช GPS ูIP ูุงูุฌูุงุฒ
5. **ุชูููู ุงูุญุงูุฉ**:
   - ุฅุฐุง ุงูููุช โค ุจุฏุงูุฉ_ุงููุฑุฏูุฉ + ูุชุฑุฉ_ุงูุณูุงุญ โ `present` (ุญุงุถุฑ)
   - ุฅุฐุง ุงูููุช > ุจุฏุงูุฉ_ุงููุฑุฏูุฉ + ูุชุฑุฉ_ุงูุณูุงุญ โ `late` (ูุชุฃุฎุฑ) + ุญุณุงุจ ุงูุฏูุงุฆู
   - ุฅุฐุง ุงุณุชุซูุงุก `bypass_late_flag` ูุดุท ููุชุฃุฎุฑ โ ููุญููู ุฅูู `present`
6. **ุชุฌููุฏ ุงูุจูุงูุงุช ุงููุงููุฉ**: `cost_per_minute` ูููุณุฎ ูู ุงูููุธู โ ุงูุณุฌู
7. **ุงูุญูุธ** ุซู ุฅุทูุงู `AttendanceRecorded` event

### 7.2.2 `checkOut()` โ ุชุณุฌูู ุงูุงูุตุฑุงู

**ุงููุนุงููุงุช**: `User`, `$lat`, `$lng`

1. **ุงูุจุญุซ ุนู ุณุฌู ุงูููู**: `firstOrFail()` โ ูุฑูู ุงุณุชุซูุงุก ุฅุฐุง ูู ููุฌุฏ
2. **ุชุณุฌูู ุจูุงูุงุช ุงูุงูุตุฑุงู**: GPS + ุญุงูุฉ ุงูุณูุงุฌ
3. **ุญุณุงุจ ุงูุฏูุงุฆู**: `check_in_at->diffInMinutes(now)`
4. **ููุงุฑูุฉ ูุน ุงููุฑุฏูุฉ**:
   - ุนูู > ุงููุทููุจ โ ุฅุถุงูู
   - ุนูู < ุงููุทููุจ โ ูุบุงุฏุฑุฉ ูุจูุฑุฉ
5. **ุฅุนุงุฏุฉ ุญุณุงุจ ุงูุชูุงููู**:
   - `delay_cost = delay_minutes ร cost_per_minute`
   - `early_leave_cost = early_leave_minutes ร cost_per_minute`
   - `overtime_value = overtime_minutes ร cost_per_minute ร 1.5`

### 7.2.3 `queueCheckIn()` โ ุญุถูุฑ ุบูุฑ ูุชุฒุงูู

ููุฃููุงุช ุฐุงุช ุงูุถุบุท ุงูุนุงูู (ุจุฏุงูุฉ ุงูุฏูุงู):

```php
ProcessAttendanceJob::dispatch($user, $lat, $lng, $ip, $device);
// โ ูุนูุฏ: {status: 'processing', message: 'ุฌุงุฑู ูุนุงูุฌุฉ ุทูุจ ุงูุญุถูุฑ'}
```

---

## 7.3 ุงูุณูุงุฌ ุงูุฌุบุฑุงูู (GeofencingService)

### ูุนุงุฏูุฉ Haversine

```
distance = R ร 2 ร atan2(โa, โ(1-a))

ุญูุซ:
  a = sinยฒ(ฮlat/2) + cos(latโ) ร cos(latโ) ร sinยฒ(ฮlng/2)
  R = 6,371,000 ูุชุฑ (ูุตู ูุทุฑ ุงูุฃุฑุถ)
```

### ุงูุชุญูู

```php
$geo = $geofencing->validatePosition($branch, $lat, $lng);
// $geo['distance_meters']   โ 85.42
// $geo['within_geofence']   โ true (ุฅุฐุง โค geofence_radius)
```

### ุฅุนุฏุงุฏุงุช ุงูุณูุงุฌ ููู ูุฑุน

| ุงูุฅุนุฏุงุฏ | ุงูุงูุชุฑุงุถู | ุงููุตู |
|---------|-----------|-------|
| `latitude` / `longitude` | โ | ูุฑูุฒ ุงููุฑุน |
| `geofence_radius` | 100 ูุชุฑ | ูุตู ูุทุฑ ุงูุณูุงุฌ |

---

## 7.4 ูุญุฑู ุงูุงุณุชุซูุงุกุงุช (AttendanceException)

ุงุณุชุซูุงุกุงุช ุงูุญุถูุฑ ุชูุชูุญ ุชุฌุงูุฒ ุงูููุงุนุฏ ุงูููุงุณูุฉ ูููุธููู ูุญุฏุฏูู:

| ุงูููุน | ุงููุตู | ุงูุชุฌุงูุฒุงุช |
|-------|-------|-----------|
| `flexible_hours` | ุณุงุนุงุช ูุฑูุฉ | ูุฑุฏูุฉ ูุฎุตุตุฉ + ูุชุฑุฉ ุณูุงุญ ุฃุทูู |
| `remote_work` | ุนูู ุนู ุจุนุฏ | ุชุฌุงูุฒ ุงูุณูุงุฌ ุงูุฌุบุฑุงูู |
| `vip_bypass` | ุชุฌุงูุฒ VIP | ุชุฌุงูุฒ ุงูุณูุงุฌ + ุชุฌุงูุฒ ุนูู ุงูุชุฃุฎูุฑ |
| `medical` | ุญุงูุฉ ุทุจูุฉ | ูุชุฑุฉ ุณูุงุญ ุฅุถุงููุฉ + ุชุฌุงูุฒ ุงูุชุฃุฎูุฑ |
| `custom` | ูุฎุตุต | ุฃู ูุฒูุฌ ูู ุงูุชุฌุงูุฒุงุช |

### ุญููู ุงูุงุณุชุซูุงุก

```php
$exception->bypass_geofence    // ุชุฌุงูุฒ ูุญุต ุงูุณูุงุฌ
$exception->bypass_late_flag   // ุชุญููู "ูุชุฃุฎุฑ" ุฅูู "ุญุงุถุฑ"
$exception->custom_shift_start // ููุช ุจุฏุงูุฉ ูุฎุตุต
$exception->custom_shift_end   // ููุช ููุงูุฉ ูุฎุตุต
$exception->custom_grace_minutes // ูุชุฑุฉ ุณูุงุญ ูุฎุตุตุฉ
$exception->start_date / end_date // ูุชุฑุฉ ุณุฑูุงู ุงูุงุณุชุซูุงุก
```

---

## 7.5 ุญุงูุงุช ุงูุญุถูุฑ

| ุงูุญุงูุฉ | ุงูุดุฑุท |
|--------|-------|
| `present` | ุญุถูุฑ ูู ุงูููุช (ุถูู ูุชุฑุฉ ุงูุณูุงุญ) |
| `late` | ุญุถูุฑ ุจุนุฏ ูุชุฑุฉ ุงูุณูุงุญ |
| `absent` | ูุง ููุฌุฏ ุณุฌู ุญุถูุฑ |
| `on_leave` | ูู ุฅุฌุงุฒุฉ ูุนุชูุฏุฉ |
| `holiday` | ููู ุนุทูุฉ |
| `remote` | ุนูู ุนู ุจุนุฏ (ุงุณุชุซูุงุก) |
| `half_day` | ูุตู ููู |
| `exception` | ุงุณุชุซูุงุก ุฎุงุต |

---

## 7.6 ุทูุจุงุช ุงูุฅุฌุงุฒุฉ (LeaveRequest)

### ุฃููุงุน ุงูุฅุฌุงุฒุฉ

| ุงูููุน | ุงูุงุณู |
|-------|-------|
| `annual` | ุณูููุฉ |
| `sick` | ูุฑุถูุฉ |
| `emergency` | ุทุงุฑุฆุฉ |
| `unpaid` | ุจุฏูู ุฑุงุชุจ |
| `maternity` | ุฃูููุฉ |
| `paternity` | ุฃุจูุฉ |
| `hajj` | ุญุฌ |
| `death` | ููุงุฉ |
| `marriage` | ุฒูุงุฌ |

### ุฏูุฑุฉ ุญูุงุฉ ุงูุทูุจ

```
pending (ูุนููู) โ approved (ูุนุชูุฏ) / rejected (ูุฑููุถ)
                โ cancelled (ููุบู) โ ููุท ุงููุนููู ูููู ุฅูุบุงุคู
```

- ุงูููุธู ููุฏู ุงูุทูุจ (ูุณุชูู 1+)
- ุงููุดุฑู ูุนุชูุฏ/ูุฑูุถ (ูุณุชูู 5+)
- ุงูุทูุจ ุงููุนุชูุฏ ููุญููู ุณุฌูุงุช ุงูุญุถูุฑ ูุฃูุงู ุงูุฅุฌุงุฒุฉ ุฅูู `on_leave`

---

## 7.7 ุงููุฑุฏูุงุช (Shifts)

### ุจููุฉ ุงููุฑุฏูุฉ

```php
Shift {
    start_time: '08:00'
    end_time: '17:00'
    grace_period_minutes: 15
    is_overnight: false      // ูุฑุฏูุฉ ููููุฉ (ุชุชุฌุงูุฒ ููุชุตู ุงูููู)
    duration_minutes: 540    // ูุญุณูุจ
}
```

### ุฃููููุฉ ุชุญุฏูุฏ ุงููุฑุฏูุฉ

```
1. ุงุณุชุซูุงุก ุญุถูุฑ ูุดุท (custom_shift_start/end)
2. ุงููุฑุฏูุฉ ุงูุญุงููุฉ ููููุธู (user_shifts.is_current = true)
3. ุงููุฑุฏูุฉ ุงูุงูุชุฑุงุถูุฉ ูููุฑุน (branch.default_shift_start/end)
4. ุงูุงูุชุฑุงุถู: 480 ุฏูููุฉ (8 ุณุงุนุงุช)
```

---

## 7.8 ููุงุท ุงูุฏุฎูู (API Endpoints)

| ุงููุณุงุฑ | ุงูุทุฑููุฉ | ุงููุตู |
|--------|---------|-------|
| `POST /attendance/check-in` | ูุชุฒุงูู | ุชุณุฌูู ุญุถูุฑ ููุฑู |
| `POST /attendance/queue-check-in` | ุบูุฑ ูุชุฒุงูู | ุชุณุฌูู ุญุถูุฑ ุนุจุฑ queue |
| `POST /attendance/check-out` | ูุชุฒุงูู | ุชุณุฌูู ุงูุตุฑุงู |
| `GET /attendance/today` | โ | ุญุงูุฉ ุญุถูุฑ ุงูููู |

### ุงููุนุงููุงุช ุงููุทููุจุฉ (check-in)

```json
{
    "latitude": 24.7136,
    "longitude": 46.6753
}
```

### ุงูุงุณุชุฌุงุจุฉ

```json
{
    "status": "success",
    "data": {
        "id": 1234,
        "attendance_date": "2026-02-01",
        "check_in_at": "2026-02-01T08:05:00",
        "status": "present",
        "delay_minutes": 0,
        "distance_meters": 45.2,
        "within_geofence": true
    }
}
```

---

> **ุงูุณุงุจู**: [ุงููุธุงู ุงููุงูู](06-financial-system.md) | **ุงูุชุงูู**: [ูุธุงู ุงูุชุญูููุงุช](08-analytics-system.md)



================================================================================
ุงูููู: 08-analytics-system.md
================================================================================

# 8. ูุธุงู ุงูุชุญูููุงุช

## 8.1 ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุชุญูููุงุช ุดุงูู (889 ุณุทุฑูุง) ููููุฑ ุฑุคู ุนูููุฉ ุนู ุฃุฏุงุก ุงููุฑูุน ูุงูููุธููู ุนุจุฑ ุฎุฏูุฉ `AnalyticsService`.

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                   AnalyticsService                            โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ุงูููุงููุณ ุงูุฃุณุงุณูุฉ                                           โ
โ  โโโ VPM (ุงููููุฉ ููู ุฏูููุฉ)                                 โ
โ  โโโ calculateTotalLoss (ุงูุฎุณุงุฑุฉ ุงูุฅุฌูุงููุฉ)                  โ
โ  โโโ calculateProductivityGap (ูุฌูุฉ ุงูุฅูุชุงุฌูุฉ)              โ
โ  โโโ calculateEfficiencyScore (ุฏุฑุฌุฉ ุงูููุงุกุฉ ุงููุฑููุจุฉ)        โ
โ                                                              โ
โ  ุงูุชุญูููุงุช ุงููุชูุฏูุฉ                                          โ
โ  โโโ calculateROIMatrix (ูุตูููุฉ ุงูุนุงุฆุฏ ุนูู ุงูุงุณุชุซูุงุฑ)        โ
โ  โโโ generateHeatmapData (ุฎุฑูุทุฉ ุญุฑุงุฑูุฉ)                     โ
โ  โโโ getLostOpportunityClock (ุณุงุนุฉ ุงููุฑุตุฉ ุงูุถุงุฆุนุฉ)          โ
โ                                                              โ
โ  ุงูุชุดุงู ุงูุฃููุงุท                                             โ
โ  โโโ detectFrequentLatePattern (ููุท ุงูุชุฃุฎุฑ ุงููุชูุฑุฑ)         โ
โ  โโโ detectPreHolidayPattern (ููุท ูุง ูุจู ุงูุนุทูุฉ)            โ
โ  โโโ detectMonthlyCyclePattern (ููุท ุงูุฏูุฑุฉ ุงูุดูุฑูุฉ)         โ
โ                                                              โ
โ  ุงูุชูุจููุงุช ูุงูุชูุงุฑูุฑ                                        โ
โ  โโโ checkAndTriggerAlerts (ุงูุชูุจููุงุช ุงูุชููุงุฆูุฉ)             โ
โ  โโโ generateDailySnapshot (ุงูููุทุฉ ุงูููููุฉ)                 โ
โ  โโโ runFullAnalysis (ุงูุชุญููู ุงูุดุงูู)                       โ
โ  โโโ getPersonalMirror (ุงููุฑุขุฉ ุงูุดุฎุตูุฉ)                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## 8.2 ุงูููุงููุณ ุงูุฃุณุงุณูุฉ

### 8.2.1 VPM โ ุงููููุฉ ููู ุฏูููุฉ

```
VPM = ููุฒุงููุฉ_ุงูุฑูุงุชุจ_ุงูุดูุฑูุฉ รท (ููุธููู ร ุฃูุงู_ุนูู ร ุณุงุนุงุช ร 60)
```

- ูุณุชุจุนุฏ ุนุทูุฉ ููุงูุฉ ุงูุฃุณุจูุน (ุงูุฌูุนุฉ ูุงูุณุจุช)
- ูุณุชุจุนุฏ ุงูุนุทูุงุช ุงูุฑุณููุฉ ุงููุณุฌูุฉ

### 8.2.2 ุฅุฌูุงูู ุงูุฎุณุงุฑุฉ โ `calculateTotalLoss()`

```
ุงูุฎุณุงุฑุฉ = ุฎุณุงุฑุฉ_ุงูุชุฃุฎูุฑ + ุฎุณุงุฑุฉ_ุงูุบูุงุจ + ุฎุณุงุฑุฉ_ุงููุบุงุฏุฑุฉ_ุงููุจูุฑุฉ

ุฎุณุงุฑุฉ ุงูุชุฃุฎูุฑ = ูุฌููุน delay_cost ูู ุณุฌูุงุช ุงูุญุถูุฑ
ุฎุณุงุฑุฉ ุงูุบูุงุจ = (ููุธููู_ูุดุทูู - ุญุงุถุฑูู) ร ุฏูุงุฆู_ุงููุฑุฏูุฉ ร VPM
ุฎุณุงุฑุฉ ุงููุบุงุฏุฑุฉ = ูุฌููุน early_leave_cost
```

> โ๏ธ ูุชุฎุทู ุฃูุงู ุงูุฌูุนุฉ/ุงูุณุจุช ูุงูุนุทูุงุช

### 8.2.3 ูุฌูุฉ ุงูุฅูุชุงุฌูุฉ โ `calculateProductivityGap()`

```
ุงููุฌูุฉ = ((ุงููุณุชูุฏู% - ุงููุนูู%) รท ุงููุณุชูุฏู%) ร 100

ุงููุณุชูุฏู ุงูุงูุชุฑุงุถู: 95%
ูุซุงู: ((95 - 82) รท 95) ร 100 = 13.68%
```

### 8.2.4 ุฏุฑุฌุฉ ุงูููุงุกุฉ ุงููุฑููุจุฉ โ `calculateEfficiencyScore()`

ุฏุฑุฌุฉ ูู 0 ุฅูู 100 ุชุฌูุน ุจูู ุฃุฑุจุนุฉ ุนูุงูู:

| ุงูุนุงูู | ุงููุฒู | ุงูุญุณุงุจ |
|--------|-------|--------|
| ูุณุจุฉ ุงูุญุถูุฑ | 40% | (ุญุงุถุฑูู รท ุฅุฌูุงูู_ุงูุณุฌูุงุช) ร 100 |
| ุงูุงูุถุจุงุท | 30% | 100 - (ูุชูุณุท_ุงูุชุฃุฎูุฑ_ุจุงูุฏูุงุฆู รท 30 ร 100) |
| ุงูุงุญุชูุงุธ | 20% | (ุฏูุงุฆู_ุนูู_ูุนููุฉ รท ุฏูุงุฆู_ูุชููุนุฉ) ร 100 |
| ุฃูุงู ุจุฏูู ุฎุณุงุฑุฉ | 10% | (ุฃูุงู_ุฎุณุงุฑุฉ_ุตูุฑ รท ุฅุฌูุงูู_ุงูุฃูุงู) ร 100 |

---

## 8.3 ุงูุชุญูููุงุช ุงููุชูุฏูุฉ

### 8.3.1 ูุตูููุฉ ROI โ `calculateROIMatrix()`

ููู ูุฑุน:

```
ROI = (ุงูููุฒุงููุฉ - ุงูุฎุณุงุฆุฑ) รท ุงูููุฒุงููุฉ ร 100
```

ุงูุชุตููู ูู ุฃุฑุจุงุน:

| ุงูุฑุจุน | ุงูุดุฑุท | ุงููุตู |
|-------|-------|-------|
| โญ Star (ูุฌู) | ROI โฅ 90% **ู** ููุงุกุฉ โฅ 70% | ุฃุฏุงุก ููุชุงุฒ |
| ๐ฐ Cash Cow (ุจูุฑุฉ ุญููุจ) | ROI โฅ 90% **ู** ููุงุกุฉ < 70% | ูุฑุจุญ ููู ูุญุชุงุฌ ุชุญุณูู |
| ๐ Potential (ูุงุนุฏ) | ROI < 90% **ู** ููุงุกุฉ โฅ 70% | ููุก ููู ุงูุฎุณุงุฆุฑ ูุฑุชูุนุฉ |
| โ๏ธ At Risk (ูู ุฎุทุฑ) | ROI < 90% **ู** ููุงุกุฉ < 70% | ูุญุชุงุฌ ุชุฏุฎู ุนุงุฌู |

### 8.3.2 ุงูุฎุฑูุทุฉ ุงูุญุฑุงุฑูุฉ โ `generateHeatmapData()`

ุจูุงูุงุช ุจูุนุฏูู:

1. **ุงูุชูุฒูุน ุงูุณุงุนู**: ุนุฏุฏ ุชุณุฌููุงุช ุงูุญุถูุฑ ููู ุณุงุนุฉ (6-23)
2. **ุงูุชูุฒูุน ุงููููู**: ุญุงุถุฑ/ูุชุฃุฎุฑ/ุบุงุฆุจ ููู ููู ูู ุงูุฃุณุจูุน

### 8.3.3 ุณุงุนุฉ ุงููุฑุตุฉ ุงูุถุงุฆุนุฉ โ `getLostOpportunityClock()`

```php
ุงููุชูุฌุฉ = [
    'total_loss'          => 12,450.30,  // ุฑ.ุณ โ ุฅุฌูุงูู ุฎุณุงุฆุฑ ุงูููู
    'total_delay_minutes' => 1,234,      // ุฅุฌูุงูู ุฏูุงุฆู ุงูุชุฃุฎูุฑ
    'absent_count'        => 15,         // ุนุฏุฏ ุงูุบุงุฆุจูู
    'branches'            => [           // ุฃุนูู 5 ูุฑูุน ุฎุณุงุฑุฉ
        ['name' => 'ุงููุฑุน ุงูุฑุฆูุณู', 'loss' => 5,200.00],
        ...
    ]
]
```

---

## 8.4 ุงูุชุดุงู ุงูุฃููุงุท

### 8.4.1 ููุท ุงูุชุฃุฎุฑ ุงููุชูุฑุฑ โ `detectFrequentLatePattern()`

- **ุงููุชุฑุฉ**: ุขุฎุฑ 14 ููููุง
- **ุงูุดุฑุท**: ุชุฃุฎุฑ โฅ 3 ูุฑุงุช
- **ุฏุฑุฌุฉ ุงูุฎุทุฑ**: `min(100, ุนุฏุฏ_ุงูุชุฃุฎุฑุงุช รท 10 ร 100)`
- ูููุดุฆ/ููุญุฏูุซ ุณุฌู `EmployeePattern`

### 8.4.2 ููุท ูุง ูุจู ุงูุนุทูุฉ โ `detectPreHolidayPattern()`

- **ุงููุชุฑุฉ**: 3 ุฃุดูุฑ
- **ุงูุดุฑุท**: ุบูุงุจ ูุจู ุฃู ุจุนุฏ ุงูุนุทูุงุช ุจูุณุจุฉ โฅ 50%
- **ูุณุชููุงุช ุงูุฎุทุฑ**:
  - โฅ 80% โ critical (ุญุฑุฌ)
  - โฅ 60% โ high (ูุฑุชูุน)
  - ุบูุฑ ุฐูู โ medium (ูุชูุณุท)

### 8.4.3 ููุท ุงูุฏูุฑุฉ ุงูุดูุฑูุฉ โ `detectMonthlyCyclePattern()`

- **ุงููุชุฑุฉ**: 3 ุฃุดูุฑ
- **ุงูุดุฑุท**: ููู ูุญุฏุฏ ูู ุงูุฃุณุจูุน ุจูุณุจุฉ ุชุฃุฎุฑ > 60% ูู โฅ 4 ุนููุงุช
- ูุซุงู: "ุงูุฃุญุฏ" ุชุฃุฎุฑ 70% ูู ุงููุฑุงุช โ ููุท ููุชุดู

---

## 8.5 ูุธุงู ุงูุชูุจููุงุช โ `checkAndTriggerAlerts()`

ูููุดุฆ ุชูุจููุงุช `LossAlert` ุชููุงุฆููุง ุนูุฏ:

| ุงูููุน | ุงูุดุฑุท | ุงูุฎุทูุฑุฉ |
|-------|-------|---------|
| `threshold_exceeded` | ุฎุณุงุฑุฉ ููููุฉ > ุงูุญุฏ ุงูุฃูุตู ุงูููุจูู | ุญุณุจ ุงููุณุจุฉ |
| `low_attendance` | ูุณุจุฉ ุงูุญุถูุฑ ุฃูู ูู ุงููุณุชูุฏู ุจู > 10% | high |
| `mass_late` | > 30% ูู ุงูููุธููู ูุชุฃุฎุฑูู | high |

---

## 8.6 ุงูููุทุฉ ุงูููููุฉ โ `generateDailySnapshot()`

ุชูุญูุธ ูู ุฌุฏูู `analytics_snapshots` ูููููุง ููู ูุฑุน:

```json
{
    "attendance_rate": 87.5,
    "late_rate": 10.2,
    "absent_rate": 2.3,
    "delay_loss": 3450.00,
    "absence_loss": 1200.00,
    "total_loss": 4650.00,
    "vpm": 0.95,
    "productivity_gap": 7.89,
    "efficiency_score": 78.5,
    "heatmap": { ... }
}
```

---

## 8.7 ุงูุชุญููู ุงูุดุงูู โ `runFullAnalysis()`

**ุงูุฃูุฑ**: `php artisan sarh:analytics --date=2026-02-01`

ููู ูุฑุน ูุดุท:
1. โ ุชูููุฏ ุงูููุทุฉ ุงูููููุฉ
2. โ ูุญุต ูุฅุทูุงู ุงูุชูุจููุงุช
3. โ ุงูุชุดุงู ุงูุฃููุงุท (ุฃูุงู ุงูุฃุญุฏ ููุท โ ูุชุฌูุจ ุงูุชูุฑุงุฑ)

---

## 8.8 ุงููุฑุขุฉ ุงูุดุฎุตูุฉ โ `getPersonalMirror()`

ุนุฑุถ ุฃุฏุงุก ุงูููุธู ุงูุฐุงุชู (ูู ุจูุงุจุฉ ุงูููุธู):

```php
ุงููุชูุฌุฉ = [
    'performance_score' => 85.0,        // 60% ุญุถูุฑ + 40% ุงูุถุจุงุท
    'present_days'      => 20,
    'late_days'         => 2,
    'absent_days'       => 0,
    'total_delay'       => 25,          // ุฏูุงุฆู
    'total_loss'        => 23.68,       // ุฑ.ุณ
    'current_streak'    => 15,
    'rank_in_branch'    => 3,           // ุงูุชุฑุชูุจ
    'percentile'        => 87.5,        // ุงููุฆูู
    'motivational_message' => 'ุฃุฏุงุก ุฑุงุฆุน! ุฃูุช ูู ุฃูุถู 15% ูู ูุฑุนู!'
]
```

---

## 8.9 ุงูููุงุณ ุนู ุจูุนุฏ (Telemetry)

### TelemetryService

ูุนุงูุฌ ุจูุงูุงุช ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ ูู ุงููุงุชู:

```
POST /telemetry/push โ TelemetryService::processReading()
```

#### ุญุณุงุจ ุงุญุชูุงููุฉ ุงูุนูู

```
work_probability = 0.4 ร norm(peak_frequency) 
                 + 0.3 ร norm(variance) 
                 + 0.2 ร norm(decibel_level)
                 + 0.1 ร signature_weight
```

#### ุชุตููู ุชูููุน ุงูุญุฑูุฉ

| ุงูุชูููุน | ุงูุดุฑุท |
|---------|-------|
| `mechanical` | ุชุฑุฏุฏ ุนุงูู + ุถูุถุงุก ุนุงููุฉ + ุชุจุงูู ุนุงูู |
| `walking` | ุชุฑุฏุฏ ููุฎูุถ + ุชุจุงูู ูุชูุณุท |
| `stationary` | ูู ุงูููู ููุฎูุถุฉ |
| `suspicious` | ุฃููุงุท ูุชูุงูุถุฉ |

### AnomalyDetector โ ูุดู ุงูุดุฐูุฐ

| ุงูููุน | ุงูุดุฑุท |
|-------|-------|
| `replay_attack` | โฅ 3 ุชูููุนุงุช ูุชุทุงุจูุฉ ูู ุณุงุนุฉ ูุงุญุฏุฉ |
| `impossible_frequency` | ุชุฑุฏุฏ > 20Hz ูุบูุฑ ุงูุขูุงุช |
| `battery_drain` | ูุฌูุงุช ูุจูุฑุฉ (> 30 ุฏูููุฉ) ูู ุงูุจูุงูุงุช |

ุนูุฏ ูุดู ุดุฐูุฐ โ `AnomalyDetected` event โ `PerformanceAlert` ุชุญุฐูุฑู

### ุฅุญุตุงุฆูุงุช ุงูุนูู/ุงูุฑุงุญุฉ (WorkRestStat)

```
productivity_ratio = work_minutes รท (work_minutes + rest_minutes)
```

| ุงูุชูููู | ุงููุณุจุฉ |
|---------|--------|
| ๐ ุฐูุจู | โฅ 80% |
| โ ุนุงุฏู | โฅ 60% |
| โ๏ธ ุชุณุฑูุจ | โฅ 40% |
| ๐ด ุญุฑุฌ | < 40% |

**ุชุณุฑุจ VPM** = ุฏูุงุฆู ุงูุฑุงุญุฉ ร ุชูููุฉ ุงูุฏูููุฉ

---

> **ุงูุณุงุจู**: [ูุธุงู ุงูุญุถูุฑ](07-attendance-system.md) | **ุงูุชุงูู**: [ูุธุงู ุงูุชูุงุตู](09-communication-system.md)



================================================================================
ุงูููู: 09-communication-system.md
================================================================================

# 9. ูุธุงู ุงูุชูุงุตู

## 9.1 ูุธุฑุฉ ุนุงูุฉ

ูููุฑ ุณูุฑ ุซูุงุซ ูููุงุช ุชูุงุตู: **ุงููุญุงุฏุซุงุช ุงูููุฑูุฉ**ุ **ุงูุชุนุงููู ุงูุฑุณููุฉ**ุ ู**ุงูุฅุฐุงุนุฉ ุงูุนุงูุฉ**.

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ูููุงุช ุงูุชูุงุตู                            โ
โโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโค
โ  ุงููุญุงุฏุซุงุช       โ  ุงูุชุนุงููู        โ  ุงูุฅุฐุงุนุฉ             โ
โ  (Messaging)     โ  (Circulars)     โ  (Broadcast)         โ
โโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโค
โ ูุจุงุดุฑุฉ ุฃู ุฌูุงุนูุฉโ ุฑุณููุฉ ูุน ุฅูุฑุงุฑ   โ ุฅุดุนุงุฑุงุช ุฌูุงุนูุฉ      โ
โ Livewire         โ Filament Resourceโ Filament Page        โ
โ /messaging       โ /admin/circulars โ /admin/broadcast     โ
โ ูุณุชูู 1+        โ ุฅูุดุงุก: ูุณุชูู 5+ โ ูุณุชูู 7+            โ
โโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## 9.2 ุงููุญุงุฏุซุงุช (Conversations)

### ุงูุจููุฉ

```
conversations (1) โโ (N) conversation_participants โโ (1) users
conversations (1) โโ (N) messages โโ (1) users (sender)
```

### ุฃููุงุน ุงููุญุงุฏุซุงุช

| ุงูููุน | ุงููุตู |
|-------|-------|
| `direct` | ูุญุงุฏุซุฉ ุจูู ุดุฎุตูู |
| `group` | ูุญุงุฏุซุฉ ุฌูุงุนูุฉ |

### ููููุงุช Livewire

#### MessagingInbox โ ุตูุฏูู ุงููุงุฑุฏ
- **ุงููุณุงุฑ**: `/messaging`
- **ุงููุธููุฉ**: ุนุฑุถ ูุงุฆูุฉ ุงููุญุงุฏุซุงุช ูุน ุนุฏุฏ ุงูุฑุณุงุฆู ุบูุฑ ุงูููุฑูุกุฉ
- **ุงูุฅุฌุฑุงุกุงุช**: ูุชุญ ูุญุงุฏุซุฉุ ุฅูุดุงุก ูุญุงุฏุซุฉ ุฌุฏูุฏุฉ

#### MessagingChat โ ูุงูุฐุฉ ุงููุญุงุฏุซุฉ
- **ุงููุณุงุฑ**: `/messaging/{conversation}`
- **ุงููุธููุฉ**: ุนุฑุถ ุงูุฑุณุงุฆูุ ุฅุฑุณุงู ุฑุณุงุฆู ุฌุฏูุฏุฉ
- **ุงูุฅุฌุฑุงุกุงุช**: ุฅุฑุณุงู ูุต/ุตูุฑุฉ/ูููุ ุชุนููู ูููุฑูุก ุชููุงุฆููุง

### ุฃููุงุน ุงูุฑุณุงุฆู

| ุงูููุน | ุงููุตู |
|-------|-------|
| `text` | ูุต ุนุงุฏู |
| `image` | ุตูุฑุฉ ูุฑููุฉ |
| `file` | ููู ูุฑูู |

---

## 9.3 ุงูุชุนุงููู (Circulars)

### ุงูุฅูุดุงุก (CircularResource)

| ุงูุญูู | ุงููุตู |
|-------|-------|
| `title_ar` / `title_en` | ุงูุนููุงู |
| `body_ar` / `body_en` | ุงููุญุชูู (ูุญุฑุฑ ูุตูุต ุบูู) |
| `priority` | ุนุงุฏู / ูุฑุชูุน / ุนุงุฌู |
| `target_scope` | ูุทุงู ุงูุงุณุชูุฏุงู |
| `requires_acknowledgment` | ูุชุทูุจ ุฅูุฑุงุฑ ุจุงููุฑุงุกุฉ |
| `published_at` | ุชุงุฑูุฎ ุงููุดุฑ |
| `expires_at` | ุชุงุฑูุฎ ุงูุงูุชูุงุก |

### ูุทุงูุงุช ุงูุงุณุชูุฏุงู

| ุงููุทุงู | ุงููุตู |
|--------|-------|
| `all` | ุฌููุน ุงูููุธููู |
| `branch` | ูุฑุน ูุญุฏุฏ (`target_branch_id`) |
| `department` | ูุณู ูุญุฏุฏ (`target_department_id`) |
| `role` | ุฏูุฑ ูุญุฏุฏ (`target_role_id`) |

### ุงูุฅูุฑุงุฑ

```
circulars (1) โโ (N) circular_acknowledgments โโ (1) users
```

- ุฅุฐุง `requires_acknowledgment = true`: ูุฌุจ ุนูู ูู ููุธู ูุณุชูุฏู ุชุฃููุฏ ุงููุฑุงุกุฉ
- ููุนุฑุถ ุนุฏุฏ ุงูุฅูุฑุงุฑุงุช ูู ูุงุฆูุฉ ุงูุชุนุงููู

### ูููู Livewire

#### CircularsWidget โ ุฃุฏุงุฉ ุงูุชุนุงููู
- **ุงููููุน**: ุจูุงุจุฉ ุงูููุธู
- **ุงููุธููุฉ**: ุนุฑุถ ุงูุชุนุงููู ุงูููุฌูุฉ ููููุธู ูุน ุฒุฑ ุงูุฅูุฑุงุฑ
- **ุงูุชุตููุฉ**: ุญุณุจ ูุฑุน ููุณู ูุฏูุฑ ุงูููุธู

### ุฅุฑุณุงู ุงูุชุนููู (SendCircularJob)

```php
SendCircularJob::dispatch($circular, $userIds);
// โ ูููุดุฆ PerformanceAlert ููู ููุธู (ุฅุดุนุงุฑ ุฏุงุฎูู)
// โ ููุนุงูุฌ ุนูู ุฏูุนุงุช (100 ููุธู/ุฏูุนุฉ) ูุน ุชููู 1 ุซุงููุฉ
// โ Timeout: 120 ุซุงููุฉุ 2 ูุญุงููุงุช
```

---

## 9.4 ุงูุฅุฐุงุนุฉ (BroadcastPage)

ุตูุญุฉ Filament ูุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุฌูุงุนูุฉ:

- **ุงููุตูู**: ุงููุณุชูู 7+
- **ุงููุทุงูุงุช**: ุงููู / ูุฑุน / ูุณู
- ูููุดุฆ ุฅุดุนุงุฑุงุช `database` ููู ููุธู ูุณุชูุฏู
- ููุงุณุจ ููุฅุนูุงูุงุช ุงูุณุฑูุนุฉ ุฏูู ุงูุญุงุฌุฉ ููุชุงุจุนุฉ ุงูุฅูุฑุงุฑ

---

## 9.5 ุงูุจูุงุบุงุช ุงูุณุฑูุฉ (Whistleblower)

### ุชูุฏูู ุงูุจูุงุบ (WhistleblowerForm)

- **ุงููุณุงุฑ**: `/whistleblower`
- **ุงููุตุงุฏูุฉ**: **ูุง ุชุชุทูุจ ุชุณุฌูู ุฏุฎูู** โ ูุชุงุญุฉ ููุนููู
- **ุงูุจูุงูุงุช**:
  - ุงูุชุตููู: ูุณุงุฏุ ุชุญุฑุดุ ุณูุงูุฉุ ุงุญุชูุงู
  - ุงูุฎุทูุฑุฉ: ููุฎูุถุฉุ ูุชูุณุทุฉุ ุนุงููุฉุ ุญุฑุฌุฉ
  - ุงููุญุชูู: ููุดููุฑ ููุฑูุง ุนุจุฑ `encrypt()`
  - ุงูุฏููู: ููู ูุฑูู (ุงุฎุชูุงุฑู)
- **ุงููุชูุฌุฉ**: ุฑูู ุชุฐูุฑุฉ (`WB-YMDHIS-RAND`) + ุฑูุฒ ุชุชุจุน ูุฌููู

### ุชุชุจุน ุงูุจูุงุบ (WhistleblowerTrack)

- **ุงููุณุงุฑ**: `/whistleblower/track`
- **ุงููุตุงุฏูุฉ**: ูุง ุชุชุทูุจ
- ููุฏุฎู ุงูููุจููุบ ุฑูุฒ ุงูุชุชุจุน ุงููุฌููู
- ูุฑู ุงูุญุงูุฉ ููุท (ุฌุฏูุฏ/ููุฏ ุงูุชุญููู/ูุญููู/ูุฑููุถ) โ ูุง ูุฑู ุงููุญุชูู ุฃุจุฏูุง

### ุงูุฎุฒูุฉ ุงูุณุฑูุฉ (WhistleblowerVaultPage)

- **ุงููุตูู**: ุงููุณุชูู 10 ููุท
- ุนุฑุถ ุฌููุน ุงูุจูุงุบุงุช ูุน ูู ุงูุชุดููุฑ
- ูู ุนูููุฉ ูุชุญ ุชูุณุฌููู ูู `AuditLog`

---

> **ุงูุณุงุจู**: [ูุธุงู ุงูุชุญูููุงุช](08-analytics-system.md) | **ุงูุชุงูู**: [ูุธุงู ุงูุชุญููุฒ](10-gamification-system.md)



================================================================================
ุงูููู: 10-gamification-system.md
================================================================================

# 10. ูุธุงู ุงูุชุญููุฒ ูุงูููุงูุณุฉ

## 10.1 ูุธุฑุฉ ุนุงูุฉ

ูุนุชูุฏ ุณูุฑ ุนูู ูุธุงู ุชุญููุฒ ูุชูุงูู ูุดูู: **ุงูุดุงุฑุงุช**ุ **ุงูููุงุท**ุ **ุณูุงุณู ุงูุญุถูุฑ**ุ ู**ููุญุฉ ููุงูุณุฉ ุงููุฑูุน**.

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                    ูุธุงู ุงูุชุญููุฒ                              โ
โโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโฌโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  ุงูุดุงุฑุงุช        โ  ุงูููุงุท         โ  ุงูููุงูุณุฉ               โ
โ  (Badges)       โ  (Points)       โ  (Competition)          โ
โโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโผโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ ูุนุงููุฑ ุชููุงุฆูุฉ  โ ูุณุจ/ุฎุตู/ููุงูุฃุฉ โ ุชุฑุชูุจ ุงููุฑูุน           โ
โ ููุญ ูุฏูู       โ ูุนุงููุงุช ูุณุฌูุฉ   โ ูุณุชููุงุช ุชูุงูุณูุฉ        โ
โ ุญุฏุซ BadgeAwardedโ source morphTo  โ BranchLeaderboardPage   โ
โ ุฅุดุนุงุฑ ุชููุงุฆู   โ PerformanceAlertโ ุชุญุฏูุซ ูุญุธู             โ
โโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโดโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## 10.2 ุงูุดุงุฑุงุช (Badges)

### ุจููุฉ ุงูุดุงุฑุฉ

| ุงูุญูู | ุงููุตู |
|-------|-------|
| `name_ar` / `name_en` | ุงุณู ุงูุดุงุฑุฉ |
| `description_ar` / `description_en` | ูุตู ูุนุงููุฑ ุงูุญุตูู |
| `icon` | ุฃููููุฉ |
| `color` | ุงูููู |
| `points` | ุงูููุงุท ุงูููููุญุฉ ุนูุฏ ุงูุญุตูู |
| `criteria_type` | ููุน ุงููุนูุงุฑ (ุญุถูุฑ ูุชุชุงููุ ุฃุฏุงุกุ ูุฏูู...) |
| `criteria_value` | ูููุฉ ุงููุนูุงุฑ (ูุซูุงู: 30 ููู ูุชุชุงูู) |

### ููุญ ุงูุดุงุฑุงุช

```php
UserBadge::award($userId, $badgeSlug, $context);
// 1. ูููุดุฆ ุณุฌู user_badges
// 2. ููุทูู ุญุฏุซ BadgeAwarded
// 3. โ ุงููุณุชูุน HandleBadgePoints ูููุดุฆ PerformanceAlert (ุฅุดุนุงุฑ ุชููุฆุฉ)
```

### ุฃููุงุน ุงููุนุงููุฑ

| ุงููุนูุงุฑ | ุงููุซุงู |
|---------|--------|
| ุณูุณูุฉ ุญุถูุฑ | ุญุถูุฑ 30 ููู ูุชุชุงูู ุจุฏูู ุชุฃุฎูุฑ |
| ุนุฏุฏ ุญุถูุฑ | 100 ููู ุญุถูุฑ ุฅุฌูุงูู |
| ุฃุฏุงุก | ุฏุฑุฌุฉ ููุงุกุฉ > 90 ููุฏุฉ ุดูุฑ |
| ูุฏูู | ูููุญูุง ุงููุฏูุฑ ูุจุงุดุฑุฉ |

---

## 10.3 ุงูููุงุท (Points)

### ูุนุงููุงุช ุงูููุงุท (PointsTransaction)

| ุงูุญูู | ุงููุตู |
|-------|-------|
| `user_id` | ุงูููุธู |
| `points` | ุงูููุงุท (ููุฌุจ = ูุณุจุ ุณุงูุจ = ุฎุตู) |
| `type` | ุงูููุน: `earned` / `deducted` / `bonus` / `manual` |
| `source_type` / `source_id` | ุงููุตุฏุฑ (MorphTo โ ุดุงุฑุฉุ ุญุถูุฑุ ุชุนุฏูู...) |
| `description` | ูุตู ุงููุนุงููุฉ |

### ูุตุงุฏุฑ ุงูููุงุท

| ุงููุตุฏุฑ | ุงูููุงุท | ุงูุดุฑุท |
|--------|--------|-------|
| ุดุงุฑุฉ ููุชุณุจุฉ | ุญุณุจ ุงูุดุงุฑุฉ | ุนูุฏ ุงูุญุตูู ุนูู ุดุงุฑุฉ |
| ุญุถูุฑ ูู ุงูููุช | +1 | ุชุณุฌูู ุญุถูุฑ ุจุฏูู ุชุฃุฎูุฑ |
| ุณูุณูุฉ ุญุถูุฑ | +5 | ูู 7 ุฃูุงู ูุชุชุงููุฉ |
| ุชุนุฏูู ูุฏูู | ยฑN | ุนุจุฑ UserResource โ adjust_points |
| ุชุนุฏูู ุชูููู | ยฑN | ุนุจุฑ ScoreAdjustmentResource |

### ููุฎุต ุงูููุงุท

```php
$user->total_points  // ูุฌููุน ุงูููุงุท ุงูุญุงูู (ูุญุฏูุซ ูู ุฌุฏูู users)
```

---

## 10.4 ุณูุงุณู ุงูุญุถูุฑ (Streaks)

| ุงูุญูู | ุงููุตู |
|-------|-------|
| `current_streak` | ุนุฏุฏ ุฃูุงู ุงูุญุถูุฑ ุงููุชุชุงููุฉ (ุจุฏูู ุบูุงุจ/ุชุฃุฎูุฑ) |
| `longest_streak` | ุฃุทูู ุณูุณูุฉ ุญุถูุฑ ูุตู ุฅูููุง ุงูููุธู |

- **ุชุชุฒุงูุฏ**: ูู ููู ุญุถูุฑ `present` ุจุฏูู ุชุฃุฎูุฑ
- **ุชูุตูููุฑ**: ุนูุฏ ุฃู ุบูุงุจ ุฃู ุชุฃุฎูุฑ
- **ุชูุญุฏููุซ**: `longest_streak` ููุญุฏููุซ ุฅุฐุง `current > longest`

---

## 10.5 ุงูููุงูุณุฉ ุจูู ุงููุฑูุน (BranchLeaderboardPage)

### ุขููุฉ ุงูุชุฑุชูุจ

```
ุชุฑุชูุจ ุงููุฑูุน = ุงูุฃูู ุฎุณุงุฑุฉ ูุงููุฉ ุฅุฌูุงููุฉ
```

ููู ูุฑุน:
- ูุฌููุน `cost_per_minute ร delay_minutes` ูุฌููุน ุงูููุธููู
- ูุญุณุจ **ููู ููุธู** ูุฃู ุญุฌู ุงููุฑูุน ูุฎุชูู

### ูุณุชููุงุช ุงูููุงูุณุฉ

| ุงููุณุชูู | ุงูุฃููููุฉ | ุงูุดุฑุท |
|---------|----------|-------|
| ุฃุณุทูุฑู (Legendary) | ๐ | ุฎุณุงุฑุฉ = 0 |
| ุฃููุงุณู (Diamond) | ๐ | ุฃูู ูู 2% ูู ุงูููุฒุงููุฉ |
| ุฐูุจู (Gold) | ๐ฅ | ุฃูู ูู 5% |
| ูุถู (Silver) | ๐ฅ | ุฃูู ูู 10% |
| ุจุฑููุฒู (Bronze) | ๐ฅ | ุฃูู ูู 15% |
| ูุจุชุฏุฆ (Starter) | ๐ฑ | ุฃูุซุฑ ูู 15% |

### ุนูุงุตุฑ ุงูุนุฑุถ

- ๐ ูููุฑุน ุงูุฃูู (ุงูุฃูู ุฎุณุงุฑุฉ)
- ๐ข ูููุฑุน ุงูุฃุฎูุฑ (ุงูุฃูุซุฑ ุฎุณุงุฑุฉ)
- ุงูุชุญุฏูุซ: ุชููุงุฆู ูุน ูู ุฒูุงุฑุฉ ููุตูุญุฉ

---

## 10.6 ููููุงุช ุจูุงุจุฉ ุงูููุธู

### GamificationWidget โ ุฃุฏุงุฉ ุงูุชุญููุฒ

| ุงููุนูููุฉ | ุงููุตู |
|----------|-------|
| ุฅุฌูุงูู ุงูููุงุท | ุฑุตูุฏ ุงูููุงุท ุงูุญุงูู |
| ุงูุดุงุฑุงุช | ุงูุดุงุฑุงุช ุงูููุชุณุจุฉ ูุน ุฃููููุงุชูุง |
| ุงูุณูุณูุฉ ุงูุญุงููุฉ | ุนุฏุฏ ุฃูุงู ุงูุญุถูุฑ ุงููุชุชุงูู |
| ุงูุชุฑุชูุจ | ุชุฑุชูุจ ุงูููุธู ูู ูุฑุนู |

### CompetitionWidget โ ุฃุฏุงุฉ ุงูููุงูุณุฉ

| ุงููุนูููุฉ | ุงููุตู |
|----------|-------|
| ุงูููุงูุณุงุช ุงููุดุทุฉ | ุงููุณุงุจูุงุช ุงูุฌุงุฑูุฉ |
| ุชุฑุชูุจ ุงูููุธู | ูููุนู ูู ุงูุชุฑุชูุจ |
| ุชูุฏู ุงูููุงูุณุฉ | ุงููุณุจุฉ ุงููุฆููุฉ |
| ุญุงูุฉ ุงููุดุงุฑูุฉ | ูุดุงุฑู/ุบูุฑ ูุดุงุฑู |

### BranchProgressWidget โ ุฃุฏุงุฉ ุชูุฏู ุงููุฑุน

| ุงููุนูููุฉ | ุงููุตู |
|----------|-------|
| ูุณุจุฉ ุงูุญุถูุฑ | ูุนุฏู ุญุถูุฑ ุงููุฑุน |
| ุชุชุจุน ุงูุฎุณุงุฆุฑ | ุงูุฎุณุงุฆุฑ ุงููุชุฑุงููุฉ |
| ุฏุฑุฌุฉ ุงูููุงุกุฉ | ูุคุดุฑ ููุงุกุฉ ุงููุฑุน |
| ุชุฑุชูุจ ุงูููุธู ูู ุงููุฑุน | ูู `AnalyticsService::getPersonalMirror()` |

---

## 10.7 ุชุนุฏููุงุช ุงูุชูููู (ScoreAdjustment)

ุชุนุฏููุงุช ูุฏููุฉ ููููุงุท ูุงูููู ุงููุงููุฉ:

| ุงูุญูู | ุงููุตู |
|-------|-------|
| `scope` | ุงููุทุงู: ูุฑุน / ููุธู / ูุณู |
| `points_delta` | ุชุนุฏูู ุงูููุงุท (ยฑ) |
| `value_delta` | ุชุนุฏูู ุงููููุฉ ุงููุงููุฉ (ยฑ ุฑ.ุณ) |
| `category` | ูุฏูู / ููุงูุฃุฉ / ุนููุจุฉ / ุชุตุญูุญ |
| `reason` | ุงูุณุจุจ |

---

> **ุงูุณุงุจู**: [ูุธุงู ุงูุชูุงุตู](09-communication-system.md) | **ุงูุชุงูู**: [ูุธุงู ุงูุฅุฏุงุฑุฉ ูุงูุชุฏููู](11-management-system.md)



================================================================================
ุงูููู: 11-management-system.md
================================================================================

# 11. ูุธุงู ุงูุฅุฏุงุฑุฉ ูุงูุชุฏููู

## 11.1 ูุธุฑุฉ ุนุงูุฉ

ูููุฑ ุณูุฑ ุฃุฏูุงุช ูุชุชุจุน ุงูุนูููุงุช ุงูุญุณุงุณุฉุ ุฅุฏุงุฑุฉ ุงููุซุงุฆูุ ูุงูุชูุจููุงุช ุงูุงุณุชุจุงููุฉ.

---

## 11.2 ุณุฌู ุงูุชุฏููู (AuditLog)

### ุงูุจููุฉ

| ุงูุญูู | ุงููุตู |
|-------|-------|
| `user_id` | ุงููุณุชุฎุฏู ุงูุฐู ูููุฐ ุงูุนูููุฉ |
| `action` | ุงูุนูููุฉ (check_in, check_out, vault_access, trap_triggered...) |
| `auditable_type` | ููุน ุงููููุฐุฌ ุงููุชุฃุซุฑ (MorphTo) |
| `auditable_id` | ูุนุฑู ุงูุณุฌู ุงููุชุฃุซุฑ |
| `old_values` | JSON โ ุงูููู ุงููุฏููุฉ |
| `new_values` | JSON โ ุงูููู ุงูุฌุฏูุฏุฉ |
| `ip_address` | ุนููุงู IP |
| `user_agent` | ูุนูููุงุช ุงููุชุตูุญ/ุงูุฌูุงุฒ |

### ุงูุนูููุงุช ุงููุณุฌูุฉ ุชููุงุฆููุง

| ุงูุนูููุฉ | ุงููุตุฏุฑ |
|---------|--------|
| ุชุณุฌูู ุญุถูุฑ | `HandleAttendanceRecorded` Listener |
| ูุชุญ ุงูุฎุฒูุฉ ุงูุณุฑูุฉ | `WhistleblowerVaultPage` |
| ุชูุงุนู ูุน ูุฎ | `TrapResponseService` |
| ุชุตุนูุฏ ูุฎ | `HandleTrapTriggered` Listener |

---

## 11.3 ูุซุงุฆู ุงูููุธููู (EmployeeDocument)

### ุฃููุงุน ุงููุซุงุฆู

| ุงูููุน | ุงููุตู |
|-------|-------|
| `passport` | ุฌูุงุฒ ุณูุฑ |
| `residence` | ุฅูุงูุฉ |
| `contract` | ุนูุฏ ุนูู |
| `certificate` | ุดูุงุฏุฉ |
| `license` | ุฑุฎุตุฉ |
| `id_card` | ุจุทุงูุฉ ูููุฉ |
| `medical` | ุชูุฑูุฑ/ุดูุงุฏุฉ ุทุจูุฉ |
| `insurance` | ุชุฃููู |
| `other` | ุฃุฎุฑู |

### ุชุชุจุน ุงูุงูุชูุงุก

- **`expiry_date`**: ุชุงุฑูุฎ ุงูุชูุงุก ุงููุซููุฉ
- **`days_until_expiry`**: ุฎุงุตูุฉ ูุญุณูุจุฉ โ ุฃูุงู ูุชุจููุฉ
- **ุฃููุงู ูู ุงููุงุฌูุฉ**:
  - ๐ด ุฃุญูุฑ: ููุชููุฉ ุฃู ุชูุชูู ุฎูุงู 7 ุฃูุงู
  - ๐ก ุฃุตูุฑ: ุชูุชูู ุฎูุงู 30 ููู
  - ๐ข ุฃุฎุถุฑ: ุฃูุซุฑ ูู 30 ููู

### ูุทุงู ุงููุตูู

| ุงููุณุชูู | ุงููุทุงู |
|---------|--------|
| 10+ | ุฌููุน ูุซุงุฆู ุฌููุน ุงูููุธููู |
| 6-9 | ูุซุงุฆู ููุธูู ูุฑุนู |
| 1-5 | ูุซุงุฆูู ุงูุดุฎุตูุฉ ููุท |

---

## 11.4 ุชุฐููุฑุงุช ุงูููุธููู (EmployeeReminder)

### ุงูุจููุฉ

| ุงูุญูู | ุงููุตู |
|-------|-------|
| `user_id` | ุงูููุธู ุงููุนูู |
| `reminder_key` | ููุน ุงูุชุฐููุฑ |
| `reminder_date` | ุชุงุฑูุฎ ุงูุชุฐููุฑ |
| `notes` | ููุงุญุธุงุช ุฅุถุงููุฉ |
| `is_completed` | ุชู ุงูุฅูุฌุงุฒุ |

### ุชุตููู ุงูุงุณุชุนุฌุงู

| ุงูุญุงูุฉ | ุงูุดุฑุท | ุงูููู |
|--------|-------|-------|
| ูุชุฃุฎุฑ (overdue) | ุงูุชุงุฑูุฎ ูุถู | ๐ด ุฃุญูุฑ ูุงุจุถุฉ |
| ุนุงุฌู (urgent) | ุฎูุงู 7 ุฃูุงู | ๐ ุจุฑุชูุงูู |
| ูุงุฏู (upcoming) | ุฃูุซุฑ ูู 7 ุฃูุงู | ๐ข ุฃุฎุถุฑ |
| ููุชูู (completed) | `is_completed = true` | โ |

### ุตูุญุฉ ุฌููุน ุงูุชุฐููุฑุงุช (AllRemindersPage)

- **ุงููุตูู**: ุงููุณุชูู 10
- ุชุฑุชูุจ: ุงููุชุฃุฎุฑ ุฃููุงู โ ุงูุนุงุฌู โ ุงููุงุฏู
- **ุดุงุฑุฉ ุงูุชููู**: ุนุฏุฏ (ุงูุนุงุฌู + ุงููุชุฃุฎุฑ)

### ุฃุฏุงุฉ ุงูุชูููู (RemindersCalendarWidget)

- **ุงููุตูู**: ุงููุณุชูู 6+
- ุชุนุฑุถ ุงูุชุฐููุฑุงุช ุงูุชู ุชูุชูู ุฎูุงู 90 ููููุง (ุญุชู 50 ุชุฐููุฑ)
- ุชูุธูุฑ ุนุฏุฏ ุงูุนุงุฌู ูุงููุชุฃุฎุฑ

---

## 11.5 ุชูุจููุงุช ุงูุฃุฏุงุก (PerformanceAlert)

ูุธุงู ุฅุดุนุงุฑุงุช ุฏุงุฎูู ููุญูุฏ:

### ุฃููุงุน ุงูุชูุจููุงุช

| ุงูููุน | ุงููุตู | ุงููุตุฏุฑ |
|-------|-------|--------|
| `badge_earned` | ุดุงุฑุฉ ููุชุณุจุฉ | HandleBadgePoints |
| `circular` | ุชุนููู ุฌุฏูุฏ | SendCircularJob |
| `late_warning` | ุชุญุฐูุฑ ุชุฃุฎุฑ | ุชููุงุฆู |
| `absence_warning` | ุชุญุฐูุฑ ุบูุงุจ | ุชููุงุฆู |
| `performance_review` | ูุฑุงุฌุนุฉ ุฃุฏุงุก | ูุฏูู |

### ูุณุชููุงุช ุงูุฎุทูุฑุฉ

| ุงููุณุชูู | ุงูููู | ุงูุงุณุชุฎุฏุงู |
|---------|-------|-----------|
| `info` | ุฃุฒุฑู | ูุนูููุงุช ุนุงูุฉ |
| `success` | ุฃุฎุถุฑ | ุฅูุฌุงุฒุงุช (ุดุงุฑุงุช) |
| `warning` | ุฃุตูุฑ | ุชุญุฐูุฑุงุช |
| `danger` | ุฃุญูุฑ | ุชูุจููุงุช ุญุฑุฌุฉ |

### ุฅุฌุฑุงุกุงุช ุงููุงุฌูุฉ

- ุชุนููู ูููุฑูุก (ูุฑุฏู ูุฌูุงุนู)
- **ุดุงุฑุฉ ุงูุชููู**: ุนุฏุฏ ุงูุฅุดุนุงุฑุงุช ุบูุฑ ุงูููุฑูุกุฉ

---

## 11.6 ุฅุนุฏุงุฏุงุช ุงููุธุงู (Settings)

### ูููุฐุฌ Singleton

```php
Setting::instance()  // ููุนูุฏ/ูููุดุฆ ุงูุตู ุงููุญูุฏ
// ูุฎุฒู ูุคูุชูุง ุณุงุนุฉ ูุงุญุฏุฉ
```

### ุงูุฅุนุฏุงุฏุงุช ุงููุชุงุญุฉ

| ุงููุฌููุนุฉ | ุงูุฅุนุฏุงุฏุงุช |
|----------|-----------|
| **ุงูุชุทุจูู** | `app_name_ar`, `app_name_en`, `logo`, `favicon`, `welcome_title`, `welcome_body` |
| **PWA** | `pwa_name`, `pwa_short_name`, `pwa_theme_color`, `pwa_background_color` |
| **ููุทู ุงูุนูู** | `loss_multiplier` (ูุถุงุนู ุงูุฎุณุงุฑุฉ)ุ `default_geofence_radius`ุ `default_grace_period`ุ `overtime_multiplier` |

### ุงูุชุนุฏูู

- **ุตูุญุฉ**: `GeneralSettingsPage`
- **ุงููุตูู**: ุงููุณุชูู 10 ููุท

---

> **ุงูุณุงุจู**: [ูุธุงู ุงูุชุญููุฒ](10-gamification-system.md) | **ุงูุชุงูู**: [ูุธุงู ุงููุฎุงุฎ ุงูููุณูุฉ](12-trap-system.md)



================================================================================
ุงูููู: 12-trap-system.md
================================================================================

# 12. ูุธุงู ุงููุฎุงุฎ ุงูููุณูุฉ

## 12.1 ูุธุฑุฉ ุนุงูุฉ

ูุธุงู ุฃููู ูุฑูุฏ ูุณุชุฎุฏู **ูุฎุงุฎูุง ููุณูุฉ** ูุงูุชุดุงู ุงูุณููููุงุช ุงููุดุจููุฉ. ุงููุฎุงุฎ ุนุจุงุฑุฉ ุนู ุนูุงุตุฑ ูุงุฌูุฉ ููููุฉ (ุฃุฒุฑุงุฑุ ุฑูุงุจุทุ ุตูุญุงุช) ุชุจุฏู ูุบุฑูุฉ ููู ูุญุงูู ุงููุตูู ุบูุฑ ุงููุดุฑูุน.

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ                   ุชุฏูู ูุธุงู ุงููุฎุงุฎ                          โ
โ                                                              โ
โ   ๐ฏ ุงููุฎ ูุฒุฑูุน ูู ุงููุงุฌูุฉ (ุดุฑูุท ุฌุงูุจู/ููุญุฉ/ุฅุนุฏุงุฏุงุช)      โ
โ     โ                                                        โ
โ   ๐ค ุงููุณุชุฎุฏู ูุชูุงุนู ูุน ุงููุฎ                                โ
โ     โ                                                        โ
โ   POST /traps/trigger                                        โ
โ     โ                                                        โ
โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ               โ
โ   โ  TrapResponseService::processInteraction โ               โ
โ   โ  1. ุญุณุงุจ ุนุฏุฏ ุงูุชูุงุนูุงุช ุงูุณุงุจูุฉ           โ               โ
โ   โ  2. ุญุณุงุจ ุฏุฑุฌุฉ ุงูุฎุทุฑ (ุฃูุณูู)             โ               โ
โ   โ  3. ุชุญุฏูุฏ ุงูุฅุฌุฑุงุก (ุชุณุฌูู/ุชุญุฐูุฑ/ุชุตุนูุฏ)  โ               โ
โ   โ  4. ุญูุธ TrapInteraction                  โ               โ
โ   โ  5. ุชุณุฌูู ูู AuditLog                   โ               โ
โ   โ  6. ุฅุทูุงู TrapTriggered event           โ               โ
โ   โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ               โ
โ     โ                                                        โ
โ   ๐ ุงููุณุชุฎุฏู ูุฑู ุงุณุชุฌุงุจุฉ ููููุฉ (fake_response)             โ
โ   ๐ ุงูุฅุฏุงุฑุฉ ุชุฑู ุงูุชูุงุนู ูู ุณุฌู ุงูุชุฏููู                    โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

> โ๏ธ **ุงููุณุชูู 10 ูุนูู**: ูุง ูููุนูู ุงููุฎุงุฎ ุนูุฏ ุชูุงุนูู.

---

## 12.2 ุจููุฉ ุงููุฎ (Trap)

| ุงูุญูู | ุงููุตู | ูุซุงู |
|-------|-------|------|
| `trap_code` | ุฑูุฒ ูุฑูุฏ | `TRAP-SALARY-EXPORT` |
| `name` | ุงุณู ุงููุฎ | "ุชุตุฏูุฑ ูุดูู ุงูุฑูุงุชุจ ุงูุณุฑูุฉ" |
| `description` | ูุตู ุงูุบุฑุถ | โ |
| `trigger_type` | ููุน ุงูุชูุนูู | `button_click`, `page_visit`, `form_submit`, `data_export` |
| `risk_weight` | ูุฒู ุงูุฎุทุฑ (0.1 - 5.0) | 2.5 |
| `placement` | ูููุน ุงูุฒุฑุน | `sidebar`, `dashboard`, `settings`, `toolbar` |
| `target_levels` | JSON โ ุงููุณุชููุงุช ุงููุณุชูุฏูุฉ | `[1,2,3,4,5]` |
| `fake_response` | JSON โ ุงูุงุณุชุฌุงุจุฉ ุงูููููุฉ | `{"message": "ุฌุงุฑู ุงูุชุญููู...", "action": "redirect"}` |
| `is_active` | ูุดุทุ | true |

---

## 12.3 ูุนุงุฏูุฉ ุฏุฑุฌุฉ ุงูุฎุทุฑ

```
risk = min(100, 10 ร 2^(count - 1) ร risk_weight)
```

| ุงูุชูุงุนู # | risk_weight = 1.0 | risk_weight = 2.5 |
|-----------|-------------------|-------------------|
| 1 | 10% | 25% |
| 2 | 20% | 50% |
| 3 | 40% | 100% |
| 4 | 80% | 100% |
| 5 | 100% | 100% |

> **ุชุตุงุนุฏ ุฃูุณูู**: ูู ุชูุงุนู ูุถุงุนู ุงูุฎุทุฑ. ูุฒู ุงูุฎุทุฑ ุงูุนุงูู ููุณุฑูุน ุงููุตูู ููุฐุฑูุฉ.

---

## 12.4 ูุณุชููุงุช ุงูุฅุฌุฑุงุก

| ุฏุฑุฌุฉ ุงูุฎุทุฑ | ุงูุฅุฌุฑุงุก | ุงููุตู |
|------------|---------|-------|
| < 40% | `logged` | ุชุณุฌูู ุตุงูุช ููุท |
| 40-74% | `warned` | ุชุณุฌูู + ุชุญุฐูุฑ ูู ุงูุณุฌู |
| โฅ 75% | `escalated` | ุชุณุฌูู + ุชุตุนูุฏ + ุณุฌู CRITICAL |

### ุนูุฏ ุงูุชุตุนูุฏ (escalated)

```php
// HandleTrapTriggered Listener
Log::channel('daily')->critical('๐จ TRAP ESCALATION', [
    'user'  => $user->name_ar,
    'employee_id' => $user->employee_id,
    'trap'  => $trap->trap_code,
    'risk'  => $interaction->risk_score,
]);
```

---

## 12.5 ุงูุงุณุชุฌุงุจุฉ ุงูููููุฉ (Fake Response)

ูู ูุฎ ููุฑุฌุน ุงุณุชุฌุงุจุฉ ููููุนุฉ ูุง ูุดูู ูููุง ุงููุณุชุฎุฏู:

```json
// ูุซุงู: ูุฎ "ุชุตุฏูุฑ ุจูุงูุงุช ุงูููุธููู"
{
    "message": "ุฌุงุฑู ุชุญุถูุฑ ุงูููู...",
    "action": "loading",
    "delay": 3000
}

// ูุซุงู: ูุฎ "ุตูุญุฉ ุงูุตูุงุญูุงุช ุงููุชูุฏูุฉ"
{
    "message": "ุนุฐุฑูุงุ ูุฐู ุงูููุฒุฉ ููุฏ ุงูุตูุงูุฉ",
    "action": "error"
}
```

---

## 12.6 ุณุฌู ุงูุชูุงุนู (TrapInteraction)

| ุงูุญูู | ุงููุตู |
|-------|-------|
| `trap_id` | ุงููุฎ |
| `user_id` | ุงููุณุชุฎุฏู ุงููุชูุงุนู |
| `risk_score` | ุฏุฑุฌุฉ ุงูุฎุทุฑ (0-100%) |
| `action_taken` | ุงูุฅุฌุฑุงุก (logged/warned/escalated) |
| `interaction_count` | ุฑูู ุงูุชูุงุนู ููุฐุง ุงููุณุชุฎุฏู ูุน ูุฐุง ุงููุฎ |
| `ip_address` | ุนููุงู IP |
| `context_data` | JSON โ ุจูุงูุงุช ุฅุถุงููุฉ (User-Agent, Referrer) |

---

## 12.7 ุตูุญุฉ ุชุฏููู ุงููุฎุงุฎ (TrapAuditPage)

- **ุงููุตูู**: ุงููุณุชูู 10 ููุท
- **ุงููุนุฑูุถ**:
  - ุฅุญุตุงุฆูุงุช ุงููุฎุงุฎ: ุงูุฅุฌูุงููุ ุงููุดุทุฉุ ุงูุชูุงุนูุงุชุ ุงููุตุนูุฏุฉ
  - ุงููุณุชุฎุฏููู ุนุงููู ุงูุฎุทุฑ: ุฃุนูู 10 ุญุณุจ ุฏุฑุฌุฉ ุงูุฎุทุฑ ุงููุตูู
  - ุขุฎุฑ 20 ุชูุงุนู ูุน ุชูุงุตูู

### ุฅุญุตุงุฆูุงุช `TrapResponseService::getStatistics()`

```php
[
    'total_traps'       => 12,
    'active_traps'      => 8,
    'total_interactions' => 156,
    'escalated_count'   => 3,
    'high_risk_count'   => 7,     // risk_score โฅ 75
    'unique_users'      => 23,
    'last_24h_count'    => 5,
    'last_7d_count'     => 28
]
```

### ุงููุณุชุฎุฏููู ุนุงููู ุงูุฎุทุฑ `getHighRiskUsers()`

```php
// ุฃุนูู 10 ูุณุชุฎุฏููู ุญุณุจ max(risk_score)
[
    ['user' => 'ุฃุญูุฏ', 'max_risk' => 100, 'total_interactions' => 5, 'traps_triggered' => 3],
    ['user' => 'ูุญูุฏ', 'max_risk' => 80,  'total_interactions' => 3, 'traps_triggered' => 2],
    ...
]
```

---

## 12.8 ุฃูุซูุฉ ุนูู ูุฎุงุฎ ูุนูุงูุฉ

| ุงููุฎ | ุงููููุน | ุงูุงุณุชูุฏุงู | ุงููุตู |
|------|--------|-----------|-------|
| ุชุตุฏูุฑ ุฑูุงุชุจ VIP | ุดุฑูุท ุฌุงูุจู | ูุณุชูู 3-7 | ุฒุฑ "ุชุตุฏูุฑ ุฑูุงุชุจ ุงูุฅุฏุงุฑุฉ ุงูุนููุง" |
| ููุญุฉ ุตูุงุญูุงุช | ุงูุฅุนุฏุงุฏุงุช | ูุณุชูู 4-6 | ุฑุงุจุท "ุฅุฏุงุฑุฉ ุตูุงุญูุงุช ูุชูุฏูุฉ" |
| ุชูุฑูุฑ ูุงูู ุณุฑู | ููุญุฉ ุงููุนูููุงุช | ูุณุชูู 5-8 | ุจุทุงูุฉ "ุงูุชูุฑูุฑ ุงููุงูู ุงูุณุฑู ุงูุดูุฑู" |
| ุญุฐู ุณุฌูุงุช | ุฃุฏูุงุช | ูุณุชูู 4-9 | ุฒุฑ "ูุณุญ ุณุฌูุงุช ุงูุญุถูุฑ ุงููุฏููุฉ" |

---

> **ุงูุณุงุจู**: [ูุธุงู ุงูุฅุฏุงุฑุฉ ูุงูุชุฏููู](11-management-system.md) | **ุงูุชุงูู**: [ุงูุฃูุงูุฑ ูุงูุฎุฏูุงุช](13-commands-services.md)



================================================================================
ุงูููู: 13-commands-services.md
================================================================================

# 13. ุงูุฃูุงูุฑ ูุงูุฎุฏูุงุช ูุงูุฃุญุฏุงุซ ูุงูููุงู

## 13.1 ุฃูุงูุฑ Artisan

### `sarh:install` โ ุงูุชุซุจูุช ุงููุงูู

```bash
php artisan sarh:install
```

**ุงูุฎุทูุงุช**:
1. ุงูุชุญูู ูู ุงููุชุทูุจุงุช (PHPุ ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ุงูุชุฎุฒูู)
2. ุชูููุฐ ุงููุฌุฑุงุช (`migrate`)
3. ุจุฐุฑ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ (ุฃุฏูุงุฑุ ุดุงุฑุงุชุ ูุฎุงุฎ)
4. ุฅูุดุงุก ูุฏูุฑ ุฃุนูู (ุงููุณุชูู 10) โ ุชูุงุนูู
5. ุฑุจุท ุงูุชุฎุฒูู (`storage:link`)
6. ุชุฎุฒูู ุงูุฅุนุฏุงุฏุงุช ูุคูุชูุง ูู ุงูุฅูุชุงุฌ

---

### `sarh:analytics` โ ุงูุชุญูููุงุช ุงูููููุฉ

```bash
php artisan sarh:analytics --date=2026-02-01
```

**ูุง ููุนูู**: ูููููุฐ `AnalyticsService::runFullAnalysis()`:
- ูููููุฏ ููุทุฉ ููููุฉ ููู ูุฑุน ูุดุท
- ููุญุต ูููุทูู ุงูุชูุจููุงุช
- ููุชุดู ุงูุฃููุงุท (ุฃูุงู ุงูุฃุญุฏ ููุท)
- ููุนุฑุถ ุฌุฏูู ูุชุงุฆุฌ ูู ุงูุทุฑููุฉ

---

### `sarh:payroll` โ ุชูููุฏ ูุดูู ุงูุฑูุงุชุจ

```bash
php artisan sarh:payroll --period=2026-02 --branch=1
```

**ูุง ููุนูู**:
- ูููุดุฆ ูุดู ุฑุงุชุจ ููู ููุธู ูุดุท
- ููุฌููุน ุจูุงูุงุช ุงูุญุถูุฑ ูู `attendance_logs`
- ูุญุณุจ ุงูุฎุตููุงุช ูุงูุฅุถุงูุงุช
- ุงูุงูุชุฑุงุถู: ุงูุดูุฑ ุงูุณุงุจู

---

### `telemetry:daily-stats` โ ุฅุญุตุงุฆูุงุช ุงูููุงุณ ุนู ุจุนุฏ

```bash
php artisan telemetry:daily-stats --date=2026-02-01 --user=5
```

**ูุง ููุนูู**:
- ููุดุบูู `TelemetryService::calculateDailyStats()` ูุฌููุน ุงูููุธููู ุงููุดุทูู
- ุฃู ูููุธู ูุญุฏุฏ (`--user`)
- ููุจููุบ ุนู ุงูููุธููู ุจุชูููู "ุญุฑุฌ" ุฃู "ุชุณุฑูุจ"

---

### `sarh:auto-document` โ ุงูุชูุซูู ุงูุชููุงุฆู

```bash
php artisan sarh:auto-document --watch
```

**ูุง ููุนูู**:
- ููุณุญ ุงูููุงุฐุฌุ ุงููุชุญููุงุชุ ุงูุฎุฏูุงุชุ ููุงุฑุฏ Filamentุ ุงููุฌุฑุงุชุ ุงููุณุงุฑุงุช
- ูููููุฏ ูููุงุช Markdown ูู ูุฌูุฏ `docs/`
- `--watch`: ูุฑุงูุจ ุงูุชุบููุฑุงุช ููุนูุฏ ุงูุชูููุฏ ุชููุงุฆููุง

---

## 13.2 ุงูุฎุฏูุงุช (Services)

| ุงูุฎุฏูุฉ | ุงูููู | ุงููุตู |
|--------|-------|-------|
| **AttendanceService** | `Services/AttendanceService.php` | ุชุณุฌูู ุงูุญุถูุฑ/ุงูุงูุตุฑุงูุ ุงูุญุถูุฑ ุบูุฑ ุงููุชุฒุงูู |
| **GeofencingService** | `Services/GeofencingService.php` | ุงูุชุญูู ูู ุงููููุน ุงูุฌุบุฑุงูู (Haversine) |
| **AnalyticsService** | `Services/AnalyticsService.php` | ุงูุชุญูููุงุช ุงูุดุงููุฉ (889 ุณุทุฑ) |
| **FinancialReportingService** | `Services/FinancialReportingService.php` | ุงูุชูุงุฑูุฑ ุงููุงููุฉ ูุงูุชููุนุงุช |
| **FormulaEngineService** | `Services/FormulaEngineService.php` | ูุญุฑู ุงููุนุงุฏูุงุช ุงููุฎุตุตุฉ |
| **TrapResponseService** | `Services/TrapResponseService.php` | ูุนุงูุฌุฉ ุชูุงุนูุงุช ุงููุฎุงุฎ |
| **TelemetryService** | `Services/TelemetryService.php` | ูุนุงูุฌุฉ ุจูุงูุงุช ุฃุฌูุฒุฉ ุงูุงุณุชุดุนุงุฑ |
| **AnomalyDetector** | `Services/AnomalyDetector.php` | ูุดู ุงูุดุฐูุฐ ูู ุจูุงูุงุช ุงูููุงุณ |

### ููุฎุต ููู ุฎุฏูุฉ

#### AttendanceService
- **ุงูุชุจุนูุฉ**: `GeofencingService` (ุนุจุฑ Constructor Injection)
- `checkIn()` โ ุชุณุฌูู ุญุถูุฑ ูุงูู ูุน ุณูุงุฌ ูุชูููู ููุงููุฉ
- `checkOut()` โ ุชุณุฌูู ุงูุตุฑุงู ูุน ุญุณุงุจ ุงูุฅุถุงูู ูุงููุบุงุฏุฑุฉ ุงููุจูุฑุฉ
- `queueCheckIn()` โ ุญุถูุฑ ุบูุฑ ูุชุฒุงูู ุนุจุฑ `ProcessAttendanceJob`
- `calculateDelayCost()` โ ุบูุงู ูุญุณุงุจ ุชูููุฉ ุงูุชุฃุฎูุฑ

#### GeofencingService
- `validatePosition()` โ ูุญุต ุงููููุน ุถุฏ ุณูุงุฌ ุงููุฑุน
- `haversineDistance()` โ ุญุณุงุจ ุงููุณุงูุฉ ุจูู ููุทุชูู (static)

#### AnalyticsService
- 14 method ุนุงูุฉ โ ุชูุตูููุง ูู [ูุซููุฉ ุงูุชุญูููุงุช](08-analytics-system.md)

#### FinancialReportingService
- 4 methods ูุน ุชุฎุฒูู ูุคูุช 5 ุฏูุงุฆู โ ุชูุตูููุง ูู [ูุซููุฉ ุงููุงููุฉ](06-financial-system.md)

#### FormulaEngineService
- `evaluateForUser()` โ ุชูููู ูุนุงุฏูุฉ ูููุธู ูุญุฏุฏ
- `evaluateForBranch()` โ ุชูููู ูุนุงุฏูุฉ ูุฌููุน ููุธูู ูุฑุน
- `resolveVariablesForUser()` โ ุชุญููู 13 ูุชุบูุฑูุง ุฅูู ููู ุญููููุฉ
- `getAvailableVariables()` โ ูุงุฆูุฉ ุงููุชุบูุฑุงุช ุงููุชุงุญุฉ (ุซูุงุฆูุฉ ุงููุบุฉ)

#### TrapResponseService
- `processInteraction()` โ ูุนุงูุฌุฉ ุชูุงุนู ูุฎ ูุน ุญุณุงุจ ุฃูุณูู ููุฎุทุฑ
- `getFakeResponse()` โ ุฅุฑุฌุงุน ุงูุงุณุชุฌุงุจุฉ ุงูููููุฉ
- `getHighRiskUsers()` โ ุฃุนูู ุงููุณุชุฎุฏููู ุฎุทุฑูุง
- `getStatistics()` โ ุฅุญุตุงุฆูุงุช ุดุงููุฉ ูููุฎุงุฎ

#### TelemetryService
- **ุงูุชุจุนูุฉ**: `AnomalyDetector`
- `processReading()` โ ูุนุงูุฌุฉ ูุฑุงุกุฉ ุงุณุชุดุนุงุฑ + ูุดู ุดุฐูุฐ
- `calculateWorkProbability()` โ ุงุญุชูุงููุฉ ุงูุนูู (0-1)
- `classifyMotionSignature()` โ ุชุตููู ุงูุญุฑูุฉ
- `calculateDailyStats()` โ ุฅุญุตุงุฆูุงุช ููููุฉ ุนูู/ุฑุงุญุฉ

#### AnomalyDetector
- `analyze()` โ ูุดู 3 ุฃููุงุน ุดุฐูุฐ: replay attackุ ุชุฑุฏุฏ ูุณุชุญููุ ุงุณุชูุฒุงู ุจุทุงุฑูุฉ

---

## 13.3 ุงูุฃุญุฏุงุซ (Events) ูุงููุณุชูุนูู (Listeners)

```
BadgeAwarded โโโโโโโ HandleBadgePoints
                     โ ูููุดุฆ PerformanceAlert (ุชููุฆุฉ)

AttendanceRecorded โโ HandleAttendanceRecorded
                     โ ูููุดุฆ AuditLog (ุชุณุฌูู ุญุถูุฑ)

AnomalyDetected โโโโ HandleAnomalyDetected
                     โ ูููุดุฆ PerformanceAlert (ุชุญุฐูุฑ ุดุฐูุฐ)

TrapTriggered โโโโโโ HandleTrapTriggered
                     โ ุชุณุฌูู ูู ุงูุณุฌู ุงููููู
                     โ ุนูุฏ escalated: ุณุฌู CRITICAL
```

### ุชุณุฌูู ุงูุฃุญุฏุงุซ (AppServiceProvider)

```php
Event::listen(BadgeAwarded::class, HandleBadgePoints::class);
Event::listen(AttendanceRecorded::class, HandleAttendanceRecorded::class);
Event::listen(AnomalyDetected::class, HandleAnomalyDetected::class);
Event::listen(TrapTriggered::class, HandleTrapTriggered::class);
```

---

## 13.4 ุงูููุงู ุงูุฎูููุฉ (Jobs)

### ProcessAttendanceJob
- **ุงููุนุงููุงุช**: `User, $lat, $lng, $ip?, $device?`
- **ุงููุธููุฉ**: ุชุณุฌูู ุญุถูุฑ ูุงูู ูู ุงูุฎูููุฉ
- **ุงูุฅุนุฏุงุฏุงุช**: timeout 30 ุซุงููุฉุ 3 ูุญุงููุงุช

### RecalculateMonthlyAttendanceJob
- **ุงููุนุงููุงุช**: `$scope ('branch'/'user'/'all'), $scopeId, $triggeredBy`
- **ุงููุธููุฉ**: ุฅุนุงุฏุฉ ุชูููู ุญุงูุงุช ุงูุญุถูุฑ ูุฅุนุงุฏุฉ ุญุณุงุจ ุงููุงููุฉ ููู ุณุฌูุงุช ุงูุดูุฑ ุงูุญุงูู
- **ุงูุงุณุชุฎุฏุงู**: ุนูุฏ ุชุบููุฑ ุฅุนุฏุงุฏุงุช ุงููุฑุฏูุฉ ุฃู ุงูุฑุงุชุจ
- **ุงูุฅุนุฏุงุฏุงุช**: timeout 300 ุซุงููุฉุ 3 ูุญุงููุงุช
- **ูุตูุน**: `RecalculateMonthlyAttendanceJob::forMonth($period, $scope, $scopeId, $by)`

### SendCircularJob
- **ุงููุนุงููุงุช**: `Circular, $userIds[]`
- **ุงููุธููุฉ**: ุฅุฑุณุงู ุชุนููู ูุฅุดุนุงุฑุงุช `PerformanceAlert`
- **ุงููุนุงูุฌุฉ**: ุฏูุนุงุช ูู 100 ูุน ุชููู 1 ุซุงููุฉ
- **ุงูุฅุนุฏุงุฏุงุช**: timeout 120 ุซุงููุฉุ 2 ูุญุงููุงุช

---

## 13.5 ุงูุฌุฏูู ุงูุฒููู ุงูููุชุฑุญ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  ุงูุฃูุฑ                    โ ุงูุชูุฑุงุฑ ุงูููุชุฑุญ             โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโค
โ  sarh:analytics           โ ูููููุง ุงูุณุงุนุฉ 23:00        โ
โ  sarh:payroll             โ ุฃูู ูู ุดูุฑ                 โ
โ  telemetry:daily-stats    โ ูููููุง ุงูุณุงุนุฉ 23:30        โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

```php
// Console/Kernel.php ุฃู routes/console.php
Schedule::command('sarh:analytics')->dailyAt('23:00');
Schedule::command('telemetry:daily-stats')->dailyAt('23:30');
Schedule::command('sarh:payroll')->monthlyOn(1, '02:00');
```

---

> **ุงูุณุงุจู**: [ูุธุงู ุงููุฎุงุฎ ุงูููุณูุฉ](12-trap-system.md) | **ุงูุชุงูู**: [ุงูุชุตููู ูุงููุงุฌูุฉ](14-ui-design.md)



================================================================================
ุงูููู: 14-ui-design.md
================================================================================

# 14. ุงูุชุตููู ูุงููุงุฌูุฉ

## 14.1 ุงููููุฉ ุงูุจุตุฑูุฉ

### ุงูุฃููุงู ุงูุฑุฆูุณูุฉ

| ุงูููู | ุงูููุฏ | ุงูุงุณุชุฎุฏุงู |
|-------|-------|-----------|
| **ูุญูู ุฏุงูู** (Navy) | `#1a2332` | ุงูุฎูููุงุช ุงูุฑุฆูุณูุฉ |
| **ุฐูุจู** (Gold) | `#d4af37` | ุงูุนูุงุตุฑ ุงููููุฒุฉ ูุงูุดุนุงุฑุงุช |
| **ุฃุจูุถ** | `#ffffff` | ุงููุตูุต ุนูู ุงูุฎูููุฉ ุงูุฏุงููุฉ |
| **ุฃุญูุฑ** | `#ef4444` | ุงูุชูุจููุงุช ูุงูุฎุณุงุฆุฑ |
| **ุฃุฎุถุฑ** | `#22c55e` | ุงููุฌุงุญุงุช ูุงูุฃุฑุจุงุญ |

### ุงูููุท ุงูุจุตุฑู

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ  Glassmorphic Design                     โ
โ  โโโโโโโโโโโโโโโโโ                       โ
โ  โข ุฎูููุงุช ุดุจู ุดูุงูุฉ (backdrop-blur)     โ
โ  โข ุญูุงู ูุงุนูุฉ (rounded-xl)              โ
โ  โข ุธูุงู ูุชุนุฏุฏุฉ ุงูุทุจูุงุช                   โ
โ  โข ุชุฏุฑุฌุงุช ููููุฉ ุฏูููุฉ                    โ
โ  โข ุฃููููุงุช Heroicons                     โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

---

## 14.2 ุงูุชุตููู ุงููุชุฌุงูุจ (Mobile-First)

### ูููู Filament

ุณูุฑ ูุณุชุฎุฏู ุชุฎุทูุทุงุช Filament ุงููุชุฌุงูุจุฉ:

| ุงููููู | ุณุทุญ ููุชุจ | ููุจุงูู |
|--------|----------|--------|
| ุงูุฌุฏุงูู | ุฃุนูุฏุฉ ูุงููุฉ | Stack/Split ูุน ุฃุนูุฏุฉ ูุงุจูุฉ ููุทู |
| ุงูููุงุฐุฌ | ุฃุนูุฏุฉ ูุชุนุฏุฏุฉ | ุนููุฏ ูุงุญุฏ |
| ููุญุฉ ุงููุนูููุงุช | ุดุจูุฉ ุฃุฏูุงุช | ุชูุฏูุณ ุนููุฏู |
| ุงูุดุฑูุท ุงูุฌุงูุจู | ุธุงูุฑ | ูุงุฆูุฉ ููุฒููุฉ |

### ุฃูุซูุฉ ูู ุงูููุฏ

```php
// AttendanceLogResource โ ุชุฎุทูุท ูุชุฌุงูุจ
Tables\Columns\Layout\Split::make([
    Tables\Columns\Layout\Stack::make([
        TextColumn::make('attendance_date'),
        TextColumn::make('user.name_ar')->weight(FontWeight::Bold),
    ]),
    TextColumn::make('status')->badge(),
])->from('md') // ูุชุญูู ูู Stack ุฅูู Split ุจุฏุกูุง ูู ุงูุดุงุดุงุช ุงููุชูุณุทุฉ
```

---

## 14.3 PWA (ุชุทุจูู ููุจ ุชูุฏูู)

### ุงูุฅุนุฏุงุฏ

ุจูุงุจุฉ ุงูููุธู (`/app` ู `/dashboard`) ุชุนูู ูู PWA:

| ุงูุฅุนุฏุงุฏ | ุงููุตุฏุฑ |
|---------|--------|
| `manifest.json` | ูููููุฏ ุฏููุงูููููุง ูู `Setting::instance()` |
| `sw.js` | Service Worker ููุนูู ุจุฏูู ุงุชุตุงู |
| ุงูุฃููููุงุช | ูู ุฅุนุฏุงุฏุงุช ุงููุธุงู |

### manifest.json (ุฏููุงูููู)

```json
{
    "name": "ุณูุฑ โ ุจูุงุจุฉ ุงูููุธู",
    "short_name": "ุณูุฑ",
    "start_url": "/dashboard",
    "display": "standalone",
    "theme_color": "#1a2332",
    "background_color": "#0f172a",
    "icons": [...]
}
```

### ูุณุงุฑ ุงูุฎุฏูุฉ

```
GET /manifest.json โ routes/web.php โ Setting::instance() โ JSON
GET /sw.js โ routes/web.php โ Service Worker ุซุงุจุช
```

---

## 14.4 ุฏุนู RTL (ูู ุงููููู ูููุณุงุฑ)

### ุงูุฅุนุฏุงุฏ ุงูุชููุงุฆู

- **ุงููุบุฉ ุงูุงูุชุฑุงุถูุฉ**: ุงูุนุฑุจูุฉ (`locale = 'ar'`)
- **ุงุชุฌุงู ุงููุต**: RTL ุชููุงุฆู ุนุจุฑ Filament
- **ุงูุฎุทูุท**: ุฎุทูุท ุนุฑุจูุฉ ูุชูุงููุฉ

### ูููุงุช ุงูุชุฑุฌูุฉ

```
lang/
โโโ ar/               # ุงูุนุฑุจูุฉ (ุงูุงูุชุฑุงุถูุฉ)
โ   โโโ attendance.php
โ   โโโ branches.php
โ   โโโ circulars.php
โ   โโโ holidays.php
โ   โโโ leaves.php
โ   โโโ payroll.php
โ   โโโ users.php
โโโ en/               # ุงูุฅูุฌููุฒูุฉ
    โโโ (ููุณ ุงููููุงุช)
```

### ุงุณุชุฎุฏุงู ุงูุชุฑุฌูุฉ

```php
// ูู Filament Resources
TextColumn::make('status')
    ->label(__('attendance.status'))
    ->badge();

// ูู Blade
{{ __('attendance.check_in_success') }}

// ููุฌูู Blade ูุฎุตุต
@arNum(1234)  // โ ูกูขูฃูค
```

---

## 14.5 ููููุงุช Livewire (ุจูุงุจุฉ ุงูููุธู)

### ูููู ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ

```
/dashboard (EmployeeDashboard)
โโโ EmployeeWelcomeWidget โ ุชุฑุญูุจ ุดุฎุตู
โ   โโโ ุชุญูุฉ ุญุณุจ ุงูููุช (ุตุจุงุญ ุงูุฎูุฑ/ูุณุงุก ุงูุฎูุฑ...)
โ   โโโ ุงุณู ุงูููุธู ุจุงูุนุฑุจูุฉ
โ   โโโ ุงูุชุงุฑูุฎ ุงูููุณูู
โ   โโโ ุญุงูุฉ ุงูุญุถูุฑ ุงูููู
โ
โโโ PersonalMirrorWidget โ ูุฑุขุฉ ุงูุฃุฏุงุก
โ   โโโ ุฏุฑุฌุฉ ุงูุฃุฏุงุก
โ   โโโ ุฅุญุตุงุฆูุงุช ุงูุญุถูุฑ
โ   โโโ ุงูุณูุณูุฉ ูุงูุชุฑุชูุจ
โ   โโโ ุฑุณุงูุฉ ุชุญููุฒูุฉ
โ
โโโ AttendanceWidget โ ุชุณุฌูู ุงูุญุถูุฑ
โ   โโโ ุฒุฑ GPS โ check-in/check-out
โ   โโโ ุนุฑุถ ุญุงูุฉ ุงูุณูุงุฌ ุงูุฌุบุฑุงูู
โ   โโโ ุฑุงุจุท ุงูุจูุงุบุงุช ุงูุณุฑูุฉ
โ
โโโ AttendanceStatsWidget โ ุฅุญุตุงุฆูุงุช ุงูุญุถูุฑ
โโโ BranchProgressWidget โ ุชูุฏู ุงููุฑุน
โโโ FinancialWidget โ ุงูุฃุซุฑ ุงููุงูู ุงูุดุฎุตู
โโโ GamificationWidget โ ุงูููุงุท ูุงูุดุงุฑุงุช
โโโ CompetitionWidget โ ุงูููุงูุณุฉ
โโโ CircularsWidget โ ุงูุชุนุงููู
```

### ุตูุญุงุช ุฅุถุงููุฉ

```
/messaging โ MessagingInbox
/messaging/{id} โ MessagingChat
/whistleblower โ WhistleblowerForm (ุจุฏูู ุชุณุฌูู ุฏุฎูู)
/whistleblower/track โ WhistleblowerTrack (ุจุฏูู ุชุณุฌูู ุฏุฎูู)
```

---

## 14.6 Tailwind CSS

### ุงูุฅุนุฏุงุฏ

```javascript
// tailwind.config.js
module.exports = {
    content: [
        './resources/**/*.blade.php',
        './app/Filament/**/*.php',
        './app/Livewire/**/*.php',
    ],
    // ...
}
```

### ุงูุจูุงุก

```bash
npm run build    # ุฅูุชุงุฌ
npm run dev      # ุชุทููุฑ ูุน ูุฑุงูุจุฉ
```

---

## 14.7 ุงูุฃููููุงุช ูุงููุคุดุฑุงุช ุงูุจุตุฑูุฉ

### ุฃููุงุท ุงูุดุงุฑุงุช (Badges) ูู ุงูุฌุฏุงูู

| ุงูููู | ุงูุงุณุชุฎุฏุงู |
|-------|-----------|
| `success` (ุฃุฎุถุฑ) | ุญุงุถุฑุ ูุนุชูุฏุ ููุชูู |
| `warning` (ุฃุตูุฑ) | ูุชุฃุฎุฑุ ูุนูููุ ุนุงุฌู |
| `danger` (ุฃุญูุฑ) | ุบุงุฆุจุ ูุฑููุถุ ุญุฑุฌ |
| `info` (ุฃุฒุฑู) | ูุนูููุงุชูุ ุฌุฏูุฏ |
| `primary` (ูุญูู) | ุงูุชุฑุงุถูุ ูุธุงูู |

### ุงููุคุดุฑุงุช ุงููุญุธูุฉ

| ุงููุคุดุฑ | ุงููุตู |
|--------|-------|
| ๐ | ุงููุฑุน ุงูุฃูู ูู ุงูููุงูุณุฉ |
| ๐ข | ุงููุฑุน ุงูุฃุฎูุฑ |
| ๐ | ุดุงุฑุฉ ูุงุจุถุฉ โ ุชูุจูู ุนุงุฌู |
| โก | ุชุญุฏูุซ ุชููุงุฆู (Poll) |

---

> **ุงูุณุงุจู**: [ุงูุฃูุงูุฑ ูุงูุฎุฏูุงุช](13-commands-services.md) | **ุงูุชุงูู**: [ุงููุดุฑ ูุงูุชุดุบูู](15-deployment.md)



================================================================================
ุงูููู: 15-deployment.md
================================================================================

# 15. ุงููุดุฑ ูุงูุชุดุบูู

## 15.1 ุจูุฆุฉ ุงูุฅูุชุงุฌ

| ุงููุนูููุฉ | ุงููููุฉ |
|----------|--------|
| **ุงูุงุณุชุถุงูุฉ** | Hostinger (ุงุณุชุถุงูุฉ ูุดุชุฑูุฉ) |
| **ุงููุทุงู** | sarh.online |
| **SSH** | `ssh -p 65002 u850419603@145.223.119.139` |
| **ูุณุงุฑ ุงููุดุฑูุน** | `/home/u850419603/sarh` |
| **ูุณุงุฑ ุงููุทุงู** | `/home/u850419603/domains/sarh.online/public_html` |
| **ุงููุณุชูุฏุน** | GitHub (ุฎุงุต) |

---

## 15.2 ูููู ุงููุดุฑ ุนูู Hostinger

```
/home/u850419603/
โโโ sarh/                           โ ูุดุฑูุน Laravel ูุงูู
โ   โโโ app/
โ   โโโ bootstrap/
โ   โโโ config/
โ   โโโ database/
โ   โโโ public/                     โ public ูุญูู (ููุชุทููุฑ)
โ   โโโ resources/
โ   โโโ routes/
โ   โโโ storage/
โ   โโโ vendor/
โ
โโโ domains/sarh.online/
    โโโ public_html/                โ ูุง ูุฑุงู ุงูุฒุงุฆุฑ
        โโโ index.php               โ ุฌุณุฑ ุจูุณุงุฑุงุช ูุทููุฉ
        โโโ .htaccess
        โโโ build/                  โ Vite assets
        โโโ css/ & js/
        โโโ storage โ symlink
```

> **ููู**: `public_html/index.php` ูุณุชุฎุฏู ูุณุงุฑุงุช **ูุทููุฉ** ููุฑุจุท ุจุงููุดุฑูุนุ ูููุณ `__DIR__` ุงููุณุจูุฉ.

---

## 15.3 ุณูุฑูุจุช ุงููุดุฑ (deploy.sh)

### ุงูุฃูุฑ

```bash
bash deploy.sh
```

### ุงูุฎุทูุงุช (9 ูุฑุงุญู)

| # | ุงูุฎุทูุฉ | ุงููุตู |
|---|--------|-------|
| 0 | Clone/Pull | ุฃูู ูุฑุฉ: cloneุ ุจุนุฏูุง: `git reset --hard origin/main` |
| 1 | Composer | `composer install --optimize-autoloader --no-interaction` |
| 2 | .env | ูุณุฎ `.env.production` ูุชูููุฏ `APP_KEY` |
| 2.5 | Session | ูุฑุถ ุจุฑูุชูููู ุงูุฌูุณุฉ ุงูููุญุตูู |
| 3 | Migrate+Seed | `php artisan migrate --force --seed` |
| 4 | Frontend | `npm install && npm run build` |
| 5 | Storage | ุฑุงุจุท ุฑูุฒู `storage/app/public` |
| 6 | Deploy | ูุณุฎ public ุฅูู `public_html` + ุฅูุดุงุก ุฌุณุฑ `index.php` |
| 7 | Cache Clear | `optimize:clear` + ูุณุญ ุงูุฌูุณุงุช ุงููุฏููุฉ |
| 8 | Optimize | `config:cache` + `event:cache` |

### ุจุฑูุชูููู ุงูุฌูุณุฉ ุงูููุญุตูู

```bash
SESSION_DRIVER=file
SESSION_ENCRYPT=false
SESSION_DOMAIN=null        # ูุดู ุชููุงุฆู
SESSION_SECURE_COOKIE=true # HTTPS ููุท
SESSION_SAME_SITE=lax
SESSION_LIFETIME=120
```

> โ๏ธ **route:cache ูุญุธูุฑ** โ ููุณุฑ ูุณุงุฑุงุช Filament v3 ุงููุงุฆูุฉ ุนูู Closures.

---

## 15.4 ุฅุนุฏุงุฏ .env ููุฅูุชุงุฌ

```env
APP_NAME="ูุคุดุฑ ุตุฑุญ"
APP_ENV=production
APP_DEBUG=false
APP_URL=https://sarh.online

DB_CONNECTION=mysql
DB_HOST=127.0.0.1
DB_PORT=3306
DB_DATABASE=sarh_db
DB_USERNAME=u850419603_sarh
DB_PASSWORD=*****

SESSION_DRIVER=file
SESSION_SECURE_COOKIE=true

MAIL_MAILER=smtp
# ...

QUEUE_CONNECTION=sync    # ุงูุงุณุชุถุงูุฉ ุงููุดุชุฑูุฉ ูุง ุชุฏุนู workers
```

### ููุงุญุธุงุช ุงูุฅูุชุงุฌ

| ุงูุฅุนุฏุงุฏ | ุงููููุฉ | ุงูุณุจุจ |
|---------|--------|-------|
| `APP_DEBUG` | `false` | ููุน ุชุณุฑูุจ ูุนูููุงุช ุญุณุงุณุฉ |
| `QUEUE_CONNECTION` | `sync` | ูุง ููุฌุฏ supervisor ุนูู ุงูุงุณุชุถุงูุฉ ุงููุดุชุฑูุฉ |
| `SESSION_DRIVER` | `file` | ุฃุจุณุท ูุฃููุซู ุนูู ุงูุงุณุชุถุงูุฉ ุงููุดุชุฑูุฉ |
| `CACHE_STORE` | `file` | ูุง ููุฌุฏ Redis |

---

## 15.5 ุงููุดุฑ ุงูุณุฑูุน (deploy-quick.sh)

```bash
bash deploy-quick.sh
```

ูุณุฎุฉ ูุฎุชุตุฑุฉ: pull + optimize ููุท (ุจุฏูู composer ุฃู npm).

---

## 15.6 ุฅุนุฏุงุฏ SSH

```bash
bash setup-ssh-key.sh
```

ูููุดุฆ ููุชุงุญ SSH ูููุถููู ูููุณุชูุฏุน. ุงูุชูุงุตูู ูู [SSH_SETUP.md](../SSH_SETUP.md).

---

## 15.7 ุจุนุฏ ุงููุดุฑ

### 1. ุฅูุดุงุก ุงููุฏูุฑ ุงูุฃุนูู

```bash
php artisan sarh:install
# โ ูููุดุฆ ุญุณุงุจ ุงููุณุชูู 10 ุชูุงุนูููุง
```

### 2. ุจุฐุฑ ุงูุจูุงูุงุช ุงูุฃุณุงุณูุฉ

```bash
php artisan db:seed
# โ RoleSeeder: ุฃุฏูุงุฑ (ูุฏูุฑ ุนุงูุ ูุดุฑูุ ููุธู...)
# โ BadgeSeeder: ุดุงุฑุงุช ุฃุณุงุณูุฉ
# โ TrapSeeder: ูุฎุงุฎ ุงูุชุฑุงุถูุฉ
```

### 3. ุฌุฏููุฉ ุงูุฃูุงูุฑ

```bash
# ุฃุถู ูู Hostinger Cron Jobs:
* * * * * cd /home/u850419603/sarh && php artisan schedule:run >> /dev/null 2>&1
```

### 4. ุงูุชุญูู

| ุงููุญุต | ุงูุฃูุฑ/ุงูุฑุงุจุท |
|-------|-------------|
| ุงููููุน | `https://sarh.online` |
| ููุญุฉ ุงูุฅุฏุงุฑุฉ | `https://sarh.online/admin` |
| ุจูุงุจุฉ ุงูููุธู | `https://sarh.online/app` |
| ุงูุจูุงุบุงุช ุงูุณุฑูุฉ | `https://sarh.online/whistleblower` |
| ุชูุซูู API | `https://sarh.online/docs/api` |

---

## 15.8 ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุฎุทุฃ 500

```bash
# 1. ูุญุต ุงูุณุฌูุงุช
tail -50 /home/u850419603/sarh/storage/logs/laravel.log

# 2. ูุณุญ ุงููุงุด
php artisan optimize:clear
php artisan config:cache
```

### ุฎุทุฃ ูู ุงูุฌูุณุงุช (Session)

```bash
rm -f storage/framework/sessions/*
php artisan config:cache
```

### ุตูุญุฉ ุจูุถุงุก

```bash
# ุงูุชุญูู ูู ุตูุงุญูุงุช storage
chmod -R 775 storage bootstrap/cache
```

### ุฃุฎุทุงุก Livewire/Filament

```bash
# ูุณุญ views ุงููุฎุฒูุฉ ูุคูุชูุง
php artisan view:clear
php artisan filament:cache-components
```

---

> **ุงูุณุงุจู**: [ุงูุชุตููู ูุงููุงุฌูุฉ](14-ui-design.md) | **ุงูุชุงูู**: [ุฏููู ุงูุชุทููุฑ](16-development-guide.md)



================================================================================
ุงูููู: 16-development-guide.md
================================================================================

# 16. ุฏููู ุงูุชุทููุฑ

## 16.1 ุฅุนุฏุงุฏ ุจูุฆุฉ ุงูุชุทููุฑ ุงููุญููุฉ

### ุงููุชุทูุจุงุช

| ุงููุชุทูุจ | ุงูุญุฏ ุงูุฃุฏูู |
|---------|-------------|
| PHP | 8.2+ ูุน ุฅุถุงูุงุช: mbstring, xml, curl, mysql, gd, zip |
| Composer | 2.x |
| Node.js | 18+ (ูุน npm) |
| MySQL/MariaDB | 8.0+ / 10.6+ |
| Git | 2.x |

### ุงูุฎุทูุงุช

```bash
# 1. ุงุณุชูุณุงุฎ ุงููุณุชูุฏุน
git clone <repo-url> sarh
cd sarh

# 2. ุชุซุจูุช ุงูุชุจุนูุงุช
composer install
npm install

# 3. ุฅุนุฏุงุฏ ุงูุจูุฆุฉ
cp .env.example .env
php artisan key:generate

# 4. ุฅุนุฏุงุฏ ูุงุนุฏุฉ ุงูุจูุงูุงุช (ุนุฏูู .env ุฃููุงู)
php artisan migrate --seed

# 5. ุงูุชุซุจูุช (ุฅูุดุงุก ูุฏูุฑ ุฃุนูู)
php artisan sarh:install

# 6. ุฑุจุท ุงูุชุฎุฒูู
php artisan storage:link

# 7. ุชุดุบูู ุฎุงุฏู ุงูุชุทููุฑ
php artisan serve &
npm run dev &
```

---

## 16.2 ุฅุถุงูุฉ ููุฑุฏ Filament ุฌุฏูุฏ

### 1. ุฅูุดุงุก ุงููููุฐุฌ

```bash
php artisan make:model NewFeature -m
# โ app/Models/NewFeature.php
# โ database/migrations/xxxx_create_new_features_table.php
```

### 2. ุชุนุฑูู ุงููุฌุฑุฉ

```php
Schema::create('new_features', function (Blueprint $table) {
    $table->id();
    $table->string('name_ar');
    $table->string('name_en')->nullable();
    $table->foreignId('user_id')->constrained()->cascadeOnDelete();
    $table->foreignId('branch_id')->constrained()->cascadeOnDelete();
    $table->enum('status', ['active', 'inactive'])->default('active');
    $table->timestamps();
    $table->softDeletes();
});
```

### 3. ุชุนุฑูู ุงููููุฐุฌ

```php
class NewFeature extends Model
{
    use SoftDeletes;

    protected $fillable = [
        'name_ar', 'name_en', 'user_id', 'branch_id', 'status',
    ];

    protected $casts = [
        'status' => 'string',
    ];

    // ุงูุนูุงูุงุช
    public function user(): BelongsTo
    {
        return $this->belongsTo(User::class);
    }

    public function branch(): BelongsTo
    {
        return $this->belongsTo(Branch::class);
    }
}
```

### 4. ุฅูุดุงุก ููุฑุฏ Filament

```bash
php artisan make:filament-resource NewFeature --generate
```

### 5. ุฅุถุงูุฉ ุงูุชุญูู ูู ุงููุตูู

```php
// ูู NewFeatureResource.php
public static function canAccess(): bool
{
    return auth()->user()?->security_level >= 5;
}

// ูุทุงู ุงูุจูุงูุงุช
public static function getEloquentQuery(): Builder
{
    $query = parent::getEloquentQuery();
    $user = auth()->user();

    if (!$user->is_super_admin && $user->security_level < 10) {
        $query->where('branch_id', $user->branch_id);
    }

    return $query;
}
```

### 6. ุฅุถุงูุฉ Eager Loading

```php
public static function getEloquentQuery(): Builder
{
    return parent::getEloquentQuery()
        ->with(['user', 'branch']);
}
```

### 7. ุฅุถุงูุฉ ููู ุงููุบุฉ

```php
// lang/ar/new_features.php
return [
    'navigation_group' => 'ุงููุฌููุนุฉ',
    'model_label' => 'ุงูููุฒุฉ ุงูุฌุฏูุฏุฉ',
    'plural_model_label' => 'ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ',
    // ...
];
```

---

## 16.3 ุฅูุดุงุก ุณูุงุณุฉ (Policy)

```bash
php artisan make:policy NewFeaturePolicy --model=NewFeature
```

```php
class NewFeaturePolicy
{
    public function viewAny(User $user): bool
    {
        return $user->security_level >= 4;
    }

    public function view(User $user, NewFeature $record): bool
    {
        return $user->security_level >= 4
            || $user->id === $record->user_id;
    }

    public function create(User $user): bool
    {
        return $user->security_level >= 5;
    }

    public function update(User $user, NewFeature $record): bool
    {
        return $user->security_level >= 5;
    }

    public function delete(User $user, NewFeature $record): bool
    {
        return $user->security_level >= 10;
    }
}
```

**ุชุณุฌูู** ูู `AppServiceProvider.php`:

```php
Gate::policy(NewFeature::class, NewFeaturePolicy::class);
```

---

## 16.4 ุฅุถุงูุฉ ุญุฏุซ (Event) ููุณุชูุน (Listener)

### 1. ุฅูุดุงุก ุงูุญุฏุซ

```php
// app/Events/NewFeatureCreated.php
class NewFeatureCreated
{
    use Dispatchable, InteractsWithSockets, SerializesModels;

    public function __construct(
        public NewFeature $feature
    ) {}
}
```

### 2. ุฅูุดุงุก ุงููุณุชูุน

```php
// app/Listeners/HandleNewFeatureCreated.php
class HandleNewFeatureCreated
{
    public function handle(NewFeatureCreated $event): void
    {
        // ุฅูุดุงุก ุณุฌู ุชุฏููู
        AuditLog::create([
            'user_id'        => auth()->id(),
            'action'         => 'feature_created',
            'auditable_type' => NewFeature::class,
            'auditable_id'   => $event->feature->id,
        ]);
    }
}
```

### 3. ุงูุชุณุฌูู ูู AppServiceProvider

```php
Event::listen(NewFeatureCreated::class, HandleNewFeatureCreated::class);
```

### 4. ุฅุทูุงู ุงูุญุฏุซ

```php
event(new NewFeatureCreated($feature));
```

---

## 16.5 ุฅุถุงูุฉ ุฃูุฑ Artisan

```php
// app/Console/Commands/ProcessNewFeaturesCommand.php
class ProcessNewFeaturesCommand extends Command
{
    protected $signature = 'sarh:process-features {--date=}';
    protected $description = 'ูุนุงูุฌุฉ ุงูููุฒุงุช ุงูุฌุฏูุฏุฉ';

    public function handle(): int
    {
        $date = $this->option('date')
            ? Carbon::parse($this->option('date'))
            : Carbon::today();

        $this->info("ูุนุงูุฌุฉ ุงูููุฒุงุช ูููู {$date->toDateString()}...");

        // ุงูููุทู ููุง...

        $this->info('โ ุชูุช ุงููุนุงูุฌุฉ');
        return Command::SUCCESS;
    }
}
```

---

## 16.6 ุฅุถุงูุฉ ูููู Livewire (ุจูุงุจุฉ ุงูููุธู)

```bash
php artisan make:livewire NewFeatureWidget
```

```php
// app/Livewire/NewFeatureWidget.php
class NewFeatureWidget extends Component
{
    public function render()
    {
        $features = NewFeature::where('user_id', auth()->id())
            ->latest()
            ->take(5)
            ->get();

        return view('livewire.new-feature-widget', [
            'features' => $features,
        ]);
    }
}
```

ุฃุถูู ูู ููุญุฉ ุงูููุธู:

```blade
{{-- resources/views/livewire/employee-dashboard.blade.php --}}
@livewire('new-feature-widget')
```

---

## 16.7 ุงุตุทูุงุญุงุช ุงูููุฏ

### ุงูุชุณููุฉ

| ุงููููู | ุงูุงุตุทูุงุญ | ูุซุงู |
|--------|----------|------|
| ูููุฐุฌ | PascalCase ููุฑุฏ | `AttendanceLog` |
| ุฌุฏูู | snake_case ุฌูุน | `attendance_logs` |
| ููุฑุฏ Filament | `{Model}Resource` | `AttendanceLogResource` |
| ุณูุงุณุฉ | `{Model}Policy` | `AttendanceLogPolicy` |
| ุญุฏุซ | PascalCase ูุนู | `AttendanceRecorded` |
| ูุณุชูุน | `Handle{Event}` | `HandleAttendanceRecorded` |
| ูููุฉ | PascalCase ูุนู + Job | `ProcessAttendanceJob` |
| ุฃูุฑ | `sarh:{action}` | `sarh:analytics` |
| ุฎุฏูุฉ | `{Domain}Service` | `AttendanceService` |

### ุจููุฉ ุงููููุงุช

```
ููุฒุฉ ุฌุฏูุฏุฉ = {
    Model     โ app/Models/
    Migration โ database/migrations/
    Resource  โ app/Filament/Resources/
    Policy    โ app/Policies/
    Service   โ app/Services/ (ุฅุฐุง ูุนูุฏุฉ)
    Event     โ app/Events/
    Listener  โ app/Listeners/
    Job       โ app/Jobs/ (ุฅุฐุง async)
    Command   โ app/Console/Commands/ (ุฅุฐุง CLI)
    Lang      โ lang/ar/ + lang/en/
    Test      โ tests/Feature/ ุฃู tests/Unit/
}
```

### ููุงุนุฏ ุนุงูุฉ

1. **ุซูุงุฆูุฉ ุงููุบุฉ**: ูู ูุต ูุฑุฆู ููุชุฑุฌู (`__('key')` ุฃู ุญููู `_ar`/`_en`)
2. **Soft Delete**: ุฌููุน ุงูููุงุฐุฌ ุงูุฑุฆูุณูุฉ ุชุณุชุฎุฏู `SoftDeletes`
3. **Eager Loading**: ูู ููุฑุฏ ููุญููู ุงูุนูุงูุงุช ูุณุจููุง (`->with([...])`)
4. **ูุทุงู ุงูุจูุงูุงุช**: ุงูููุงุฑุฏ ุชููููุฏ ุงูุจูุงูุงุช ุญุณุจ ุงููุฑุน ูุงููุณุชูู ุงูุฃููู
5. **ุงูุชุฏููู**: ุงูุนูููุงุช ุงูุญุณุงุณุฉ ุชูุณุฌููู ูู `AuditLog`
6. **ุงูุงุณุชุฌุงุจุฉ ููููุจุงูู**: ุงุณุชุฎุฏุงู `Stack`/`Split` ูู ุฌุฏุงูู Filament

---

## 16.8 ุชุดุบูู ุงูุงุฎุชุจุงุฑุงุช

```bash
# ุฌููุน ุงูุงุฎุชุจุงุฑุงุช
php artisan test

# ุงุฎุชุจุงุฑุงุช ุงููุญุฏุฉ ููุท
php artisan test --testsuite=Unit

# ุงุฎุชุจุงุฑุงุช ุงูููุฒุงุช ููุท
php artisan test --testsuite=Feature

# ุงุฎุชุจุงุฑ ูุญุฏุฏ
php artisan test --filter=AttendanceTest
```

---

> **ุงูุณุงุจู**: [ุงููุดุฑ ูุงูุชุดุบูู](15-deployment.md) | **ุงูุชุงูู**: [ุงููุตุทูุญุงุช](17-glossary.md)



================================================================================
ุงูููู: 17-glossary.md
================================================================================

# 17. ุงููุตุทูุญุงุช (ูุงููุณ ุนุฑุจูโุฅูุฌููุฒู)

## 17.1 ูุตุทูุญุงุช ุงููุธุงู

| ุงูุนุฑุจูุฉ | ุงูุฅูุฌููุฒูุฉ | ุงููุตู |
|---------|-----------|-------|
| ูุคุดุฑ ุตุฑุญ | SarhIndex | ุงุณู ุงููุธุงู โ ูุธุงู ุฅุฏุงุฑุฉ ุฑุฃุณ ุงููุงู ุงูุจุดุฑู |
| ุจูุงุจุฉ ุงูููุธู | Employee Portal | ูุงุฌูุฉ ุงูููุธู PWA ุนูู `/app` |
| ููุญุฉ ุงูุฅุฏุงุฑุฉ | Admin Panel | ููุญุฉ ุงูุชุญูู ุงูุฅุฏุงุฑูุฉ ุนูู `/admin` |
| ุบุฑูุฉ ุงูููุงุฏุฉ | Command Room | ูุฌููุนุฉ ุงูุชููู ููุชูุงุฑูุฑ ุงููุงููุฉ ูุงูุฎุฒูุฉ ุงูุณุฑูุฉ |
| ุงููุฑุขุฉ ุงูุดุฎุตูุฉ | Personal Mirror | ูุคุดุฑุงุช ุงูุฃุฏุงุก ุงูุฐุงุชูุฉ ููููุธู |
| ุณุงุนุฉ ุงููุฑุตุฉ ุงูุถุงุฆุนุฉ | Lost Opportunity Clock | ุนุฏุงุฏ ุงูุฎุณุงุฆุฑ ุงููุงููุฉ ุงููุญุธู |
| ุงูุฎุฒูุฉ ุงูุณุฑูุฉ | Whistleblower Vault | ุฎุฒูุฉ ุงูุจูุงุบุงุช ุงูุณุฑูุฉ ุงููุดููุฑุฉ |

## 17.2 ูุตุทูุญุงุช ูุงููุฉ

| ุงูุนุฑุจูุฉ | ุงูุฅูุฌููุฒูุฉ | ุงููุตู |
|---------|-----------|-------|
| ุชูููุฉ ุงูุฏูููุฉ | Cost Per Minute | ูููุฉ ุงูุฏูููุฉ ุงููุงุญุฏุฉ ูู ุงูุฑุงุชุจ |
| ุงููููุฉ ููู ุฏูููุฉ | VPM (Value Per Minute) | ุชูููุฉ ุงูุฏูููุฉ ุนูู ูุณุชูู ุงููุฑุน |
| ูุถุงุนู ุงูุฎุณุงุฑุฉ | Loss Multiplier | ููุนุงูู ุชุถุฎูู ุชูููุฉ ุงูุชุฃุฎูุฑ |
| ุงูุฑุงุชุจ ุงูุฅุฌูุงูู | Total Salary | ุงูุฃุณุงุณู + ุฌููุน ุงูุจุฏูุงุช |
| ุตุงูู ุงูุฑุงุชุจ | Net Salary | ุจุนุฏ ุงูุฎุตููุงุช + ุงูุฅุถุงูุงุช |
| ุฎุตู ุงูุชุฃุฎูุฑ | Delay Deduction | ุงูุฎุตู ุงููุงูู ุจุณุจุจ ุงูุชุฃุฎูุฑ |
| ุฃุฌุฑ ุงูุนูู ุงูุฅุถุงูู | Overtime Pay | ุชุนููุถ ุงูุนูู ุงูุฅุถุงูู (ร 1.5) |
| ูุดู ุงูุฑุงุชุจ | Payroll | ุจูุงู ุงูุฑุงุชุจ ุงูุดูุฑู |
| ูุตูููุฉ ุงูุนุงุฆุฏ | ROI Matrix | ููุงุฑูุฉ ุนุงุฆุฏ ุงูุงุณุชุซูุงุฑ ุจูู ุงููุฑูุน |

## 17.3 ูุตุทูุญุงุช ุงูุญุถูุฑ

| ุงูุนุฑุจูุฉ | ุงูุฅูุฌููุฒูุฉ | ุงููุตู |
|---------|-----------|-------|
| ุชุณุฌูู ุญุถูุฑ | Check-in | ุชุณุฌูู ุจุฏุงูุฉ ุงูุฏูุงู |
| ุชุณุฌูู ุงูุตุฑุงู | Check-out | ุชุณุฌูู ููุงูุฉ ุงูุฏูุงู |
| ุงูุณูุงุฌ ุงูุฌุบุฑุงูู | Geofence | ููุทูุฉ GPS ุงููุณููุญ ุจูุง ููุญุถูุฑ |
| ูุชุฑุฉ ุงูุณูุงุญ | Grace Period | ุงูุฏูุงุฆู ุงููุณููุญุฉ ุจุนุฏ ุจุฏุงูุฉ ุงูุฏูุงู |
| ุงููุฑุฏูุฉ | Shift | ูุชุฑุฉ ุงูุนูู ุงููุญุฏุฏุฉ |
| ุงุณุชุซูุงุก ุญุถูุฑ | Attendance Exception | ุชุฌุงูุฒ ููุงุนุฏ ุงูุญุถูุฑ ูููุธู |
| ุณูุณูุฉ ุงูุญุถูุฑ | Streak | ุฃูุงู ุญุถูุฑ ูุชุชุงููุฉ ุจุฏูู ุชุฃุฎูุฑ |
| ุฅุฌุงุฒุฉ ุณูููุฉ | Annual Leave | ุฅุฌุงุฒุฉ ูุฏููุนุฉ |
| ุฅุฌุงุฒุฉ ูุฑุถูุฉ | Sick Leave | ุฅุฌุงุฒุฉ ูุฃุณุจุงุจ ุตุญูุฉ |

## 17.4 ูุตุทูุญุงุช ุงูุฃูุงู

| ุงูุนุฑุจูุฉ | ุงูุฅูุฌููุฒูุฉ | ุงููุตู |
|---------|-----------|-------|
| ูุถุน ุงูุฅูู | God Mode | ุงููุณุชูู 10 โ ุชุฌุงูุฒ ุฌููุน ุงููููุฏ |
| ุงููุณุชูู ุงูุฃููู | Security Level | ูุณุชูู ุตูุงุญูุงุช ุงูููุธู (1-10) |
| ุจูุงุจุฉ | Gate | ููุทุฉ ุชุญูู ููุตูุงุญูุงุช ูู Laravel |
| ุณูุงุณุฉ | Policy | ููุงุนุฏ ุงููุตูู ููููุฐุฌ ูุญุฏุฏ |
| ููุญ ุตูุงุญูุฉ | Grant Permission | ุฅุนุทุงุก ุตูุงุญูุฉ ูุฑุฏูุฉ ูููุธู |
| ุณุญุจ ุตูุงุญูุฉ | Revoke Permission | ุฅุฒุงูุฉ ุตูุงุญูุฉ ูุฑุฏูุฉ ูู ููุธู |
| ูุฎ ููุณู | Psychological Trap | ุนูุตุฑ ูุงุฌูุฉ ูููู ููุดู ุงูุณููู ุงููุดุจูู |
| ุฏุฑุฌุฉ ุงูุฎุทุฑ | Risk Score | ุชูููู ุฎุทูุฑุฉ ุชูุงุนู ุงููุณุชุฎุฏู ูุน ุงููุฎ |
| ุชุตุนูุฏ | Escalation | ุฑูุน ุงูุชูุจูู ููุณุชูู ุญุฑุฌ |
| ุณุฌู ุงูุชุฏููู | Audit Log | ุณุฌู ุงูุนูููุงุช ุงูุญุณุงุณุฉ |

## 17.5 ูุตุทูุญุงุช ุงูุชุญูููุงุช

| ุงูุนุฑุจูุฉ | ุงูุฅูุฌููุฒูุฉ | ุงููุตู |
|---------|-----------|-------|
| ุงูููุทุฉ ุงูุชุญููููุฉ | Analytics Snapshot | ุจูุงูุงุช ุชุญููููุฉ ููุฌููุฏุฉ ูุชุงุฑูุฎ ูุญุฏุฏ |
| ูุฌูุฉ ุงูุฅูุชุงุฌูุฉ | Productivity Gap | ุงููุฑู ุจูู ุงูุฃุฏุงุก ุงููุณุชูุฏู ูุงููุนูู |
| ุฏุฑุฌุฉ ุงูููุงุกุฉ | Efficiency Score | ูุคุดุฑ ูุฑููุจ ูู 0-100 |
| ุชูุจูู ุฎุณุงุฑุฉ | Loss Alert | ุฅูุฐุงุฑ ุชููุงุฆู ุนูุฏ ุชุฌุงูุฒ ุนุชุจุฉ ุงูุฎุณุงุฑุฉ |
| ููุท ููุธู | Employee Pattern | ุณููู ูุชูุฑุฑ ููุชุดู (ุชุฃุฎุฑุ ุบูุงุจ...) |
| ุดุฐูุฐ | Anomaly | ุจูุงูุงุช ุงุณุชุดุนุงุฑ ุบูุฑ ุทุจูุนูุฉ |
| ุฎุฑูุทุฉ ุญุฑุงุฑูุฉ | Heatmap | ุชุตููุฑ ุจุตุฑู ูุชูุฒูุน ุงูุญุถูุฑ |
| ุงูููุงุณ ุนู ุจูุนุฏ | Telemetry | ุจูุงูุงุช ุฃุฌูุฒุฉ ุงุณุชุดุนุงุฑ ุงููุงุชู |

## 17.6 ูุตุทูุญุงุช ุงูุชุญููุฒ

| ุงูุนุฑุจูุฉ | ุงูุฅูุฌููุฒูุฉ | ุงููุตู |
|---------|-----------|-------|
| ุดุงุฑุฉ | Badge | ูุณุงู ุฅูุฌุงุฒ ููููุญ ููููุธู |
| ููุงุท | Points | ุฑุตูุฏ ุชุญููุฒู ูุงุจู ููุชุฑุงูู |
| ููุญุฉ ุงูููุงูุณุฉ | Leaderboard | ุชุฑุชูุจ ุงููุฑูุน ุญุณุจ ุงูุฃุฏุงุก |
| ุชุนุฏูู ุชูููู | Score Adjustment | ุชุนุฏูู ูุฏูู ููููุงุท ุฃู ุงูููู ุงููุงููุฉ |

## 17.7 ูุตุทูุญุงุช ุงููููู ุงูุชูุธููู

| ุงูุนุฑุจูุฉ | ุงูุฅูุฌููุฒูุฉ | ุงููุตู |
|---------|-----------|-------|
| ูุฑุน | Branch | ูููุน ุนูู ุฌุบุฑุงูู |
| ูุณู | Department | ูุญุฏุฉ ุฅุฏุงุฑูุฉ ุถูู ุงููุฑุน |
| ุฏูุฑ | Role | ูุณูู ูุธููู ูุฎุฑู (ูุง ูููุญ ุตูุงุญูุงุช) |
| ุงููุฏูุฑ ุงููุจุงุดุฑ | Direct Manager | ุงููุดุฑู ุงููุจุงุดุฑ ุนูู ุงูููุธู |
| ุงูุฑูู ุงููุธููู | Employee ID | ูุนุฑู ูุฑูุฏ ุจุตูุบุฉ `SI-YY-NNNN` |

## 17.8 ูุตุทูุญุงุช ุชูููุฉ

| ุงูุนุฑุจูุฉ/ุงูุฅูุฌููุฒูุฉ | ุงููุตู |
|-------------------|-------|
| Filament | ุฅุทุงุฑ ุนูู ููุญุงุช ุงูุฅุฏุงุฑุฉ ูู Laravel |
| Livewire | ููุชุจุฉ ูุจูุงุก ูุงุฌูุงุช ุชูุงุนููุฉ ุจู PHP |
| Eloquent | ูุธุงู ORM ูู Laravel |
| Migration (ูุฌุฑุฉ) | ููู ุชุนุฑูู ุจููุฉ ูุงุนุฏุฉ ุงูุจูุงูุงุช |
| Seeder (ุจุฐูุงุฑ) | ููู ุฅุฏุฎุงู ุจูุงูุงุช ุฃูููุฉ |
| Policy (ุณูุงุณุฉ) | ููุงุนุฏ ุชุฑุฎูุต ููููุฐุฌ |
| Middleware (ูุณูุท) | ููุชุฑ ููููููุฐ ูุจู/ุจุนุฏ ุงูุทูุจ |
| Queue/Job (ุทุงุจูุฑ/ูููุฉ) | ูุนุงูุฌุฉ ุฎูููุฉ ุบูุฑ ูุชุฒุงููุฉ |
| Event/Listener (ุญุฏุซ/ูุณุชูุน) | ููุท ุงูุจุซ ูุงูุงุดุชุฑุงู |
| SoftDeletes (ุญุฐู ูุงุนู) | ุฃุฑุดูุฉ ุจุฏู ุงูุญุฐู ุงููุนูู |
| Eager Loading (ุชุญููู ูุณุจู) | ุชุญููู ุงูุนูุงูุงุช ูุน ุงูุงุณุชุนูุงู ุงูุฃุตูู |
| MorphTo (ุชุนุฏุฏ ุงูุฃุดูุงู) | ุนูุงูุฉ ูุชุนุฏุฏุฉ ุงูุฃููุงุน |
| PWA | ุชุทุจูู ููุจ ุชูุฏูู ูุนูู ูุชุทุจูู ุฌูุงู |
| RTL | ุงุชุฌุงู ุงููุต ูู ุงููููู ูููุณุงุฑ |
| Haversine | ูุนุงุฏูุฉ ุญุณุงุจ ุงููุณุงูุฉ ุนูู ุณุทุญ ุงููุฑุฉ |

---

> **ุงูุณุงุจู**: [ุฏููู ุงูุชุทููุฑ](16-development-guide.md) | **ุงูุนูุฏุฉ**: [ุงูููุฑุณ](README.md)



================================================================================
ุงูููู: README.md
================================================================================

# ๐ ุชูุซูู ูุธุงู ูุคุดุฑ ุตุฑุญ (SarhIndex) โ ุงูุฅุตุฏุงุฑ 4.2.2

> **ูุธุงู ุฅุฏุงุฑุฉ ุงูููุงุฑุฏ ุงูุจุดุฑูุฉ ุงูุฐูู โ ูุคุดุฑ ุตุฑุญ**  
> ุขุฎุฑ ุชุญุฏูุซ: ูุจุฑุงูุฑ 2026 | ุงูุฅุตุฏุงุฑ: v4.2.2 | ุงููุฑุน: `hotfix/security-v4.2.2`

---

## ๐ ููุฑุณ ุงูุชูุซูู

| # | ุงููุณู | ุงูููู | ุงููุตู |
|---|-------|-------|-------|
| 1 | [ูุธุฑุฉ ุนุงูุฉ](01-overview.md) | `01-overview.md` | ููุฏูุฉ ุนู ุงููุธุงู ูุฃูุฏุงูู ููููุฒุงุชู ุงูุฑุฆูุณูุฉ |
| 2 | [ูููู ุงููุดุฑูุน](02-project-structure.md) | `02-project-structure.md` | ุดุฑุญ ุงููุฌูุฏุงุช ูุงููููุงุช ุงูุฑุฆูุณูุฉ |
| 3 | [ูุงุนุฏุฉ ุงูุจูุงูุงุช ูุงูููุงุฐุฌ](03-database-models.md) | `03-database-models.md` | ุงูุฌุฏุงูู ูุงูุนูุงูุงุช ูููุงุฐุฌ Eloquent |
| 4 | [ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช](04-roles-permissions.md) | `04-roles-permissions.md` | ูุธุงู ุงููุณุชููุงุช ุงูุนุดุฑุฉ ูุงูุตูุงุญูุงุช |
| 5 | [ููููุงุช Filament](05-filament-components.md) | `05-filament-components.md` | ุงูููุงุฑุฏ ูุงูุตูุญุงุช ูุงูููุฏุฌุงุช |
| 6 | [ุงููุธุงู ุงููุงูู](06-financial-system.md) | `06-financial-system.md` | ุญุณุงุจ ุงูุฑูุงุชุจ ูุงูุชูุงููู ูุงูุชูุงุฑูุฑ ุงููุงููุฉ |
| 7 | [ูุธุงู ุงูุญุถูุฑ ูุงูุงูุตุฑุงู](07-attendance-system.md) | `07-attendance-system.md` | ุงูุชุณุฌูู ูุงููุฑุฏูุงุช ูุงูุฅุฌุงุฒุงุช ูุงูุณูุงุฌ ุงูุฌุบุฑุงูู |
| 8 | [ูุธุงู ุงูุชุญูููุงุช](08-analytics-system.md) | `08-analytics-system.md` | ุงูุชุญูููุงุช ูุงูููุทุงุช ูุงูุฃููุงุท ูุงูุดุฐูุฐ |
| 9 | [ูุธุงู ุงูุชูุงุตู](09-communication-system.md) | `09-communication-system.md` | ุงููุญุงุฏุซุงุช ูุงูุชุนุงููู ูุงูุฅุดุนุงุฑุงุช ุงูุฌูุงุนูุฉ |
| 10 | [ูุธุงู ุงูุชุญููุฒ](10-gamification-system.md) | `10-gamification-system.md` | ุงูุดุงุฑุงุช ูุงูููุงุท ูููุญุฉ ุงููุชุตุฏุฑูู |
| 11 | [ูุธุงู ุงูุฅุฏุงุฑุฉ ูุงูุฑูุงุจุฉ](11-management-system.md) | `11-management-system.md` | ุงูุชุฏููู ูุงูุจูุงุบุงุช ูุงููุณุชูุฏุงุช ูุงูุชุฐููุฑุงุช |
| 12 | [ูุธุงู ุงููุฎุงุฎ ุงูููุณูุฉ](12-trap-system.md) | `12-trap-system.md` | ุงููุฎุงุฎ ูุงูุชูุงุนูุงุช ูุชูููู ุงููุฎุงุทุฑ |
| 13 | [ุงูุฃูุงูุฑ ูุงูุฎุฏูุงุช](13-commands-services.md) | `13-commands-services.md` | ุฃูุงูุฑ Artisan ูุงูุฎุฏูุงุช ูุงูุฃุญุฏุงุซ ูุงููุธุงุฆู |
| 14 | [ูุงุฌูุฉ ุงููุณุชุฎุฏู](14-ui-design.md) | `14-ui-design.md` | ุงูุชุตููู ูุงูุซูู ูุงูุชูุงูู ูุน ุงูุฌูุงู |
| 15 | [ุฏููู ุงููุดุฑ](15-deployment.md) | `15-deployment.md` | ุฎุทูุงุช ุงููุดุฑ ูุงููุชุทูุจุงุช ููุงุฆูุฉ ุงูุชุญูู |
| 16 | [ุฏููู ุงูุชุทููุฑ](16-development-guide.md) | `16-development-guide.md` | ุฅุถุงูุฉ ููุฒุงุช ูููุงุฑุฏ ูุงุฎุชุจุงุฑุงุช ุฌุฏูุฏุฉ |
| 17 | [ูุณุฑุฏ ุงููุตุทูุญุงุช](17-glossary.md) | `17-glossary.md` | ุงููุตุทูุญุงุช ุงูุชูููุฉ ููุนุงูููุง |
| ๐ | [ุณุฌู ุงูุชุบููุฑุงุช](CHANGELOG.md) | `CHANGELOG.md` | ุณุฌู ุขูู ุจูู ุชุบููุฑ ูู ุงูููุฏ (ูููููุฏ ุจูุงุณุทุฉ ุงูุฌุงุณูุณ) |

---

## ๐๏ธ ุงูุฌุงุณูุณ โ ูุธุงู ูุฑุงูุจุฉ ุงููููุงุช

ูุธุงู **ุงูุฌุงุณูุณ** ูุฑุงูุจ ุฌููุน ูููุงุช ุงููุดุฑูุน ูู ุงูููุช ุงูุญูููู ููุณุฌูู ูู ุชุบููุฑ ุชููุงุฆููุง:

```bash
# ุชุดุบูู ูุฏูู
php artisan sarh:watch

# ูุน ุฎูุงุฑุงุช
php artisan sarh:watch --poll=5          # ูุชุฑุฉ ุงุณุชุทูุงุน 5 ุซูุงูู
php artisan sarh:watch --no-db           # ุจุฏูู ุชุณุฌูู ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
php artisan sarh:watch --no-docs         # ุจุฏูู ุชุญุฏูุซ ุงููุซุงุฆู
php artisan sarh:watch --no-changelog    # ุจุฏูู ูุชุงุจุฉ CHANGELOG
```

- **ูุนูู ุชููุงุฆููุง** ุนูุฏ ูุชุญ ุงููุดุฑูุน ูู VS Code (ุนุจุฑ `.vscode/tasks.json`)
- ูุณุฌูู ูู: `docs/CHANGELOG.md` + ุฌุฏูู `change_logs` ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
- ูุญุฏูุซ ุงููุซุงุฆู ุงููุชุฃุซุฑุฉ ุชููุงุฆููุง
- ุงูุฅุนุฏุงุฏุงุช: `config/file-watcher.php`

---

## ๐ ุงูุจุฏุก ุงูุณุฑูุน

### ูููุทูุฑ ุงูุฌุฏูุฏ
1. ุงุจุฏุฃ ุจูุฑุงุกุฉ [ุงููุธุฑุฉ ุงูุนุงูุฉ](01-overview.md) ูููู ูุงููุฉ ุงููุธุงู
2. ุฑุงุฌุน [ูููู ุงููุดุฑูุน](02-project-structure.md) ูููู ุชูุธูู ุงููููุงุช
3. ุงูุฑุฃ [ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช](04-roles-permissions.md) ูููู ูุธุงู ุงูุฃูุงู
4. ุฑุงุฌุน [ุฏููู ุงูุชุทููุฑ](16-development-guide.md) ูุจู ูุชุงุจุฉ ุฃู ููุฏ

### ููุฏูุฑ ุงููุธุงู
1. ุฑุงุฌุน [ุฏููู ุงููุดุฑ](15-deployment.md) ูููู ุนูููุฉ ุงููุดุฑ
2. ุงูุฑุฃ [ุงููุธุงู ุงููุงูู](06-financial-system.md) ูููู ุญุณุงุจุงุช ุงูุฑูุงุชุจ
3. ุฑุงุฌุน [ูุธุงู ุงูุญุถูุฑ](07-attendance-system.md) ูููู ุขููุฉ ุงูุชุณุฌูู

### ูููุฑุงุฌุน ุงูุฃููู
1. ุงุจุฏุฃ ุจู [ุงูุฃุฏูุงุฑ ูุงูุตูุงุญูุงุช](04-roles-permissions.md)
2. ุฑุงุฌุน [ูุธุงู ุงููุฎุงุฎ](12-trap-system.md)
3. ุงูุฑุฃ [ูุธุงู ุงูุฅุฏุงุฑุฉ ูุงูุฑูุงุจุฉ](11-management-system.md)

---

## ๐ ูุนูููุงุช ุชูููุฉ ุณุฑูุนุฉ

| ุงูุนูุตุฑ | ุงููููุฉ |
|--------|--------|
| ุฅุทุงุฑ ุงูุนูู | Laravel 11 + Filament v3 |
| ูุบุฉ ุงูุจุฑูุฌุฉ | PHP 8.2+ |
| ูุงุนุฏุฉ ุงูุจูุงูุงุช | MySQL/MariaDB |
| ุงููุงุฌูุฉ ุงูุฃูุงููุฉ | Tailwind CSS 3 + Alpine.js + Livewire 3 |
| ูุบุฉ ุงููุงุฌูุฉ | ุงูุนุฑุจูุฉ (RTL) โ ุงุชุฌุงู ูู ุงููููู ูููุณุงุฑ |
| ุงูุงุณุชุถุงูุฉ | Hostinger Shared Hosting |
| ุงููุทุงู | sarh.online |

---

> ๐ **ููุงุญุธุฉ**: ูุฐุง ุงูุชูุซูู ูุนูุณ ุญุงูุฉ ุงูููุฏ ุจุนุฏ ุฌูุณุฉ ุงูุฅุตูุงุญุงุช ุงูุฃูููุฉ (v4.2.2) โ ูุจุฑุงูุฑ 2026.



